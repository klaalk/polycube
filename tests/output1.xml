<testsuites failures="13" errors="0" tests="130" disabled="0" time="3954.0"><testsuite name="CleanInstance" disabled="0" failures="13" errors="0" skipped="0" time="3954" tests="130"><testcase name="./test101.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 09:57:43.270] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:57:43.271] [polycubed] [info] configuration parameters: 
[2020-12-24 09:57:43.271] [polycubed] [info]  loglevel: info
[2020-12-24 09:57:43.271] [polycubed] [info]  daemon: false
[2020-12-24 09:57:43.271] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:57:43.271] [polycubed] [info]  port: 9000
[2020-12-24 09:57:43.271] [polycubed] [info]  addr: localhost
[2020-12-24 09:57:43.271] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:57:43.271] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:57:43.271] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:57:43.271] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:57:43.271] [polycubed] [info] polycubed starting...
[2020-12-24 09:57:43.271] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:57:43.271] [polycubed] [critical] There is another polycube instance running with pid 4184
+ polycubectl helloworld add hw0
+ polycubectl helloworld hw0 ports add port1
+ polycubectl del helloworld hw0
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test102.sh" time="8.000000" status="Passed"><system-out>[2020-12-24 09:57:52.915] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:57:52.915] [polycubed] [info] configuration parameters: 
[2020-12-24 09:57:52.915] [polycubed] [info]  loglevel: info
[2020-12-24 09:57:52.915] [polycubed] [info]  daemon: false
[2020-12-24 09:57:52.915] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:57:52.915] [polycubed] [info]  port: 9000
[2020-12-24 09:57:52.915] [polycubed] [info]  addr: localhost
[2020-12-24 09:57:52.915] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:57:52.915] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:57:52.915] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:57:52.915] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:57:52.915] [polycubed] [info] polycubed starting...
[2020-12-24 09:57:52.915] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:57:55.091] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:57:55.091] [polycubed] [info] rest server starting ...
[2020-12-24 09:57:55.131] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:57:55.141] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:57:55.155] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:57:55.164] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:57:55.196] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:57:55.205] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:57:55.246] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:57:55.277] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:57:55.311] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:57:55.352] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:57:55.395] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:57:55.417] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:57:55.427] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:57:55.442] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:57:55.450] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:57:55.458] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:57:55.499] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:57:55.545] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:57:55.545] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ set -e
+ polycubectl helloworld add hw0
[2020-12-24 09:57:57.478] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl helloworld hw0 ports add port1
[2020-12-24 09:57:57.484] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl helloworld hw0 ports port1 set peer=veth1
+ polycubectl del helloworld hw0
[2020-12-24 09:57:58.042] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test103.sh" time="6.000000" status="Passed"><system-out>[2020-12-24 09:58:00.173] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:00.174] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:00.174] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:00.174] [polycubed] [info]  daemon: false
[2020-12-24 09:58:00.174] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:00.174] [polycubed] [info]  port: 9000
[2020-12-24 09:58:00.174] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:00.174] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:00.174] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:00.174] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:00.174] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:00.174] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:00.174] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:02.342] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:02.343] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:02.388] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:02.398] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:02.412] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:02.421] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:02.452] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:02.462] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:02.503] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:02.535] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:02.568] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:02.610] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:02.652] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:02.674] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:02.684] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:02.699] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:02.707] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:02.715] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:02.756] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:02.802] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:02.802] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ set -e
+ polycubectl helloworld add hw0
[2020-12-24 09:58:04.742] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl helloworld hw0 ports add port1
[2020-12-24 09:58:04.748] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl helloworld hw0 ports port1 set peer=veth1
+ polycubectl helloworld hw0 ports port1 set peer=
+ polycubectl del helloworld hw0
[2020-12-24 09:58:05.651] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test104.sh" time="7.000000" status="Passed"><system-out>[2020-12-24 09:58:06.734] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:06.735] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:06.735] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:06.735] [polycubed] [info]  daemon: false
[2020-12-24 09:58:06.735] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:06.735] [polycubed] [info]  port: 9000
[2020-12-24 09:58:06.735] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:06.735] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:06.735] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:06.735] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:06.735] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:06.735] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:06.735] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:08.908] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:08.908] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:08.953] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:08.964] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:08.978] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:08.988] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:09.022] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:09.032] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:09.075] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:09.108] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:09.143] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:09.187] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:09.231] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:09.254] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:09.265] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:09.280] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:09.289] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:09.297] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:09.340] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:09.388] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:09.388] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ set -e
+ polycubectl helloworld add hw0
[2020-12-24 09:58:11.256] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl helloworld hw0 ports add port1
[2020-12-24 09:58:11.262] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl helloworld hw0 ports port1 set peer=veth1
+ polycubectl helloworld hw0 ports port1 set peer=
+ polycubectl helloworld hw0 ports del port1
[2020-12-24 09:58:12.158] [Helloworld] [hw0] [info] port port1 was removed
+ polycubectl del helloworld hw0
[2020-12-24 09:58:12.163] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test105.sh" time="6.000000" status="Passed"><system-out>[2020-12-24 09:58:13.250] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:13.251] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:13.251] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:13.251] [polycubed] [info]  daemon: false
[2020-12-24 09:58:13.251] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:13.251] [polycubed] [info]  port: 9000
[2020-12-24 09:58:13.251] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:13.251] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:13.251] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:13.251] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:13.251] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:13.251] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:13.251] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:15.430] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:15.431] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:15.472] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:15.483] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:15.497] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:15.507] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:15.540] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:15.550] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:15.593] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:15.626] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:15.661] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:15.705] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:15.750] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:15.772] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:15.783] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:15.798] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:15.806] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:15.815] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:15.857] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:15.907] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:15.907] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ set -e
+ polycubectl helloworld add hw0
[2020-12-24 09:58:17.781] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl helloworld hw0 ports add port1
[2020-12-24 09:58:17.787] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl helloworld hw0 ports port1 set peer=veth1
+ set +e
+ sudo ip link del veth1
+ set -e
++ polycubectl helloworld hw0 ports port1 show peer
+ peer=
+ '[' '!' -z ']'
+ polycubectl del helloworld hw0
[2020-12-24 09:58:18.699] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test106.sh" time="7.000000" status="Passed"><system-out>[2020-12-24 09:58:19.750] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:19.751] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:19.751] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:19.751] [polycubed] [info]  daemon: false
[2020-12-24 09:58:19.751] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:19.751] [polycubed] [info]  port: 9000
[2020-12-24 09:58:19.751] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:19.751] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:19.751] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:19.751] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:19.751] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:19.751] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:19.751] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:21.917] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:21.917] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:21.959] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:21.970] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:21.984] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:21.993] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:22.025] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:22.035] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:22.077] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:22.109] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:22.142] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:22.184] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:22.228] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:22.250] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:22.260] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:22.275] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:22.284] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:22.292] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:22.333] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:22.380] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:22.380] [polycubed] [info] loading metrics from yang files
+ set -e
+ polycubectl helloworld add hw0
[2020-12-24 09:58:24.272] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl helloworld hw0 ports add port1
[2020-12-24 09:58:24.278] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl helloworld hw0 ports port1 set peer=veth1
+ polycubectl helloworld hw0 del ports port1
[2020-12-24 09:58:25.165] [Helloworld] [hw0] [info] port port1 was removed
+ polycubectl del helloworld hw0
[2020-12-24 09:58:25.171] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_hateoas.sh" time="5.000000" status="Passed"><system-out>[2020-12-24 09:58:26.254] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:26.255] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:26.255] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:26.255] [polycubed] [info]  daemon: false
[2020-12-24 09:58:26.255] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:26.255] [polycubed] [info]  port: 9000
[2020-12-24 09:58:26.255] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:26.255] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:26.255] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:26.255] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:26.255] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:26.255] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:26.255] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:28.420] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:28.420] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:28.464] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:28.475] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:28.488] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:28.498] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:28.531] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:28.540] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:28.583] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:28.615] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:28.650] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:28.693] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:28.738] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:28.761] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:28.772] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:28.787] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:28.796] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:28.804] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:28.847] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:28.895] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:28.895] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ polycubectl helloworld add hello
[2020-12-24 09:58:30.701] [Helloworld] [hello] [info] Creating Helloworld instance
++ echo '[{"rel":"self","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/"},{"rel":"uuid","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/uuid/"},{"rel":"type","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/type/"},{"rel":"service-name","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/service-name/"},{"rel":"loglevel","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/loglevel/"},{"rel":"ports","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/ports/"},{"rel":"shadow","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/shadow/"},{"rel":"span","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/span/"},{"rel":"action","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/action/"}]'
+ diff -q /dev/fd/63 /dev/fd/62
+++ curl -s localhost:9000/polycube/v1/helloworld/hello
+++ jq -c ._links
++ echo '[{"rel":"self","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/"},{"rel":"uuid","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/uuid/"},{"rel":"type","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/type/"},{"rel":"service-name","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/service-name/"},{"rel":"loglevel","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/loglevel/"},{"rel":"ports","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/ports/"},{"rel":"shadow","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/shadow/"},{"rel":"span","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/span/"},{"rel":"action","href":"//127.0.0.1:9000/polycube/v1/helloworld/hello/action/"}]'
+ polycubectl del hello
[2020-12-24 09:58:30.723] [Helloworld] [hello] [info] Destroying Helloworld instance
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_programs_chain_tc.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 09:58:31.807] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:31.808] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:31.808] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:31.808] [polycubed] [info]  daemon: false
[2020-12-24 09:58:31.808] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:31.808] [polycubed] [info]  port: 9000
[2020-12-24 09:58:31.808] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:31.808] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:31.808] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:31.808] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:31.808] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:31.808] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:31.808] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:33.986] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:33.986] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:34.031] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:34.042] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:34.056] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:34.066] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:34.100] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:34.109] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:34.151] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:34.184] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:34.219] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:34.262] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:34.308] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:34.332] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:34.344] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:34.360] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:34.368] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:34.377] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:34.420] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:34.467] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:34.467] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
net.ipv6.conf.veth1.disable_ipv6 = 1
net.ipv6.conf.veth1_.disable_ipv6 = 1
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
net.ipv6.conf.veth2.disable_ipv6 = 1
net.ipv6.conf.veth2_.disable_ipv6 = 1
+ polycubectl helloworld add hw1 loglevel=trace type=tc
[2020-12-24 09:58:36.439] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl hw1 set action=forward
+ polycubectl hw1 ports add to_veth1 peer=veth1
[2020-12-24 09:58:37.008] [Helloworld] [hw1] [info] port to_veth1 was connected
+ polycubectl hw1 ports add to_hw2
[2020-12-24 09:58:37.016] [Helloworld] [hw1] [info] port to_hw2 was connected
+ polycubectl helloworld add hw2 loglevel=trace type=tc
[2020-12-24 09:58:37.436] [Helloworld] [hw2] [info] Creating Helloworld instance
+ polycubectl hw2 set action=forward
+ polycubectl hw2 ports add to_hw1
[2020-12-24 09:58:37.449] [Helloworld] [hw2] [info] port to_hw1 was connected
+ polycubectl hw2 ports add to_veth2 peer=veth2
[2020-12-24 09:58:38.136] [Helloworld] [hw2] [info] port to_veth2 was connected
+ polycubectl connect hw1:to_hw2 hw2:to_hw1
+ polycubectl transparenthelloworld add th1 loglevel=trace type=tc
[2020-12-24 09:58:39.726] [Transparenthelloworld] [th1] [info] Creating Transparenthelloworld instance
+ polycubectl attach th1 veth1
[2020-12-24 09:58:40.437] [Transparenthelloworld] [th1] [info] attached
[2020-12-24 09:58:40.437] [Transparenthelloworld] [th1] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th2 loglevel=trace type=tc
[2020-12-24 09:58:40.848] [Transparenthelloworld] [th2] [info] Creating Transparenthelloworld instance
+ polycubectl attach th2 hw1:to_veth1
[2020-12-24 09:58:42.021] [Transparenthelloworld] [th2] [info] attached
[2020-12-24 09:58:42.021] [Transparenthelloworld] [th2] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th3 loglevel=trace type=tc
[2020-12-24 09:58:42.434] [Transparenthelloworld] [th3] [info] Creating Transparenthelloworld instance
+ polycubectl attach th3 hw1:to_hw2
[2020-12-24 09:58:43.607] [Transparenthelloworld] [th3] [info] attached
[2020-12-24 09:58:43.607] [Transparenthelloworld] [th3] [info] parent peer is: hw2:to_hw1
+ set +x
[2020-12-24 09:58:43.628] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.629] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.629] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th3] [debug] [EGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th2] [debug] [EGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th3] [debug] [EGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th2] [debug] [EGRESS] passing packet
[2020-12-24 09:58:43.630] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:58:43.630] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
+ polycubectl hw1 del
[2020-12-24 09:58:43.644] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ polycubectl hw2 del
[2020-12-24 09:58:44.930] [Helloworld] [hw2] [info] Destroying Helloworld instance
+ polycubectl th1 del
+ polycubectl th2 del
+ polycubectl th3 del
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_programs_chain_xdp.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 09:58:47.136] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:58:47.137] [polycubed] [info] configuration parameters: 
[2020-12-24 09:58:47.137] [polycubed] [info]  loglevel: info
[2020-12-24 09:58:47.137] [polycubed] [info]  daemon: false
[2020-12-24 09:58:47.137] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:58:47.137] [polycubed] [info]  port: 9000
[2020-12-24 09:58:47.137] [polycubed] [info]  addr: localhost
[2020-12-24 09:58:47.137] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:58:47.137] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:58:47.137] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:58:47.137] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:58:47.137] [polycubed] [info] polycubed starting...
[2020-12-24 09:58:47.137] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:58:49.314] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:58:49.314] [polycubed] [info] rest server starting ...
[2020-12-24 09:58:49.361] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:58:49.371] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:58:49.385] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:58:49.395] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:58:49.429] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:58:49.439] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:58:49.482] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:58:49.515] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:58:49.551] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:58:49.595] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:58:49.640] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:58:49.663] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:58:49.674] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:58:49.689] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:58:49.697] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:58:49.706] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:58:49.749] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:58:49.798] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:58:49.798] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
net.ipv6.conf.veth1.disable_ipv6 = 1
net.ipv6.conf.veth1_.disable_ipv6 = 1
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
net.ipv6.conf.veth2.disable_ipv6 = 1
net.ipv6.conf.veth2_.disable_ipv6 = 1
+ polycubectl helloworld add hw1 loglevel=trace type=xdp_skb
[2020-12-24 09:58:51.942] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl hw1 set action=forward
+ polycubectl hw1 ports add to_veth1 peer=veth1
[2020-12-24 09:58:53.178] [Helloworld] [hw1] [info] port to_veth1 was connected
+ polycubectl hw1 ports add to_hw2
[2020-12-24 09:58:53.184] [Helloworld] [hw1] [info] port to_hw2 was connected
+ polycubectl helloworld add hw2 loglevel=trace type=xdp_skb
[2020-12-24 09:58:53.775] [Helloworld] [hw2] [info] Creating Helloworld instance
+ polycubectl hw2 set action=forward
+ polycubectl hw2 ports add to_hw1
[2020-12-24 09:58:53.787] [Helloworld] [hw2] [info] port to_hw1 was connected
+ polycubectl hw2 ports add to_veth2 peer=veth2
[2020-12-24 09:58:55.140] [Helloworld] [hw2] [info] port to_veth2 was connected
+ polycubectl connect hw1:to_hw2 hw2:to_hw1
+ polycubectl transparenthelloworld add th1 loglevel=trace type=xdp_skb
[2020-12-24 09:58:57.640] [Transparenthelloworld] [th1] [info] Creating Transparenthelloworld instance
+ polycubectl attach th1 veth1
[2020-12-24 09:58:58.761] [Transparenthelloworld] [th1] [info] attached
[2020-12-24 09:58:58.762] [Transparenthelloworld] [th1] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th2 loglevel=trace type=xdp_skb
[2020-12-24 09:58:59.385] [Transparenthelloworld] [th2] [info] Creating Transparenthelloworld instance
+ polycubectl attach th2 hw1:to_veth1
[2020-12-24 09:59:01.321] [Transparenthelloworld] [th2] [info] attached
[2020-12-24 09:59:01.321] [Transparenthelloworld] [th2] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th3 loglevel=trace type=xdp_skb
[2020-12-24 09:59:01.927] [Transparenthelloworld] [th3] [info] Creating Transparenthelloworld instance
+ polycubectl attach th3 hw1:to_hw2
[2020-12-24 09:59:03.854] [Transparenthelloworld] [th3] [info] attached
[2020-12-24 09:59:03.854] [Transparenthelloworld] [th3] [info] parent peer is: hw2:to_hw1
+ set +x
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th3] [debug] [EGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th2] [debug] [EGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th3] [debug] [EGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw2] [debug] Forwarding packet
[2020-12-24 09:59:03.893] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 09:59:03.893] [Helloworld] [hw1] [debug] Forwarding packet
[2020-12-24 09:59:03.894] [Transparenthelloworld] [th2] [debug] [EGRESS] passing packet
[2020-12-24 09:59:03.894] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:03.894] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
+ polycubectl hw1 del
[2020-12-24 09:59:03.909] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ polycubectl hw2 del
[2020-12-24 09:59:06.441] [Helloworld] [hw2] [info] Destroying Helloworld instance
+ polycubectl th1 del
+ polycubectl th2 del
+ polycubectl th3 del
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_prometheus_metrics.sh" time="11.000000" status="Failed"><failure type="failure">[2020-12-24 09:59:07.593] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:59:07.594] [polycubed] [info] configuration parameters: 
[2020-12-24 09:59:07.594] [polycubed] [info]  loglevel: info
[2020-12-24 09:59:07.594] [polycubed] [info]  daemon: false
[2020-12-24 09:59:07.594] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:59:07.594] [polycubed] [info]  port: 9000
[2020-12-24 09:59:07.594] [polycubed] [info]  addr: localhost
[2020-12-24 09:59:07.594] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:59:07.594] [polycubed] [info] polycubed starting...
[2020-12-24 09:59:07.594] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:59:09.769] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:59:09.770] [polycubed] [info] rest server starting ...
[2020-12-24 09:59:09.817] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:59:09.827] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:59:09.841] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:59:09.851] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:59:09.883] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:59:09.893] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:59:09.934] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:59:09.966] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:59:10.000] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:59:10.043] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:59:10.086] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:59:10.109] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:59:10.120] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:59:10.135] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:59:10.144] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:59:10.152] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:59:10.194] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:59:10.241] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:59:10.241] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ polycubectl ddosmitigator add d1
[2020-12-24 09:59:12.514] [d1] [info] Creating Ddosmitigator instance d1
+ polycubectl d1 blacklist-src add 10.0.0.1
[2020-12-24 09:59:12.520] [d1] [info] reloading code ...
+ polycubectl d1 blacklist-src add 10.1.1.2
+ polycubectl d1 blacklist-src add 10.1.1.3
+ polycubectl d1 blacklist-src add 10.1.1.4
+ polycubectl router add r1
[2020-12-24 09:59:15.763] [Router] [r1] [info] Creating Router instance
+ polycubectl r1 ports add p1
[2020-12-24 09:59:15.770] [Router] [r1] [info] Added new port: p1 (index: 0) [mac: c6:33:85:37:3c:9e - ip: ]
+ polycubectl r1 ports p1 set ip=10.1.1.1/24
[2020-12-24 09:59:15.776] [Router] [r1] [info] Added route [network: 10.1.1.1/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.776] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports add p2
[2020-12-24 09:59:15.781] [Router] [r1] [info] Added new port: p2 (index: 1) [mac: 46:a0:65:8c:06:79 - ip: ]
+ polycubectl r1 ports p2 set ip=10.1.2.1/24
[2020-12-24 09:59:15.785] [Router] [r1] [info] Added route [network: 10.1.2.1/32 - nexthop: 0.0.0.0 - interface: p2]
[2020-12-24 09:59:15.785] [Router] [r1] [info] Added route [network: 10.1.2.0/24 - nexthop: 0.0.0.0 - interface: p2]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.10/24
[2020-12-24 09:59:15.790] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.10/24]
[2020-12-24 09:59:15.790] [Router] [r1] [info] Added route [network: 10.1.1.10/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.790] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.11/24
[2020-12-24 09:59:15.795] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.11/24]
[2020-12-24 09:59:15.795] [Router] [r1] [info] Added route [network: 10.1.1.11/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.795] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.12/24
[2020-12-24 09:59:15.801] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.12/24]
[2020-12-24 09:59:15.801] [Router] [r1] [info] Added route [network: 10.1.1.12/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.801] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ diff -q /dev/fd/63 /dev/fd/62
++ echo '# HELP ddos_stats_pkts_packets Total Dropped Packets
# TYPE ddos_stats_pkts_packets counter
ddos_stats_pkts_packets{cubeName="d1"} 0.000000
# HELP k8switch_service_client_exported_services Number of services exported to the client
# TYPE k8switch_service_client_exported_services gauge
# HELP k8switch_backend_servers Number of backend servers that actually serve requests
# TYPE k8switch_backend_servers gauge
# HELP k8switch_fwd_table_entries Number of entries associated with the forwarding table
# TYPE k8switch_fwd_table_entries gauge
# HELP router_ip_ports Number of ports of the router with ip
# TYPE router_ip_ports gauge
router_ip_ports{cubeName="r1"} 2.000000
# HELP router_secondaryip_ports Number of secondary ip addresses of the router
# TYPE router_secondaryip_ports gauge
router_secondaryip_ports{cubeName="r1"} 3.000000
# HELP router_ports Number of ports on the router
# TYPE router_ports gauge
router_ports{cubeName="r1"} 2.000000
# HELP router_route_routes Number of entries in routing table
# TYPE router_route_routes gauge
router_route_routes{cubeName="r1"} 2.000000
# HELP router_arp_table_entries Number of entries in arp table
# TYPE router_arp_table_entries gauge
router_arp_table_entries{cubeName="r1"} 0.000000
# HELP simplebridge_entry_fdb_number_entries Number of entries associated with the filtering database
# TYPE simplebridge_entry_fdb_number_entries gauge
# HELP ddos_blacklist_src_addresses Number of addresses in blacklist-src
# TYPE ddos_blacklist_src_addresses gauge
ddos_blacklist_src_addresses{cubeName="d1"} 4.000000
# HELP ddos_blacklist_dst_addresses Number of addresses in blacklist-dst
# TYPE ddos_blacklist_dst_addresses gauge
ddos_blacklist_dst_addresses{cubeName="d1"} 0.000000
# HELP simpleforwarder_actions_entries Number of entries of the Actions table
# TYPE simpleforwarder_actions_entries gauge
# HELP pbforwarder_rules_number_rules Number of rules
# TYPE pbforwarder_rules_number_rules gauge'
+++ curl -s localhost:9000/polycube/v1/metrics
[2020-12-24 09:59:15.814] [d1] [info] Creating Stats instance
++ echo '# HELP ddos_stats_pkts_packets Total Dropped Packets
# TYPE ddos_stats_pkts_packets counter
ddos_stats_pkts_packets{cubeName="d1"} 0.000000
# HELP ddos_blacklist_src_addresses Number of addresses in blacklist-src
# TYPE ddos_blacklist_src_addresses gauge
ddos_blacklist_src_addresses{cubeName="d1"} 4.000000
# HELP ddos_blacklist_dst_addresses Number of addresses in blacklist-dst
# TYPE ddos_blacklist_dst_addresses gauge
ddos_blacklist_dst_addresses{cubeName="d1"} 0.000000
# HELP simplebridge_entry_fdb_number_entries Number of entries associated with the filtering database
# TYPE simplebridge_entry_fdb_number_entries gauge
# HELP simpleforwarder_actions_entries Number of entries of the Actions table
# TYPE simpleforwarder_actions_entries gauge
# HELP pbforwarder_rules_number_rules Number of rules
# TYPE pbforwarder_rules_number_rules gauge
# HELP k8switch_service_client_exported_services Number of services exported to the client
# TYPE k8switch_service_client_exported_services gauge
# HELP k8switch_backend_servers Number of backend servers that actually serve requests
# TYPE k8switch_backend_servers gauge
# HELP k8switch_fwd_table_entries Number of entries associated with the forwarding table
# TYPE k8switch_fwd_table_entries gauge
# HELP router_ip_ports Number of ports of the router with ip
# TYPE router_ip_ports gauge
router_ip_ports{cubeName="r1"} 2.000000
# HELP router_secondaryip_ports Number of secondary ip addresses of the router
# TYPE router_secondaryip_ports gauge
router_secondaryip_ports{cubeName="r1"} 3.000000
# HELP router_ports Number of ports on the router
# TYPE router_ports gauge
router_ports{cubeName="r1"} 2.000000
# HELP router_route_routes Number of entries in routing table
# TYPE router_route_routes gauge
router_route_routes{cubeName="r1"} 2.000000
# HELP router_arp_table_entries Number of entries in arp table
# TYPE router_arp_table_entries gauge
router_arp_table_entries{cubeName="r1"} 0.000000'
Files /dev/fd/63 and /dev/fd/62 differ
+ cleanup
+ set +e
+ polycubectl del d1
+ polycubectl del r1
[2020-12-24 09:59:16.830] [Router] [r1] [info] Destroying Router instance
+ echo FAIL
FAIL
</failure><system-out>[2020-12-24 09:59:07.593] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:59:07.594] [polycubed] [info] configuration parameters: 
[2020-12-24 09:59:07.594] [polycubed] [info]  loglevel: info
[2020-12-24 09:59:07.594] [polycubed] [info]  daemon: false
[2020-12-24 09:59:07.594] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:59:07.594] [polycubed] [info]  port: 9000
[2020-12-24 09:59:07.594] [polycubed] [info]  addr: localhost
[2020-12-24 09:59:07.594] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:59:07.594] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:59:07.594] [polycubed] [info] polycubed starting...
[2020-12-24 09:59:07.594] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:59:09.769] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:59:09.770] [polycubed] [info] rest server starting ...
[2020-12-24 09:59:09.817] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:59:09.827] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:59:09.841] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:59:09.851] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:59:09.883] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:59:09.893] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:59:09.934] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:59:09.966] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:59:10.000] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:59:10.043] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:59:10.086] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:59:10.109] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:59:10.120] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:59:10.135] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:59:10.144] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:59:10.152] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:59:10.194] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:59:10.241] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:59:10.241] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ polycubectl ddosmitigator add d1
[2020-12-24 09:59:12.514] [d1] [info] Creating Ddosmitigator instance d1
+ polycubectl d1 blacklist-src add 10.0.0.1
[2020-12-24 09:59:12.520] [d1] [info] reloading code ...
+ polycubectl d1 blacklist-src add 10.1.1.2
+ polycubectl d1 blacklist-src add 10.1.1.3
+ polycubectl d1 blacklist-src add 10.1.1.4
+ polycubectl router add r1
[2020-12-24 09:59:15.763] [Router] [r1] [info] Creating Router instance
+ polycubectl r1 ports add p1
[2020-12-24 09:59:15.770] [Router] [r1] [info] Added new port: p1 (index: 0) [mac: c6:33:85:37:3c:9e - ip: ]
+ polycubectl r1 ports p1 set ip=10.1.1.1/24
[2020-12-24 09:59:15.776] [Router] [r1] [info] Added route [network: 10.1.1.1/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.776] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports add p2
[2020-12-24 09:59:15.781] [Router] [r1] [info] Added new port: p2 (index: 1) [mac: 46:a0:65:8c:06:79 - ip: ]
+ polycubectl r1 ports p2 set ip=10.1.2.1/24
[2020-12-24 09:59:15.785] [Router] [r1] [info] Added route [network: 10.1.2.1/32 - nexthop: 0.0.0.0 - interface: p2]
[2020-12-24 09:59:15.785] [Router] [r1] [info] Added route [network: 10.1.2.0/24 - nexthop: 0.0.0.0 - interface: p2]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.10/24
[2020-12-24 09:59:15.790] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.10/24]
[2020-12-24 09:59:15.790] [Router] [r1] [info] Added route [network: 10.1.1.10/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.790] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.11/24
[2020-12-24 09:59:15.795] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.11/24]
[2020-12-24 09:59:15.795] [Router] [r1] [info] Added route [network: 10.1.1.11/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.795] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl r1 ports p1 secondaryip add 10.1.1.12/24
[2020-12-24 09:59:15.801] [Router] [r1] [info] Adding secondary address [port: p1 - ip: 10.1.1.12/24]
[2020-12-24 09:59:15.801] [Router] [r1] [info] Added route [network: 10.1.1.12/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 09:59:15.801] [Router] [r1] [info] Added route [network: 10.1.1.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ diff -q /dev/fd/63 /dev/fd/62
++ echo '# HELP ddos_stats_pkts_packets Total Dropped Packets
# TYPE ddos_stats_pkts_packets counter
ddos_stats_pkts_packets{cubeName="d1"} 0.000000
# HELP k8switch_service_client_exported_services Number of services exported to the client
# TYPE k8switch_service_client_exported_services gauge
# HELP k8switch_backend_servers Number of backend servers that actually serve requests
# TYPE k8switch_backend_servers gauge
# HELP k8switch_fwd_table_entries Number of entries associated with the forwarding table
# TYPE k8switch_fwd_table_entries gauge
# HELP router_ip_ports Number of ports of the router with ip
# TYPE router_ip_ports gauge
router_ip_ports{cubeName="r1"} 2.000000
# HELP router_secondaryip_ports Number of secondary ip addresses of the router
# TYPE router_secondaryip_ports gauge
router_secondaryip_ports{cubeName="r1"} 3.000000
# HELP router_ports Number of ports on the router
# TYPE router_ports gauge
router_ports{cubeName="r1"} 2.000000
# HELP router_route_routes Number of entries in routing table
# TYPE router_route_routes gauge
router_route_routes{cubeName="r1"} 2.000000
# HELP router_arp_table_entries Number of entries in arp table
# TYPE router_arp_table_entries gauge
router_arp_table_entries{cubeName="r1"} 0.000000
# HELP simplebridge_entry_fdb_number_entries Number of entries associated with the filtering database
# TYPE simplebridge_entry_fdb_number_entries gauge
# HELP ddos_blacklist_src_addresses Number of addresses in blacklist-src
# TYPE ddos_blacklist_src_addresses gauge
ddos_blacklist_src_addresses{cubeName="d1"} 4.000000
# HELP ddos_blacklist_dst_addresses Number of addresses in blacklist-dst
# TYPE ddos_blacklist_dst_addresses gauge
ddos_blacklist_dst_addresses{cubeName="d1"} 0.000000
# HELP simpleforwarder_actions_entries Number of entries of the Actions table
# TYPE simpleforwarder_actions_entries gauge
# HELP pbforwarder_rules_number_rules Number of rules
# TYPE pbforwarder_rules_number_rules gauge'
+++ curl -s localhost:9000/polycube/v1/metrics
[2020-12-24 09:59:15.814] [d1] [info] Creating Stats instance
++ echo '# HELP ddos_stats_pkts_packets Total Dropped Packets
# TYPE ddos_stats_pkts_packets counter
ddos_stats_pkts_packets{cubeName="d1"} 0.000000
# HELP ddos_blacklist_src_addresses Number of addresses in blacklist-src
# TYPE ddos_blacklist_src_addresses gauge
ddos_blacklist_src_addresses{cubeName="d1"} 4.000000
# HELP ddos_blacklist_dst_addresses Number of addresses in blacklist-dst
# TYPE ddos_blacklist_dst_addresses gauge
ddos_blacklist_dst_addresses{cubeName="d1"} 0.000000
# HELP simplebridge_entry_fdb_number_entries Number of entries associated with the filtering database
# TYPE simplebridge_entry_fdb_number_entries gauge
# HELP simpleforwarder_actions_entries Number of entries of the Actions table
# TYPE simpleforwarder_actions_entries gauge
# HELP pbforwarder_rules_number_rules Number of rules
# TYPE pbforwarder_rules_number_rules gauge
# HELP k8switch_service_client_exported_services Number of services exported to the client
# TYPE k8switch_service_client_exported_services gauge
# HELP k8switch_backend_servers Number of backend servers that actually serve requests
# TYPE k8switch_backend_servers gauge
# HELP k8switch_fwd_table_entries Number of entries associated with the forwarding table
# TYPE k8switch_fwd_table_entries gauge
# HELP router_ip_ports Number of ports of the router with ip
# TYPE router_ip_ports gauge
router_ip_ports{cubeName="r1"} 2.000000
# HELP router_secondaryip_ports Number of secondary ip addresses of the router
# TYPE router_secondaryip_ports gauge
router_secondaryip_ports{cubeName="r1"} 3.000000
# HELP router_ports Number of ports on the router
# TYPE router_ports gauge
router_ports{cubeName="r1"} 2.000000
# HELP router_route_routes Number of entries in routing table
# TYPE router_route_routes gauge
router_route_routes{cubeName="r1"} 2.000000
# HELP router_arp_table_entries Number of entries in arp table
# TYPE router_arp_table_entries gauge
router_arp_table_entries{cubeName="r1"} 0.000000'
Files /dev/fd/63 and /dev/fd/62 differ
+ cleanup
+ set +e
+ polycubectl del d1
+ polycubectl del r1
[2020-12-24 09:59:16.830] [Router] [r1] [info] Destroying Router instance
+ echo FAIL
FAIL
</system-out></testcase><testcase name="./test_stack_programs_chain_tc.sh" time="14.000000" status="Passed"><system-out>[2020-12-24 09:59:18.908] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:59:18.908] [polycubed] [info] configuration parameters: 
[2020-12-24 09:59:18.908] [polycubed] [info]  loglevel: info
[2020-12-24 09:59:18.908] [polycubed] [info]  daemon: false
[2020-12-24 09:59:18.908] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:59:18.908] [polycubed] [info]  port: 9000
[2020-12-24 09:59:18.908] [polycubed] [info]  addr: localhost
[2020-12-24 09:59:18.908] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:59:18.908] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:59:18.908] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:59:18.908] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:59:18.908] [polycubed] [info] polycubed starting...
[2020-12-24 09:59:18.908] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:59:21.077] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:59:21.077] [polycubed] [info] rest server starting ...
[2020-12-24 09:59:21.120] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:59:21.130] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:59:21.143] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:59:21.152] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:59:21.184] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:59:21.193] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:59:21.234] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:59:21.265] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:59:21.298] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:59:21.340] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:59:21.383] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:59:21.404] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:59:21.414] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:59:21.429] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:59:21.437] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:59:21.445] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:59:21.486] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:59:21.532] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:59:21.532] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
net.ipv6.conf.veth1.disable_ipv6 = 1
net.ipv6.conf.veth1_.disable_ipv6 = 1
+ sudo ip addr add 10.0.0.2/24 dev veth1
+ polycubectl helloworld add hw1 loglevel=trace type=tc
[2020-12-24 09:59:23.449] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl hw1 ports add to_veth1 peer=veth1
[2020-12-24 09:59:24.016] [Helloworld] [hw1] [info] port to_veth1 was connected
+ polycubectl transparenthelloworld add th1 loglevel=trace type=tc
[2020-12-24 09:59:24.441] [Transparenthelloworld] [th1] [info] Creating Transparenthelloworld instance
+ polycubectl attach th1 veth1
[2020-12-24 09:59:25.141] [Transparenthelloworld] [th1] [info] attached
[2020-12-24 09:59:25.141] [Transparenthelloworld] [th1] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th2 loglevel=trace type=tc
[2020-12-24 09:59:25.551] [Transparenthelloworld] [th2] [info] Creating Transparenthelloworld instance
+ polycubectl attach th2 hw1:to_veth1
[2020-12-24 09:59:26.707] [Transparenthelloworld] [th2] [info] attached
[2020-12-24 09:59:26.707] [Transparenthelloworld] [th2] [info] parent peer is: veth1
+ set +x
[2020-12-24 09:59:26.710] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:26.710] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:26.710] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:26.710] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:26.710] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:26.710] [Helloworld] [hw1] [debug] Dropping packet
[2020-12-24 09:59:27.728] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:27.729] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:27.729] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:27.729] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:27.729] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:27.729] [Helloworld] [hw1] [debug] Dropping packet
[2020-12-24 09:59:28.752] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:28.752] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:28.752] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:28.752] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:28.753] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:28.753] [Helloworld] [hw1] [debug] Dropping packet
+ polycubectl hw1 del
[2020-12-24 09:59:29.792] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ polycubectl th1 del
+ polycubectl th2 del
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_stack_programs_chain_xdp.sh" time="17.000000" status="Passed"><system-out>[2020-12-24 09:59:32.634] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:59:32.635] [polycubed] [info] configuration parameters: 
[2020-12-24 09:59:32.635] [polycubed] [info]  loglevel: info
[2020-12-24 09:59:32.635] [polycubed] [info]  daemon: false
[2020-12-24 09:59:32.635] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:59:32.635] [polycubed] [info]  port: 9000
[2020-12-24 09:59:32.635] [polycubed] [info]  addr: localhost
[2020-12-24 09:59:32.635] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:59:32.635] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:59:32.635] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:59:32.635] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:59:32.635] [polycubed] [info] polycubed starting...
[2020-12-24 09:59:32.635] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:59:34.796] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:59:34.796] [polycubed] [info] rest server starting ...
[2020-12-24 09:59:34.841] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:59:34.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:59:34.865] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:59:34.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:59:34.907] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:59:34.916] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:59:34.957] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:59:34.989] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:59:35.022] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:59:35.064] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:59:35.107] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:59:35.129] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:59:35.139] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:59:35.154] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:59:35.162] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:59:35.170] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:59:35.211] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:59:35.257] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:59:35.257] [polycubed] [info] loading metrics from yang files
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
net.ipv6.conf.veth1.disable_ipv6 = 1
net.ipv6.conf.veth1_.disable_ipv6 = 1
+ sudo ip addr add 10.0.0.2/24 dev veth1
+ polycubectl helloworld add hw1 loglevel=trace type=xdp_skb
[2020-12-24 09:59:37.363] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl hw1 ports add to_veth1 peer=veth1
[2020-12-24 09:59:38.587] [Helloworld] [hw1] [info] port to_veth1 was connected
+ polycubectl transparenthelloworld add th1 loglevel=trace type=xdp_skb
[2020-12-24 09:59:39.185] [Transparenthelloworld] [th1] [info] Creating Transparenthelloworld instance
+ polycubectl attach th1 veth1
[2020-12-24 09:59:40.286] [Transparenthelloworld] [th1] [info] attached
[2020-12-24 09:59:40.286] [Transparenthelloworld] [th1] [info] parent peer is: veth1
+ polycubectl transparenthelloworld add th2 loglevel=trace type=xdp_skb
[2020-12-24 09:59:40.887] [Transparenthelloworld] [th2] [info] Creating Transparenthelloworld instance
+ polycubectl attach th2 hw1:to_veth1
[2020-12-24 09:59:42.804] [Transparenthelloworld] [th2] [info] attached
[2020-12-24 09:59:42.804] [Transparenthelloworld] [th2] [info] parent peer is: veth1
+ set +x
[2020-12-24 09:59:42.806] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:42.806] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:42.806] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:42.806] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:42.806] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:42.806] [Helloworld] [hw1] [debug] Dropping packet
[2020-12-24 09:59:43.824] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:43.824] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:43.825] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:43.825] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:43.825] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:43.825] [Helloworld] [hw1] [debug] Dropping packet
[2020-12-24 09:59:44.848] [Helloworld] [hw1] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 09:59:44.848] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 09:59:44.848] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 09:59:44.848] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 09:59:44.848] [Helloworld] [hw1] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 09:59:44.848] [Helloworld] [hw1] [debug] Dropping packet
+ polycubectl hw1 del
[2020-12-24 09:59:45.888] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ polycubectl th1 del
+ polycubectl th2 del
+ set +x
SUCCESS
</system-out></testcase><testcase name="./test_stress.sh" time="84.000000" status="Passed"><system-out>[2020-12-24 09:59:49.625] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 09:59:49.626] [polycubed] [info] configuration parameters: 
[2020-12-24 09:59:49.626] [polycubed] [info]  loglevel: info
[2020-12-24 09:59:49.626] [polycubed] [info]  daemon: false
[2020-12-24 09:59:49.626] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 09:59:49.626] [polycubed] [info]  port: 9000
[2020-12-24 09:59:49.626] [polycubed] [info]  addr: localhost
[2020-12-24 09:59:49.626] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 09:59:49.626] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 09:59:49.626] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 09:59:49.626] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 09:59:49.626] [polycubed] [info] polycubed starting...
[2020-12-24 09:59:49.626] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 09:59:51.793] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 09:59:51.793] [polycubed] [info] rest server starting ...
[2020-12-24 09:59:51.841] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 09:59:51.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 09:59:51.866] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 09:59:51.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 09:59:51.908] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 09:59:51.918] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 09:59:51.959] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 09:59:51.991] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 09:59:52.025] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 09:59:52.068] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 09:59:52.112] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 09:59:52.134] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 09:59:52.145] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 09:59:52.160] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 09:59:52.168] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 09:59:52.177] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 09:59:52.218] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 09:59:52.266] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 09:59:52.266] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 09:59:55.277] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 09:59:55.277] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 09:59:56.127] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 09:59:56.127] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 09:59:56.991] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 09:59:56.991] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 09:59:57.836] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 09:59:57.836] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 09:59:58.680] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 09:59:58.680] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 09:59:59.527] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 09:59:59.527] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:00:00.373] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:00:00.373] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:00:01.232] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:00:01.233] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:00:02.077] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:00:02.078] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:00:02.921] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:00:02.921] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:00:11.692] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:00:12.303] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:00:13.151] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:00:14.015] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:00:14.859] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:00:15.707] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:00:16.552] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:00:17.403] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:00:18.262] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:00:19.104] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:00:20.780] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:00:20.780] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:00:21.621] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:00:21.621] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:00:22.465] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:00:22.465] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:00:23.306] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:00:23.306] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:00:24.150] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:00:24.150] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:00:24.995] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:00:24.995] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:00:25.840] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:00:25.840] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:00:26.684] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:00:26.684] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:00:27.530] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:00:27.530] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:00:28.379] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:00:28.379] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:00:37.182] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:00:37.807] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:00:38.647] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:00:39.488] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:00:40.330] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:00:41.175] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:00:42.019] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:00:42.863] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:00:43.716] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:00:44.555] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:00:46.246] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:00:46.246] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:00:47.098] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:00:47.098] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:00:47.950] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:00:47.950] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:00:48.805] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:00:48.805] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:00:49.656] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:00:49.656] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:00:50.498] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:00:50.498] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:00:51.349] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:00:51.349] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:00:52.193] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:00:52.193] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:00:53.038] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:00:53.038] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:00:53.893] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:00:53.893] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:01:02.690] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:01:03.271] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:01:04.123] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:01:04.983] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:01:05.827] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:01:06.680] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:01:07.528] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:01:08.376] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:01:09.220] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:01:10.068] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
</system-out></testcase><testcase name="./test_stress2.sh" time="57.000000" status="Passed"><system-out>[2020-12-24 10:01:13.454] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:01:13.455] [polycubed] [info] configuration parameters: 
[2020-12-24 10:01:13.455] [polycubed] [info]  loglevel: info
[2020-12-24 10:01:13.455] [polycubed] [info]  daemon: false
[2020-12-24 10:01:13.455] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:01:13.455] [polycubed] [info]  port: 9000
[2020-12-24 10:01:13.455] [polycubed] [info]  addr: localhost
[2020-12-24 10:01:13.455] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:01:13.455] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:01:13.455] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:01:13.455] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:01:13.455] [polycubed] [info] polycubed starting...
[2020-12-24 10:01:13.455] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:01:15.639] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:01:15.639] [polycubed] [info] rest server starting ...
[2020-12-24 10:01:15.684] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:01:15.695] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:01:15.710] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:01:15.720] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:01:15.753] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:01:15.764] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:01:15.806] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:01:15.839] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:01:15.874] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:01:15.917] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:01:15.961] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:01:15.984] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:01:15.995] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:01:16.011] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:01:16.020] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:01:16.029] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:01:16.071] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:01:16.118] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:01:16.119] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:01:19.125] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:01:19.125] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:01:19.979] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:01:19.979] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:01:20.859] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:01:20.859] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:01:21.716] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:01:21.716] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:01:22.572] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:01:22.572] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:01:23.422] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:01:23.422] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:01:24.276] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:01:24.276] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:01:25.141] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:01:25.141] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:01:25.988] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:01:25.988] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:01:26.836] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:01:26.836] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:01:26.893] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:01:27.133] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:01:27.987] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:01:28.868] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:01:29.723] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:01:30.579] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:01:31.430] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:01:32.284] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:01:33.149] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:01:33.996] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:01:35.679] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:01:35.679] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:01:36.522] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:01:36.522] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:01:37.370] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:01:37.370] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:01:38.218] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:01:38.218] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:01:39.066] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:01:39.066] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:01:39.915] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:01:39.915] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:01:40.763] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:01:40.763] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:01:41.615] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:01:41.615] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:01:42.467] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:01:42.467] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:01:43.328] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:01:43.329] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:01:43.383] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:01:43.687] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:01:44.529] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:01:45.378] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:01:46.225] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:01:47.073] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:01:47.922] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:01:48.772] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:01:49.622] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:01:50.475] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:01:52.181] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:01:52.181] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:01:53.025] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:01:53.025] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:01:53.877] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:01:53.877] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:01:54.726] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:01:54.726] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:01:55.578] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:01:55.578] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:01:56.428] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:01:56.428] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:01:57.276] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:01:57.276] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:01:58.122] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:01:58.122] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:01:58.981] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:01:58.981] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:01:59.831] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:01:59.831] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:01:59.880] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:02:00.190] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:02:01.033] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:02:01.885] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:02:02.734] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:02:03.585] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:02:04.436] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:02:05.285] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:02:06.129] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:02:06.990] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
</system-out></testcase><testcase name="./test_stress3.sh" time="144.000000" status="Passed"><system-out>[2020-12-24 10:02:10.358] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:02:10.359] [polycubed] [info] configuration parameters: 
[2020-12-24 10:02:10.359] [polycubed] [info]  loglevel: info
[2020-12-24 10:02:10.359] [polycubed] [info]  daemon: false
[2020-12-24 10:02:10.359] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:02:10.359] [polycubed] [info]  port: 9000
[2020-12-24 10:02:10.359] [polycubed] [info]  addr: localhost
[2020-12-24 10:02:10.359] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:02:10.359] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:02:10.359] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:02:10.359] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:02:10.359] [polycubed] [info] polycubed starting...
[2020-12-24 10:02:10.359] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:02:12.526] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:02:12.526] [polycubed] [info] rest server starting ...
[2020-12-24 10:02:12.568] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:02:12.579] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:02:12.593] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:02:12.602] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:02:12.635] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:02:12.644] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:02:12.686] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:02:12.719] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:02:12.753] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:02:12.796] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:02:12.841] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:02:12.863] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:02:12.873] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:02:12.888] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:02:12.897] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:02:12.906] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:02:12.948] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:02:12.995] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:02:12.995] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
+ create_link 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ for i in `seq 1 $1`
+ sudo ip link add link21 type veth peer name link22
+ sudo ip link set dev link21 up
+ sudo ip link set dev link22 up
+ for i in `seq 1 $1`
+ sudo ip link add link31 type veth peer name link32
+ sudo ip link set dev link31 up
+ sudo ip link set dev link32 up
+ for i in `seq 1 $1`
+ sudo ip link add link41 type veth peer name link42
+ sudo ip link set dev link41 up
+ sudo ip link set dev link42 up
+ for i in `seq 1 $1`
+ sudo ip link add link51 type veth peer name link52
+ sudo ip link set dev link51 up
+ sudo ip link set dev link52 up
+ for i in `seq 1 $1`
+ sudo ip link add link61 type veth peer name link62
+ sudo ip link set dev link61 up
+ sudo ip link set dev link62 up
+ for i in `seq 1 $1`
+ sudo ip link add link71 type veth peer name link72
+ sudo ip link set dev link71 up
+ sudo ip link set dev link72 up
+ for i in `seq 1 $1`
+ sudo ip link add link81 type veth peer name link82
+ sudo ip link set dev link81 up
+ sudo ip link set dev link82 up
+ for i in `seq 1 $1`
+ sudo ip link add link91 type veth peer name link92
+ sudo ip link set dev link91 up
+ sudo ip link set dev link92 up
+ for i in `seq 1 $1`
+ sudo ip link add link101 type veth peer name link102
+ sudo ip link set dev link101 up
+ sudo ip link set dev link102 up
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:02:16.370] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:02:16.370] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:02:17.221] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:02:17.221] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:02:18.090] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:02:18.090] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:02:18.940] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:02:18.940] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:02:19.794] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:02:19.794] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:02:20.650] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:02:20.650] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:02:21.499] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:02:21.499] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:02:22.365] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:02:22.365] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:02:23.215] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:02:23.215] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:02:24.069] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:02:24.069] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ simplebridge_add_port br1 link11
+ polycubectl simplebridge br1 ports add link11
+ polycubectl simplebridge br1 ports link11 set peer=link11
+ next=2
+ ((  2 &lt;= 10  ))
+ simplebridge_add_port br2 link12
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br2 ports link12 set peer=link12
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ simplebridge_add_port br2 link21
+ polycubectl simplebridge br2 ports add link21
+ polycubectl simplebridge br2 ports link21 set peer=link21
+ next=3
+ ((  3 &lt;= 10  ))
+ simplebridge_add_port br3 link22
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br3 ports link22 set peer=link22
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ simplebridge_add_port br3 link31
+ polycubectl simplebridge br3 ports add link31
+ polycubectl simplebridge br3 ports link31 set peer=link31
+ next=4
+ ((  4 &lt;= 10  ))
+ simplebridge_add_port br4 link32
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br4 ports link32 set peer=link32
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ simplebridge_add_port br4 link41
+ polycubectl simplebridge br4 ports add link41
+ polycubectl simplebridge br4 ports link41 set peer=link41
+ next=5
+ ((  5 &lt;= 10  ))
+ simplebridge_add_port br5 link42
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br5 ports link42 set peer=link42
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ simplebridge_add_port br5 link51
+ polycubectl simplebridge br5 ports add link51
+ polycubectl simplebridge br5 ports link51 set peer=link51
+ next=6
+ ((  6 &lt;= 10  ))
+ simplebridge_add_port br6 link52
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br6 ports link52 set peer=link52
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ simplebridge_add_port br6 link61
+ polycubectl simplebridge br6 ports add link61
+ polycubectl simplebridge br6 ports link61 set peer=link61
+ next=7
+ ((  7 &lt;= 10  ))
+ simplebridge_add_port br7 link62
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br7 ports link62 set peer=link62
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ simplebridge_add_port br7 link71
+ polycubectl simplebridge br7 ports add link71
+ polycubectl simplebridge br7 ports link71 set peer=link71
+ next=8
+ ((  8 &lt;= 10  ))
+ simplebridge_add_port br8 link72
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br8 ports link72 set peer=link72
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ simplebridge_add_port br8 link81
+ polycubectl simplebridge br8 ports add link81
+ polycubectl simplebridge br8 ports link81 set peer=link81
+ next=9
+ ((  9 &lt;= 10  ))
+ simplebridge_add_port br9 link82
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br9 ports link82 set peer=link82
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ simplebridge_add_port br9 link91
+ polycubectl simplebridge br9 ports add link91
+ polycubectl simplebridge br9 ports link91 set peer=link91
+ next=10
+ ((  10 &lt;= 10  ))
+ simplebridge_add_port br10 link92
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br10 ports link92 set peer=link92
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ simplebridge_add_port br10 link101
+ polycubectl simplebridge br10 ports add link101
+ polycubectl simplebridge br10 ports link101 set peer=link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:02:53.027] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:02:53.412] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:02:54.280] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:02:55.155] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:02:56.011] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:02:56.864] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:02:57.715] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:02:58.559] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:02:59.435] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:03:00.283] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:03:01.988] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:03:01.988] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:03:02.833] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:03:02.833] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:03:03.684] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:03:03.684] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:03:04.524] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:03:04.524] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:03:05.366] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:03:05.366] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:03:06.212] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:03:06.212] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:03:07.058] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:03:07.058] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:03:07.904] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:03:07.904] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:03:08.751] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:03:08.751] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:03:09.603] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:03:09.603] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ simplebridge_add_port br1 link11
+ polycubectl simplebridge br1 ports add link11
+ polycubectl simplebridge br1 ports link11 set peer=link11
+ next=2
+ ((  2 &lt;= 10  ))
+ simplebridge_add_port br2 link12
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br2 ports link12 set peer=link12
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ simplebridge_add_port br2 link21
+ polycubectl simplebridge br2 ports add link21
+ polycubectl simplebridge br2 ports link21 set peer=link21
+ next=3
+ ((  3 &lt;= 10  ))
+ simplebridge_add_port br3 link22
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br3 ports link22 set peer=link22
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ simplebridge_add_port br3 link31
+ polycubectl simplebridge br3 ports add link31
+ polycubectl simplebridge br3 ports link31 set peer=link31
+ next=4
+ ((  4 &lt;= 10  ))
+ simplebridge_add_port br4 link32
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br4 ports link32 set peer=link32
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ simplebridge_add_port br4 link41
+ polycubectl simplebridge br4 ports add link41
+ polycubectl simplebridge br4 ports link41 set peer=link41
+ next=5
+ ((  5 &lt;= 10  ))
+ simplebridge_add_port br5 link42
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br5 ports link42 set peer=link42
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ simplebridge_add_port br5 link51
+ polycubectl simplebridge br5 ports add link51
+ polycubectl simplebridge br5 ports link51 set peer=link51
+ next=6
+ ((  6 &lt;= 10  ))
+ simplebridge_add_port br6 link52
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br6 ports link52 set peer=link52
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ simplebridge_add_port br6 link61
+ polycubectl simplebridge br6 ports add link61
+ polycubectl simplebridge br6 ports link61 set peer=link61
+ next=7
+ ((  7 &lt;= 10  ))
+ simplebridge_add_port br7 link62
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br7 ports link62 set peer=link62
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ simplebridge_add_port br7 link71
+ polycubectl simplebridge br7 ports add link71
+ polycubectl simplebridge br7 ports link71 set peer=link71
+ next=8
+ ((  8 &lt;= 10  ))
+ simplebridge_add_port br8 link72
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br8 ports link72 set peer=link72
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ simplebridge_add_port br8 link81
+ polycubectl simplebridge br8 ports add link81
+ polycubectl simplebridge br8 ports link81 set peer=link81
+ next=9
+ ((  9 &lt;= 10  ))
+ simplebridge_add_port br9 link82
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br9 ports link82 set peer=link82
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ simplebridge_add_port br9 link91
+ polycubectl simplebridge br9 ports add link91
+ polycubectl simplebridge br9 ports link91 set peer=link91
+ next=10
+ ((  10 &lt;= 10  ))
+ simplebridge_add_port br10 link92
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br10 ports link92 set peer=link92
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ simplebridge_add_port br10 link101
+ polycubectl simplebridge br10 ports add link101
+ polycubectl simplebridge br10 ports link101 set peer=link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:03:38.650] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:03:39.030] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:03:39.891] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:03:40.751] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:03:41.583] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:03:42.427] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:03:43.275] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:03:44.119] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:03:44.962] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:03:45.810] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:03:47.506] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:03:47.506] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:03:48.350] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:03:48.350] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:03:49.203] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:03:49.203] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:03:50.055] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:03:50.055] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:03:50.904] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:03:50.905] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:03:51.760] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:03:51.760] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:03:52.615] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:03:52.615] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:03:53.471] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:03:53.471] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:03:54.321] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:03:54.321] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:03:55.175] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:03:55.175] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ simplebridge_add_port br1 link11
+ polycubectl simplebridge br1 ports add link11
+ polycubectl simplebridge br1 ports link11 set peer=link11
+ next=2
+ ((  2 &lt;= 10  ))
+ simplebridge_add_port br2 link12
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br2 ports link12 set peer=link12
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ simplebridge_add_port br2 link21
+ polycubectl simplebridge br2 ports add link21
+ polycubectl simplebridge br2 ports link21 set peer=link21
+ next=3
+ ((  3 &lt;= 10  ))
+ simplebridge_add_port br3 link22
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br3 ports link22 set peer=link22
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ simplebridge_add_port br3 link31
+ polycubectl simplebridge br3 ports add link31
+ polycubectl simplebridge br3 ports link31 set peer=link31
+ next=4
+ ((  4 &lt;= 10  ))
+ simplebridge_add_port br4 link32
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br4 ports link32 set peer=link32
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ simplebridge_add_port br4 link41
+ polycubectl simplebridge br4 ports add link41
+ polycubectl simplebridge br4 ports link41 set peer=link41
+ next=5
+ ((  5 &lt;= 10  ))
+ simplebridge_add_port br5 link42
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br5 ports link42 set peer=link42
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ simplebridge_add_port br5 link51
+ polycubectl simplebridge br5 ports add link51
+ polycubectl simplebridge br5 ports link51 set peer=link51
+ next=6
+ ((  6 &lt;= 10  ))
+ simplebridge_add_port br6 link52
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br6 ports link52 set peer=link52
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ simplebridge_add_port br6 link61
+ polycubectl simplebridge br6 ports add link61
+ polycubectl simplebridge br6 ports link61 set peer=link61
+ next=7
+ ((  7 &lt;= 10  ))
+ simplebridge_add_port br7 link62
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br7 ports link62 set peer=link62
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ simplebridge_add_port br7 link71
+ polycubectl simplebridge br7 ports add link71
+ polycubectl simplebridge br7 ports link71 set peer=link71
+ next=8
+ ((  8 &lt;= 10  ))
+ simplebridge_add_port br8 link72
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br8 ports link72 set peer=link72
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ simplebridge_add_port br8 link81
+ polycubectl simplebridge br8 ports add link81
+ polycubectl simplebridge br8 ports link81 set peer=link81
+ next=9
+ ((  9 &lt;= 10  ))
+ simplebridge_add_port br9 link82
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br9 ports link82 set peer=link82
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ simplebridge_add_port br9 link91
+ polycubectl simplebridge br9 ports add link91
+ polycubectl simplebridge br9 ports link91 set peer=link91
+ next=10
+ ((  10 &lt;= 10  ))
+ simplebridge_add_port br10 link92
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br10 ports link92 set peer=link92
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ simplebridge_add_port br10 link101
+ polycubectl simplebridge br10 ports add link101
+ polycubectl simplebridge br10 ports link101 set peer=link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:04:24.157] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:04:24.551] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:04:25.411] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:04:26.267] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:04:27.119] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:04:27.963] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:04:28.820] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:04:29.675] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:04:30.535] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:04:31.383] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ delete_link 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del link11
+ for i in `seq 1 $1`
+ sudo ip link del link21
+ for i in `seq 1 $1`
+ sudo ip link del link31
+ for i in `seq 1 $1`
+ sudo ip link del link41
+ for i in `seq 1 $1`
+ sudo ip link del link51
+ for i in `seq 1 $1`
+ sudo ip link del link61
+ for i in `seq 1 $1`
+ sudo ip link del link71
+ for i in `seq 1 $1`
+ sudo ip link del link81
+ for i in `seq 1 $1`
+ sudo ip link del link91
+ for i in `seq 1 $1`
+ sudo ip link del link101
</system-out></testcase><testcase name="./test_stress4.sh" time="245.000000" status="Passed"><system-out>[2020-12-24 10:04:34.091] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:04:34.092] [polycubed] [info] configuration parameters: 
[2020-12-24 10:04:34.092] [polycubed] [info]  loglevel: info
[2020-12-24 10:04:34.092] [polycubed] [info]  daemon: false
[2020-12-24 10:04:34.092] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:04:34.092] [polycubed] [info]  port: 9000
[2020-12-24 10:04:34.092] [polycubed] [info]  addr: localhost
[2020-12-24 10:04:34.092] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:04:34.092] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:04:34.092] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:04:34.092] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:04:34.092] [polycubed] [info] polycubed starting...
[2020-12-24 10:04:34.092] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:04:36.253] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:04:36.254] [polycubed] [info] rest server starting ...
[2020-12-24 10:04:36.301] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:04:36.311] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:04:36.324] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:04:36.334] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:04:36.367] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:04:36.376] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:04:36.419] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:04:36.452] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:04:36.487] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:04:36.530] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:04:36.575] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:04:36.598] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:04:36.608] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:04:36.623] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:04:36.631] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:04:36.640] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:04:36.683] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:04:36.731] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:04:36.731] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:04:39.794] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:04:39.794] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:04:40.641] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:04:40.641] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:04:41.504] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:04:41.504] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:04:42.349] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:04:42.349] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:04:43.196] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:04:43.196] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:04:44.038] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:04:44.038] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:04:44.887] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:04:44.887] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:04:45.749] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:04:45.749] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:04:46.601] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:04:46.601] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:04:47.456] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:04:47.457] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ polycubectl simplebridge br1 ports add link11
+ next=2
+ ((  2 &lt;= 10  ))
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br1 ports link11 set peer=br2:link12
+ polycubectl simplebridge br2 ports link12 set peer=br1:link11
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ polycubectl simplebridge br2 ports add link21
+ next=3
+ ((  3 &lt;= 10  ))
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br2 ports link21 set peer=br3:link22
+ polycubectl simplebridge br3 ports link22 set peer=br2:link21
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ polycubectl simplebridge br3 ports add link31
+ next=4
+ ((  4 &lt;= 10  ))
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br3 ports link31 set peer=br4:link32
+ polycubectl simplebridge br4 ports link32 set peer=br3:link31
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ polycubectl simplebridge br4 ports add link41
+ next=5
+ ((  5 &lt;= 10  ))
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br4 ports link41 set peer=br5:link42
+ polycubectl simplebridge br5 ports link42 set peer=br4:link41
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ polycubectl simplebridge br5 ports add link51
+ next=6
+ ((  6 &lt;= 10  ))
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br5 ports link51 set peer=br6:link52
+ polycubectl simplebridge br6 ports link52 set peer=br5:link51
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ polycubectl simplebridge br6 ports add link61
+ next=7
+ ((  7 &lt;= 10  ))
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br6 ports link61 set peer=br7:link62
+ polycubectl simplebridge br7 ports link62 set peer=br6:link61
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ polycubectl simplebridge br7 ports add link71
+ next=8
+ ((  8 &lt;= 10  ))
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br7 ports link71 set peer=br8:link72
+ polycubectl simplebridge br8 ports link72 set peer=br7:link71
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ polycubectl simplebridge br8 ports add link81
+ next=9
+ ((  9 &lt;= 10  ))
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br8 ports link81 set peer=br9:link82
+ polycubectl simplebridge br9 ports link82 set peer=br8:link81
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ polycubectl simplebridge br9 ports add link91
+ next=10
+ ((  10 &lt;= 10  ))
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br9 ports link91 set peer=br10:link92
+ polycubectl simplebridge br10 ports link92 set peer=br9:link91
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ polycubectl simplebridge br10 ports add link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:05:25.054] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:05:26.567] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:05:27.415] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:05:28.275] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:05:29.122] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:05:29.959] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:05:30.806] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:05:31.660] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:05:32.519] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:05:33.363] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:05:34.330] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:05:34.330] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:05:35.173] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:05:35.173] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:05:36.021] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:05:36.021] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:05:36.870] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:05:36.870] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:05:37.725] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:05:37.725] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:05:38.578] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:05:38.578] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:05:39.435] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:05:39.435] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:05:40.282] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:05:40.282] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:05:41.127] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:05:41.127] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:05:41.968] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:05:41.968] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ polycubectl simplebridge br1 ports add link11
+ next=2
+ ((  2 &lt;= 10  ))
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br1 ports link11 set peer=br2:link12
+ polycubectl simplebridge br2 ports link12 set peer=br1:link11
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ polycubectl simplebridge br2 ports add link21
+ next=3
+ ((  3 &lt;= 10  ))
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br2 ports link21 set peer=br3:link22
+ polycubectl simplebridge br3 ports link22 set peer=br2:link21
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ polycubectl simplebridge br3 ports add link31
+ next=4
+ ((  4 &lt;= 10  ))
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br3 ports link31 set peer=br4:link32
+ polycubectl simplebridge br4 ports link32 set peer=br3:link31
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ polycubectl simplebridge br4 ports add link41
+ next=5
+ ((  5 &lt;= 10  ))
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br4 ports link41 set peer=br5:link42
+ polycubectl simplebridge br5 ports link42 set peer=br4:link41
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ polycubectl simplebridge br5 ports add link51
+ next=6
+ ((  6 &lt;= 10  ))
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br5 ports link51 set peer=br6:link52
+ polycubectl simplebridge br6 ports link52 set peer=br5:link51
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ polycubectl simplebridge br6 ports add link61
+ next=7
+ ((  7 &lt;= 10  ))
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br6 ports link61 set peer=br7:link62
+ polycubectl simplebridge br7 ports link62 set peer=br6:link61
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ polycubectl simplebridge br7 ports add link71
+ next=8
+ ((  8 &lt;= 10  ))
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br7 ports link71 set peer=br8:link72
+ polycubectl simplebridge br8 ports link72 set peer=br7:link71
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ polycubectl simplebridge br8 ports add link81
+ next=9
+ ((  9 &lt;= 10  ))
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br8 ports link81 set peer=br9:link82
+ polycubectl simplebridge br9 ports link82 set peer=br8:link81
[2020-12-24 10:06:44.809] [polycubed] [warning] packetout: port br8:link81 is down
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ polycubectl simplebridge br9 ports add link91
+ next=10
+ ((  10 &lt;= 10  ))
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br9 ports link91 set peer=br10:link92
+ polycubectl simplebridge br10 ports link92 set peer=br9:link91
[2020-12-24 10:06:53.023] [polycubed] [warning] packetout: port br9:link91 is down
[2020-12-24 10:06:53.024] [polycubed] [warning] packetout: port br9:link91 is down
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ polycubectl simplebridge br10 ports add link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:06:57.911] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:06:59.103] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:06:59.935] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:07:00.779] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:07:01.632] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:07:02.491] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:07:03.338] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:07:04.195] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:07:05.038] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:07:05.883] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:07:06.833] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:07:06.833] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:07:07.666] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:07:07.666] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:07:08.504] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:07:08.504] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:07:09.339] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:07:09.339] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:07:10.177] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:07:10.177] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:07:11.018] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:07:11.018] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:07:11.850] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:07:11.851] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:07:12.682] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:07:12.682] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:07:13.518] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:07:13.518] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:07:14.353] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:07:14.353] [Simplebridge] [br10] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ polycubectl simplebridge br1 ports add link11
+ next=2
+ ((  2 &lt;= 10  ))
+ polycubectl simplebridge br2 ports add link12
+ polycubectl simplebridge br1 ports link11 set peer=br2:link12
+ polycubectl simplebridge br2 ports link12 set peer=br1:link11
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ polycubectl simplebridge br2 ports add link21
+ next=3
+ ((  3 &lt;= 10  ))
+ polycubectl simplebridge br3 ports add link22
+ polycubectl simplebridge br2 ports link21 set peer=br3:link22
+ polycubectl simplebridge br3 ports link22 set peer=br2:link21
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ polycubectl simplebridge br3 ports add link31
+ next=4
+ ((  4 &lt;= 10  ))
+ polycubectl simplebridge br4 ports add link32
+ polycubectl simplebridge br3 ports link31 set peer=br4:link32
+ polycubectl simplebridge br4 ports link32 set peer=br3:link31
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ polycubectl simplebridge br4 ports add link41
+ next=5
+ ((  5 &lt;= 10  ))
+ polycubectl simplebridge br5 ports add link42
+ polycubectl simplebridge br4 ports link41 set peer=br5:link42
+ polycubectl simplebridge br5 ports link42 set peer=br4:link41
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ polycubectl simplebridge br5 ports add link51
+ next=6
+ ((  6 &lt;= 10  ))
+ polycubectl simplebridge br6 ports add link52
+ polycubectl simplebridge br5 ports link51 set peer=br6:link52
+ polycubectl simplebridge br6 ports link52 set peer=br5:link51
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ polycubectl simplebridge br6 ports add link61
+ next=7
+ ((  7 &lt;= 10  ))
+ polycubectl simplebridge br7 ports add link62
+ polycubectl simplebridge br6 ports link61 set peer=br7:link62
+ polycubectl simplebridge br7 ports link62 set peer=br6:link61
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ polycubectl simplebridge br7 ports add link71
+ next=8
+ ((  8 &lt;= 10  ))
+ polycubectl simplebridge br8 ports add link72
+ polycubectl simplebridge br7 ports link71 set peer=br8:link72
+ polycubectl simplebridge br8 ports link72 set peer=br7:link71
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ polycubectl simplebridge br8 ports add link81
+ next=9
+ ((  9 &lt;= 10  ))
+ polycubectl simplebridge br9 ports add link82
+ polycubectl simplebridge br8 ports link81 set peer=br9:link82
+ polycubectl simplebridge br9 ports link82 set peer=br8:link81
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ polycubectl simplebridge br9 ports add link91
+ next=10
+ ((  10 &lt;= 10  ))
+ polycubectl simplebridge br10 ports add link92
+ polycubectl simplebridge br9 ports link91 set peer=br10:link92
+ polycubectl simplebridge br10 ports link92 set peer=br9:link91
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ polycubectl simplebridge br10 ports add link101
+ next=11
+ ((  11 &lt;= 10  ))
+ sleep 1
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:08:30.204] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:08:31.590] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:08:32.431] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:08:33.262] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:08:34.099] [Simplebridge] [br5] [info] Destroying Simplebridge instance
[2020-12-24 10:08:34.864] [polycubed] [warning] packetout: port br10:link101 is down
[2020-12-24 10:08:34.911] [polycubed] [warning] packetout: port br6:link52 is down
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:08:34.931] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:08:35.775] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:08:36.611] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:08:37.439] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:08:38.270] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
</system-out></testcase><testcase name="./test_stress5.sh" time="85.000000" status="Passed"><system-out>[2020-12-24 10:08:39.875] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:08:39.875] [polycubed] [info] configuration parameters: 
[2020-12-24 10:08:39.875] [polycubed] [info]  loglevel: info
[2020-12-24 10:08:39.875] [polycubed] [info]  daemon: false
[2020-12-24 10:08:39.875] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:08:39.875] [polycubed] [info]  port: 9000
[2020-12-24 10:08:39.875] [polycubed] [info]  addr: localhost
[2020-12-24 10:08:39.875] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:08:39.875] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:08:39.875] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:08:39.875] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:08:39.875] [polycubed] [info] polycubed starting...
[2020-12-24 10:08:39.875] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:08:42.024] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:08:42.024] [polycubed] [info] rest server starting ...
[2020-12-24 10:08:42.068] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:08:42.078] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:08:42.092] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:08:42.102] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:08:42.134] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:08:42.144] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:08:42.186] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:08:42.218] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:08:42.252] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:08:42.295] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:08:42.339] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:08:42.361] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:08:42.371] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:08:42.386] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:08:42.394] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:08:42.403] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:08:42.445] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:08:42.492] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:08:42.492] [polycubed] [info] loading metrics from yang files
+ set -e
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:08:44.779] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:08:44.780] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:08:45.612] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:08:45.612] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:08:46.470] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:08:46.470] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:08:47.312] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:08:47.312] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:08:48.153] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:08:48.153] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:08:48.998] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:08:48.998] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:08:49.838] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:08:49.838] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:08:50.697] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:08:50.697] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:08:51.547] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:08:51.547] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:08:52.400] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:08:52.400] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:09:02.070] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:09:02.803] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:09:03.639] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:09:04.495] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:09:05.335] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:09:06.180] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:09:07.034] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:09:07.863] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:09:08.723] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:09:09.575] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:09:11.647] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:09:11.647] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:09:12.481] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:09:12.481] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:09:13.319] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:09:13.319] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:09:14.157] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:09:14.157] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:09:15.003] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:09:15.003] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:09:15.846] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:09:15.846] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:09:16.695] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:09:16.695] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:09:17.541] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:09:17.541] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:09:18.390] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:09:18.390] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:09:19.236] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:09:19.236] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:09:28.833] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:09:29.676] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:09:30.507] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:09:31.343] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:09:32.179] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:09:33.031] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:09:33.870] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:09:34.719] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:09:35.567] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:09:36.415] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:09:38.497] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:09:38.497] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:09:39.331] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:09:39.331] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:09:40.171] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:09:40.171] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:09:41.010] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:09:41.010] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:09:41.844] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:09:41.844] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:09:42.680] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:09:42.680] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:09:43.513] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:09:43.513] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:09:44.345] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:09:44.345] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:09:45.188] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:09:45.188] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:09:46.018] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:09:46.018] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:09:55.420] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:09:55.519] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:09:56.354] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:09:57.199] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:09:58.036] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:09:58.867] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:09:59.703] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:10:00.540] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:10:01.368] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:10:02.219] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
Cannot find device "veth1"
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth2
Cannot find device "veth2"
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth3
Cannot find device "veth3"
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth4
Cannot find device "veth4"
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth5
Cannot find device "veth5"
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth6
Cannot find device "veth6"
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth7
Cannot find device "veth7"
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth8
Cannot find device "veth8"
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth9
Cannot find device "veth9"
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth10
Cannot find device "veth10"
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
</system-out></testcase><testcase name="./test_stress6.sh" time="86.000000" status="Passed"><system-out>[2020-12-24 10:10:04.657] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:10:04.657] [polycubed] [info] configuration parameters: 
[2020-12-24 10:10:04.657] [polycubed] [info]  loglevel: info
[2020-12-24 10:10:04.657] [polycubed] [info]  daemon: false
[2020-12-24 10:10:04.657] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:10:04.657] [polycubed] [info]  port: 9000
[2020-12-24 10:10:04.657] [polycubed] [info]  addr: localhost
[2020-12-24 10:10:04.657] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:10:04.657] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:10:04.657] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:10:04.657] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:10:04.657] [polycubed] [info] polycubed starting...
[2020-12-24 10:10:04.657] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:10:06.802] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:10:06.803] [polycubed] [info] rest server starting ...
[2020-12-24 10:10:06.848] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:10:06.858] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:10:06.873] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:10:06.883] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:10:06.915] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:10:06.926] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:10:06.967] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:10:07.000] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:10:07.034] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:10:07.076] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:10:07.120] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:10:07.142] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:10:07.153] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:10:07.167] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:10:07.176] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:10:07.184] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:10:07.225] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:10:07.272] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:10:07.273] [polycubed] [info] loading metrics from yang files
+ set -e
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:10:09.574] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:10:09.574] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:10:10.415] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:10:10.415] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:10:11.276] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:10:11.276] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:10:12.116] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:10:12.116] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:10:12.957] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:10:12.957] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:10:13.800] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:10:13.800] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:10:14.639] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:10:14.639] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:10:15.497] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:10:15.497] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:10:16.339] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:10:16.339] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:10:17.185] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:10:17.185] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:10:26.879] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:10:27.602] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:10:28.439] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:10:29.311] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:10:30.139] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:10:30.987] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:10:31.828] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:10:32.668] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:10:33.528] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:10:34.363] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:10:36.479] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:10:36.479] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:10:37.331] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:10:37.331] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:10:38.187] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:10:38.187] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:10:39.047] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:10:39.047] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:10:39.904] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:10:39.904] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:10:40.757] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:10:40.757] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:10:41.613] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:10:41.613] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:10:42.468] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:10:42.468] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:10:43.318] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:10:43.318] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:10:44.177] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:10:44.177] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:10:53.897] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:10:54.511] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:10:55.359] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:10:56.211] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:10:57.071] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:10:57.927] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:10:58.783] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:10:59.639] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:11:00.491] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:11:01.347] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ for k in `seq 1 $M`
+ add_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:11:03.479] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:11:03.479] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:11:04.315] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:11:04.315] [Simplebridge] [br2] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br3
[2020-12-24 10:11:05.147] [Simplebridge] [br3] [info] Creating Simplebridge instance
[2020-12-24 10:11:05.147] [Simplebridge] [br3] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br4
[2020-12-24 10:11:05.985] [Simplebridge] [br4] [info] Creating Simplebridge instance
[2020-12-24 10:11:05.985] [Simplebridge] [br4] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br5
[2020-12-24 10:11:06.824] [Simplebridge] [br5] [info] Creating Simplebridge instance
[2020-12-24 10:11:06.824] [Simplebridge] [br5] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br6
[2020-12-24 10:11:07.668] [Simplebridge] [br6] [info] Creating Simplebridge instance
[2020-12-24 10:11:07.668] [Simplebridge] [br6] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br7
[2020-12-24 10:11:08.502] [Simplebridge] [br7] [info] Creating Simplebridge instance
[2020-12-24 10:11:08.502] [Simplebridge] [br7] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br8
[2020-12-24 10:11:09.343] [Simplebridge] [br8] [info] Creating Simplebridge instance
[2020-12-24 10:11:09.343] [Simplebridge] [br8] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br9
[2020-12-24 10:11:10.193] [Simplebridge] [br9] [info] Creating Simplebridge instance
[2020-12-24 10:11:10.193] [Simplebridge] [br9] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br10
[2020-12-24 10:11:11.035] [Simplebridge] [br10] [info] Creating Simplebridge instance
[2020-12-24 10:11:11.035] [Simplebridge] [br10] [info] Creating Fdb instance
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br3 veth3
+ polycubectl simplebridge br3 ports add veth3
+ polycubectl simplebridge br3 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br4 veth4
+ polycubectl simplebridge br4 ports add veth4
+ polycubectl simplebridge br4 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br5 veth5
+ polycubectl simplebridge br5 ports add veth5
+ polycubectl simplebridge br5 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br6 veth6
+ polycubectl simplebridge br6 ports add veth6
+ polycubectl simplebridge br6 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br7 veth7
+ polycubectl simplebridge br7 ports add veth7
+ polycubectl simplebridge br7 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br8 veth8
+ polycubectl simplebridge br8 ports add veth8
+ polycubectl simplebridge br8 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br9 veth9
+ polycubectl simplebridge br9 ports add veth9
+ polycubectl simplebridge br9 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br10 veth10
+ polycubectl simplebridge br10 ports add veth10
+ polycubectl simplebridge br10 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br3 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br4 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br5 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br6 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br7 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br8 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br9 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br10 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:11:20.602] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:11:21.503] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
[2020-12-24 10:11:22.339] [Simplebridge] [br3] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
[2020-12-24 10:11:23.178] [Simplebridge] [br4] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
[2020-12-24 10:11:24.007] [Simplebridge] [br5] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
[2020-12-24 10:11:24.852] [Simplebridge] [br6] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
[2020-12-24 10:11:25.691] [Simplebridge] [br7] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
[2020-12-24 10:11:26.527] [Simplebridge] [br8] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
[2020-12-24 10:11:27.366] [Simplebridge] [br9] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
[2020-12-24 10:11:28.219] [Simplebridge] [br10] [info] Destroying Simplebridge instance
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ cleanup
+ set +e
+ del_simplebridges 10
++ seq 1 10
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br3
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br6
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br7
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br8
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br9
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
Cannot find device "veth1"
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth2
Cannot find device "veth2"
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth3
Cannot find device "veth3"
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth4
Cannot find device "veth4"
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth5
Cannot find device "veth5"
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth6
Cannot find device "veth6"
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth7
Cannot find device "veth7"
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth8
Cannot find device "veth8"
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth9
Cannot find device "veth9"
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ for i in `seq 1 $1`
+ sudo ip link del veth10
Cannot find device "veth10"
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
</system-out></testcase><testcase name="./test_stress7.sh" time="76.000000" status="Passed"><system-out>[2020-12-24 10:11:30.634] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:11:30.635] [polycubed] [info] configuration parameters: 
[2020-12-24 10:11:30.635] [polycubed] [info]  loglevel: info
[2020-12-24 10:11:30.635] [polycubed] [info]  daemon: false
[2020-12-24 10:11:30.635] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:11:30.635] [polycubed] [info]  port: 9000
[2020-12-24 10:11:30.635] [polycubed] [info]  addr: localhost
[2020-12-24 10:11:30.635] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:11:30.635] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:11:30.635] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:11:30.635] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:11:30.635] [polycubed] [info] polycubed starting...
[2020-12-24 10:11:30.635] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:11:32.812] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:11:32.812] [polycubed] [info] rest server starting ...
[2020-12-24 10:11:32.856] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:11:32.867] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:11:32.881] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:11:32.890] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:11:32.922] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:11:32.932] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:11:32.973] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:11:33.005] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:11:33.039] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:11:33.081] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:11:33.125] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:11:33.146] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:11:33.156] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:11:33.170] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:11:33.179] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:11:33.187] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:11:33.228] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:11:33.274] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:11:33.275] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns3
Cannot remove namespace file "/var/run/netns/ns3": No such file or directory
+ true
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns4
Cannot remove namespace file "/var/run/netns/ns4": No such file or directory
+ true
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns5
Cannot remove namespace file "/var/run/netns/ns5": No such file or directory
+ true
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns6
Cannot remove namespace file "/var/run/netns/ns6": No such file or directory
+ true
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns7
Cannot remove namespace file "/var/run/netns/ns7": No such file or directory
+ true
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns8
Cannot remove namespace file "/var/run/netns/ns8": No such file or directory
+ true
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns9
Cannot remove namespace file "/var/run/netns/ns9": No such file or directory
+ true
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns10
Cannot remove namespace file "/var/run/netns/ns10": No such file or directory
+ true
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
++ seq 1 3
+ for k in `seq 1 $M`
+ add_simplebridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:11:36.323] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:11:36.323] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:11:37.175] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:11:37.175] [Simplebridge] [br2] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth3
+ polycubectl simplebridge br1 ports add veth3
+ polycubectl simplebridge br1 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth4
+ polycubectl simplebridge br1 ports add veth4
+ polycubectl simplebridge br1 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth5
+ polycubectl simplebridge br1 ports add veth5
+ polycubectl simplebridge br1 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth6
+ polycubectl simplebridge br1 ports add veth6
+ polycubectl simplebridge br1 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth7
+ polycubectl simplebridge br1 ports add veth7
+ polycubectl simplebridge br1 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth8
+ polycubectl simplebridge br1 ports add veth8
+ polycubectl simplebridge br1 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth9
+ polycubectl simplebridge br1 ports add veth9
+ polycubectl simplebridge br1 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth10
+ polycubectl simplebridge br1 ports add veth10
+ polycubectl simplebridge br1 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br1
[2020-12-24 10:11:47.255] [Simplebridge] [br1] [info] Destroying Simplebridge instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth1
+ polycubectl simplebridge br2 ports add veth1
+ polycubectl simplebridge br2 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth5
+ polycubectl simplebridge br2 ports add veth5
+ polycubectl simplebridge br2 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth6
+ polycubectl simplebridge br2 ports add veth6
+ polycubectl simplebridge br2 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth7
+ polycubectl simplebridge br2 ports add veth7
+ polycubectl simplebridge br2 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth8
+ polycubectl simplebridge br2 ports add veth8
+ polycubectl simplebridge br2 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth9
+ polycubectl simplebridge br2 ports add veth9
+ polycubectl simplebridge br2 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth10
+ polycubectl simplebridge br2 ports add veth10
+ polycubectl simplebridge br2 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br2
[2020-12-24 10:11:57.485] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:11:59.213] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:11:59.213] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:12:00.062] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:12:00.062] [Simplebridge] [br2] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth3
+ polycubectl simplebridge br1 ports add veth3
+ polycubectl simplebridge br1 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth4
+ polycubectl simplebridge br1 ports add veth4
+ polycubectl simplebridge br1 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth5
+ polycubectl simplebridge br1 ports add veth5
+ polycubectl simplebridge br1 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth6
+ polycubectl simplebridge br1 ports add veth6
+ polycubectl simplebridge br1 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth7
+ polycubectl simplebridge br1 ports add veth7
+ polycubectl simplebridge br1 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth8
+ polycubectl simplebridge br1 ports add veth8
+ polycubectl simplebridge br1 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth9
+ polycubectl simplebridge br1 ports add veth9
+ polycubectl simplebridge br1 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth10
+ polycubectl simplebridge br1 ports add veth10
+ polycubectl simplebridge br1 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br1
[2020-12-24 10:12:10.066] [Simplebridge] [br1] [info] Destroying Simplebridge instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth1
+ polycubectl simplebridge br2 ports add veth1
+ polycubectl simplebridge br2 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth5
+ polycubectl simplebridge br2 ports add veth5
+ polycubectl simplebridge br2 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth6
+ polycubectl simplebridge br2 ports add veth6
+ polycubectl simplebridge br2 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth7
+ polycubectl simplebridge br2 ports add veth7
+ polycubectl simplebridge br2 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth8
+ polycubectl simplebridge br2 ports add veth8
+ polycubectl simplebridge br2 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth9
+ polycubectl simplebridge br2 ports add veth9
+ polycubectl simplebridge br2 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth10
+ polycubectl simplebridge br2 ports add veth10
+ polycubectl simplebridge br2 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br2
[2020-12-24 10:12:20.371] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ for k in `seq 1 $M`
+ add_simplebridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:12:22.094] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:12:22.094] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:12:22.941] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:12:22.941] [Simplebridge] [br2] [info] Creating Fdb instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth3
+ polycubectl simplebridge br1 ports add veth3
+ polycubectl simplebridge br1 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth4
+ polycubectl simplebridge br1 ports add veth4
+ polycubectl simplebridge br1 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth5
+ polycubectl simplebridge br1 ports add veth5
+ polycubectl simplebridge br1 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth6
+ polycubectl simplebridge br1 ports add veth6
+ polycubectl simplebridge br1 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth7
+ polycubectl simplebridge br1 ports add veth7
+ polycubectl simplebridge br1 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth8
+ polycubectl simplebridge br1 ports add veth8
+ polycubectl simplebridge br1 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth9
+ polycubectl simplebridge br1 ports add veth9
+ polycubectl simplebridge br1 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br1 veth10
+ polycubectl simplebridge br1 ports add veth10
+ polycubectl simplebridge br1 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br1 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br1
[2020-12-24 10:12:32.936] [Simplebridge] [br1] [info] Destroying Simplebridge instance
++ seq 1 10
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth1
+ polycubectl simplebridge br2 ports add veth1
+ polycubectl simplebridge br2 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth2
+ polycubectl simplebridge br2 ports add veth2
+ polycubectl simplebridge br2 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth5
+ polycubectl simplebridge br2 ports add veth5
+ polycubectl simplebridge br2 ports veth5 set peer=veth5
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth6
+ polycubectl simplebridge br2 ports add veth6
+ polycubectl simplebridge br2 ports veth6 set peer=veth6
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth7
+ polycubectl simplebridge br2 ports add veth7
+ polycubectl simplebridge br2 ports veth7 set peer=veth7
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth8
+ polycubectl simplebridge br2 ports add veth8
+ polycubectl simplebridge br2 ports veth8 set peer=veth8
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth9
+ polycubectl simplebridge br2 ports add veth9
+ polycubectl simplebridge br2 ports veth9 set peer=veth9
+ for i in `seq 1 $N`
+ simplebridge_add_port br2 veth10
+ polycubectl simplebridge br2 ports add veth10
+ polycubectl simplebridge br2 ports veth10 set peer=veth10
+ set +e
++ seq 1 10
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ for i in `seq 1 $N`
+ polycubectl simplebridge br2 ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ polycubectl simplebridge br_not_existing ports del port_not_existing
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ set -e
+ polycubectl simplebridge del br2
[2020-12-24 10:12:43.303] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ cleanup
+ set +e
+ del_simplebridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
+ delete_veth 10
++ seq 1 10
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
</system-out></testcase><testcase name="./transparent_services/test_attach_non_transparent_service.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 10:12:46.572] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:12:46.573] [polycubed] [info] configuration parameters: 
[2020-12-24 10:12:46.573] [polycubed] [info]  loglevel: info
[2020-12-24 10:12:46.573] [polycubed] [info]  daemon: false
[2020-12-24 10:12:46.573] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:12:46.573] [polycubed] [info]  port: 9000
[2020-12-24 10:12:46.573] [polycubed] [info]  addr: localhost
[2020-12-24 10:12:46.573] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:12:46.573] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:12:46.573] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:12:46.573] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:12:46.573] [polycubed] [info] polycubed starting...
[2020-12-24 10:12:46.573] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:12:48.752] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:12:48.752] [polycubed] [info] rest server starting ...
[2020-12-24 10:12:48.797] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:12:48.807] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:12:48.821] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:12:48.830] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:12:48.862] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:12:48.872] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:12:48.913] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:12:48.945] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:12:48.979] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:12:49.021] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:12:49.065] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:12:49.087] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:12:49.098] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:12:49.112] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:12:49.121] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:12:49.129] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:12:49.170] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:12:49.216] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:12:49.216] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:12:51.188] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:12:51.600] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:51.752] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:12:51.856] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:51.856] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:52.108] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:52.176] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:52.176] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:12:52.456] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl helloworld add hw1 loglevel=TRACE
[2020-12-24 10:12:52.592] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:12:52.592] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:12:52.592] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:12:52.690] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:12:52.690] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:12:52.740] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:12:52.752] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:12:52.867] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl attach hw1 hw0:port1
[2020-12-24 10:12:52.873] [polycubed] [error] Cube hw1 is not transparent
Cube hw1 is not transparent
+ polycubectl del hw0
[2020-12-24 10:12:52.878] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hw1
[2020-12-24 10:12:52.971] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_attach_same_service_multiple_times.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 10:12:55.115] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:12:55.116] [polycubed] [info] configuration parameters: 
[2020-12-24 10:12:55.116] [polycubed] [info]  loglevel: info
[2020-12-24 10:12:55.116] [polycubed] [info]  daemon: false
[2020-12-24 10:12:55.116] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:12:55.116] [polycubed] [info]  port: 9000
[2020-12-24 10:12:55.116] [polycubed] [info]  addr: localhost
[2020-12-24 10:12:55.116] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:12:55.116] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:12:55.116] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:12:55.116] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:12:55.116] [polycubed] [info] polycubed starting...
[2020-12-24 10:12:55.116] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:12:57.299] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:12:57.300] [polycubed] [info] rest server starting ...
[2020-12-24 10:12:57.344] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:12:57.355] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:12:57.369] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:12:57.378] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:12:57.412] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:12:57.422] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:12:57.465] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:12:57.499] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:12:57.534] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:12:57.578] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:12:57.623] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:12:57.646] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:12:57.656] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:12:57.671] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:12:57.680] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:12:57.688] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:12:57.731] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:12:57.780] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:12:57.780] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:12:59.723] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:00.144] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:00.292] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:00.562] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:00.562] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:00.996] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:01.136] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:01.168] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:01.296] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:01.405] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:13:01.584] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:01.968] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:01.968] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:01.968] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:02.032] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:02.032] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:02.032] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:02.032] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:02.407] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:13:02.407] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ polycubectl attach hwT hw0:port2
[2020-12-24 10:13:02.413] [polycubed] [error] Cube hwT is already attached
Cube hwT is already attached
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:02.420] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:02.420] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:02.420] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:02.420] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:02.420] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.115 ms
[2020-12-24 10:13:02.420] [Helloworld] [hw0] [debug] Forwarding packet

[2020-12-24 10:13:02.421] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.115/0.115/0.115/0.000 ms
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:02.421] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:02.421] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:02.421] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:13:02.426] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_delete_after_detach.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 10:13:04.917] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:04.918] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:04.918] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:04.918] [polycubed] [info]  daemon: false
[2020-12-24 10:13:04.918] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:04.918] [polycubed] [info]  port: 9000
[2020-12-24 10:13:04.918] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:04.918] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:04.918] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:04.918] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:04.918] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:04.918] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:04.918] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:07.081] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:07.081] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:07.125] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:07.135] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:07.148] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:07.158] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:07.191] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:07.200] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:07.243] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:13:07.276] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:13:07.310] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:13:07.353] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:13:07.398] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:13:07.420] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:13:07.430] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:13:07.444] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:13:07.453] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:13:07.461] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:13:07.503] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:13:07.551] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:13:07.551] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:13:09.550] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:10.120] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:10.480] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:10.480] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:10.642] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:10.642] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:10.824] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:13:10.928] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:10.928] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:10.960] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:11.120] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:11.120] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:11.120] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:11.237] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:13:11.472] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:11.568] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:11.888] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:11.888] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:11.888] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:12.240] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:13:12.240] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:12.249] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] Forwarding packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.124 ms
[2020-12-24 10:13:12.249] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet

[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.124/0.124/0.124/0.000 ms
[2020-12-24 10:13:12.249] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:12.249] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:12.249] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl detach hwT hw0:port1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] Forwarding packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.065 ms
[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1

[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.065/0.065/0.065/0.000 ms
[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:12.676] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:13:12.682] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_delete_before_detach.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 10:13:13.869] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:13.870] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:13.870] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:13.870] [polycubed] [info]  daemon: false
[2020-12-24 10:13:13.870] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:13.870] [polycubed] [info]  port: 9000
[2020-12-24 10:13:13.870] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:13.870] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:13.870] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:13.870] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:13.870] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:13.870] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:13.870] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:16.033] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:16.034] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:16.080] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:16.091] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:16.105] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:16.114] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:16.148] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:16.158] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:16.201] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:13:16.233] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:13:16.268] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:13:16.311] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:13:16.355] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:13:16.378] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:13:16.388] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:13:16.402] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:13:16.411] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:13:16.419] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:13:16.462] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:13:16.509] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:13:16.510] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:13:18.484] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:18.704] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:19.048] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:19.536] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:19.536] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:19.728] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:19.728] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:19.748] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:13:19.792] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:19.890] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:19.890] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:20.016] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:20.016] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:20.016] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:20.076] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:20.157] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:13:20.560] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:20.560] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:20.560] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:21.156] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:13:21.157] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:21.198] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.115 ms
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1

[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.115/0.115/0.115/0.000 ms
[2020-12-24 10:13:21.198] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:21.198] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:21.198] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:21.198] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwT
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.063 ms
[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] Forwarding packet

[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.063/0.063/0.063/0.000 ms
[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:21.621] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:13:21.627] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_delete_cube_in_between.sh" time="17.000000" status="Passed"><system-out>[2020-12-24 10:13:22.803] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:22.803] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:22.803] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:22.803] [polycubed] [info]  daemon: false
[2020-12-24 10:13:22.803] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:22.803] [polycubed] [info]  port: 9000
[2020-12-24 10:13:22.803] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:22.803] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:22.803] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:22.803] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:22.803] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:22.803] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:22.803] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:24.979] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:24.979] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:25.024] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:25.034] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:25.047] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:25.056] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:25.088] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:25.097] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:25.138] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:13:25.170] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:13:25.203] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:13:25.245] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:13:25.288] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:13:25.310] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:13:25.320] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:13:25.334] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:13:25.342] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:13:25.351] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:13:25.392] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:13:25.438] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:13:25.438] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:13:27.415] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:27.980] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:28.370] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:28.370] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:28.528] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:28.528] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:28.684] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwTA loglevel=TRACE
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:29.008] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:29.009] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:29.009] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:29.096] [Transparenthelloworld] [hwTA] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTB loglevel=TRACE
[2020-12-24 10:13:29.136] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:29.136] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:29.136] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:29.296] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:29.296] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:29.296] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:29.328] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:29.392] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:29.503] [Transparenthelloworld] [hwTB] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTC loglevel=TRACE
[2020-12-24 10:13:29.912] [Transparenthelloworld] [hwTC] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTD loglevel=TRACE
[2020-12-24 10:13:30.323] [Transparenthelloworld] [hwTD] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwTA hw0:port1 position=first
[2020-12-24 10:13:31.320] [Transparenthelloworld] [hwTA] [info] attached
[2020-12-24 10:13:31.320] [Transparenthelloworld] [hwTA] [info] parent peer is: veth1
+ polycubectl attach hwTB hw0:port1 position=first
[2020-12-24 10:13:32.336] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:13:32.336] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:13:32.336] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:32.336] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:32.336] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:32.489] [Transparenthelloworld] [hwTB] [info] attached
[2020-12-24 10:13:32.489] [Transparenthelloworld] [hwTB] [info] parent peer is: veth1
+ polycubectl attach hwTC hw0:port1 position=first
[2020-12-24 10:13:32.848] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:33.104] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:33.104] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:33.104] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:33.104] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:13:33.104] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:13:33.104] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:33.663] [Transparenthelloworld] [hwTC] [info] attached
[2020-12-24 10:13:33.663] [Transparenthelloworld] [hwTC] [info] parent peer is: veth1
+ polycubectl attach hwTD hw0:port1 position=first
[2020-12-24 10:13:34.830] [Transparenthelloworld] [hwTD] [info] attached
[2020-12-24 10:13:34.830] [Transparenthelloworld] [hwTD] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:34.876] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] Forwarding packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.153 ms

[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.153/0.153/0.153/0.000 ms
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:13:34.877] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwTB
+ polycubectl del hwTC
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:36.640] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:13:36.640] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.089 ms
[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0

[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.089/0.089/0.089/0.000 ms
[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:36.640] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:13:36.640] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:13:36.640] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwTA
+ polycubectl del hwTD
+ polycubectl del hw0
[2020-12-24 10:13:37.786] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_delete_port_with_cube.sh" time="10.000000" status="Passed"><system-out>[2020-12-24 10:13:40.005] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:40.005] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:40.005] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:40.005] [polycubed] [info]  daemon: false
[2020-12-24 10:13:40.005] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:40.005] [polycubed] [info]  port: 9000
[2020-12-24 10:13:40.005] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:40.005] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:40.005] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:40.005] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:40.005] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:40.005] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:40.005] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:42.158] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:42.158] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:42.205] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:42.216] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:42.230] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:42.240] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:42.275] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:42.285] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:42.330] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:13:42.365] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:13:42.402] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:13:42.448] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:13:42.496] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:13:42.520] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:13:42.531] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:13:42.546] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:13:42.555] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:13:42.564] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:13:42.608] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:13:42.659] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:13:42.659] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:13:44.595] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:45.156] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:45.300] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:45.300] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:45.682] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:45.682] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:45.776] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:45.868] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:13:45.968] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:46.192] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:46.208] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:46.208] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:46.208] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:46.279] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:13:46.608] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:47.281] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:13:47.281] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:13:47.323] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.131 ms

[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.131/0.131/0.131/0.000 ms
[2020-12-24 10:13:47.323] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:47.323] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:47.323] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:13:47.323] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl hw0 ports del port1
[2020-12-24 10:13:47.945] [Helloworld] [hw0] [info] port port1 was removed
+ polycubectl del hwT
+ polycubectl del hw0
[2020-12-24 10:13:47.957] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_detach_non_attached_cube.sh" time="8.000000" status="Passed"><system-out>[2020-12-24 10:13:49.099] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:49.099] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:49.100] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:49.100] [polycubed] [info]  daemon: false
[2020-12-24 10:13:49.100] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:49.100] [polycubed] [info]  port: 9000
[2020-12-24 10:13:49.100] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:49.100] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:49.100] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:49.100] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:49.100] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:49.100] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:49.100] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:51.258] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:51.259] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:51.300] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:51.311] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:51.325] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:51.334] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:51.367] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:51.377] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:51.420] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:13:51.453] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:13:51.487] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:13:51.531] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:13:51.576] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:13:51.598] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:13:51.609] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:13:51.624] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:13:51.632] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:13:51.641] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:13:51.683] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:13:51.732] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:13:51.732] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:13:53.699] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:13:54.264] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:13:54.480] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:54.480] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:54.802] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:54.802] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:54.888] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:54.964] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:13:55.024] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:13:55.024] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:55.024] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:55.186] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:55.186] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:13:55.312] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:13:55.312] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:13:55.312] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:13:55.375] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl detach hwT hw0:port1
[2020-12-24 10:13:55.382] [polycubed] [error] Cube doesn't exist
Cube doesn't exist
+ polycubectl del hw0
[2020-12-24 10:13:55.388] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_helloworld_with_helloworldT.sh" time="10.000000" status="Passed"><system-out>[2020-12-24 10:13:57.636] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:13:57.636] [polycubed] [info] configuration parameters: 
[2020-12-24 10:13:57.636] [polycubed] [info]  loglevel: info
[2020-12-24 10:13:57.636] [polycubed] [info]  daemon: false
[2020-12-24 10:13:57.636] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:13:57.636] [polycubed] [info]  port: 9000
[2020-12-24 10:13:57.636] [polycubed] [info]  addr: localhost
[2020-12-24 10:13:57.636] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:13:57.636] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:13:57.636] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:13:57.636] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:13:57.636] [polycubed] [info] polycubed starting...
[2020-12-24 10:13:57.636] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:13:59.813] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:13:59.814] [polycubed] [info] rest server starting ...
[2020-12-24 10:13:59.856] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:13:59.866] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:13:59.880] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:13:59.889] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:13:59.923] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:13:59.932] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:13:59.974] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:14:00.007] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:14:00.042] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:14:00.085] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:14:00.130] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:14:00.153] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:14:00.163] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:14:00.179] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:14:00.187] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:14:00.196] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:14:00.238] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:14:00.286] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:14:00.286] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:14:02.196] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:14:02.764] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:14:02.928] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:02.928] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:02.992] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:02.992] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:03.442] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:03.442] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:03.472] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:14:03.568] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:03.568] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:03.568] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:03.600] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:03.600] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:03.600] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:03.885] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:14:04.208] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:04.884] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:14:04.884] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:14:04.892] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:04.892] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:04.892] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:04.892] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:04.892] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:04.892] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:04.892] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.125 ms
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0

[2020-12-24 10:14:04.893] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.125/0.125/0.125/0.000 ms
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:04.893] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:14:04.893] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:14:04.899] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_incompatible_hooks.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 10:14:07.399] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:14:07.400] [polycubed] [info] configuration parameters: 
[2020-12-24 10:14:07.400] [polycubed] [info]  loglevel: info
[2020-12-24 10:14:07.400] [polycubed] [info]  daemon: false
[2020-12-24 10:14:07.400] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:14:07.400] [polycubed] [info]  port: 9000
[2020-12-24 10:14:07.400] [polycubed] [info]  addr: localhost
[2020-12-24 10:14:07.400] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:14:07.400] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:14:07.400] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:14:07.400] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:14:07.400] [polycubed] [info] polycubed starting...
[2020-12-24 10:14:07.400] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:14:09.559] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:14:09.560] [polycubed] [info] rest server starting ...
[2020-12-24 10:14:09.604] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:14:09.614] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:14:09.628] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:14:09.638] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:14:09.671] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:14:09.680] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:14:09.722] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:14:09.755] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:14:09.790] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:14:09.833] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:14:09.878] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:14:09.901] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:14:09.911] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:14:09.926] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:14:09.935] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:14:09.943] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:14:09.986] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:14:10.034] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:14:10.034] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:14:12.020] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:14:12.584] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:14:12.752] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:12.752] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:12.882] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:12.882] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:12.944] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:12.944] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:13.072] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:13.292] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE type=XDP_SKB
[2020-12-24 10:14:13.328] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:13.328] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:13.648] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:13.890] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:14:13.896] [polycubed] [error] hwT and hw0:port1 have incompatible types
hwT and hw0:port1 have incompatible types
+ polycubectl del hw0
[2020-12-24 10:14:13.901] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_netdev_support.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 10:14:16.103] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:14:16.104] [polycubed] [info] configuration parameters: 
[2020-12-24 10:14:16.104] [polycubed] [info]  loglevel: info
[2020-12-24 10:14:16.104] [polycubed] [info]  daemon: false
[2020-12-24 10:14:16.104] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:14:16.104] [polycubed] [info]  port: 9000
[2020-12-24 10:14:16.104] [polycubed] [info]  addr: localhost
[2020-12-24 10:14:16.104] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:14:16.104] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:14:16.104] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:14:16.104] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:14:16.104] [polycubed] [info] polycubed starting...
[2020-12-24 10:14:16.104] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:14:18.267] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:14:18.268] [polycubed] [info] rest server starting ...
[2020-12-24 10:14:18.311] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:14:18.321] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:14:18.335] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:14:18.344] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:14:18.376] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:14:18.386] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:14:18.427] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:14:18.459] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:14:18.493] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:14:18.535] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:14:18.578] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:14:18.599] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:14:18.609] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:14:18.624] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:14:18.632] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:14:18.641] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:14:18.682] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:14:18.728] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:14:18.728] [polycubed] [info] loading metrics from yang files
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ifconfig veth1 10.0.0.2/24
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:14:20.631] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT veth1
[2020-12-24 10:14:21.392] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:21.392] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:21.484] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:14:21.484] [Transparenthelloworld] [hwT] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.082 ms

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.082/0.082/0.082/0.000 ms
[2020-12-24 10:14:21.497] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:21.497] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:14:21.497] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:21.497] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
+ polycubectl hwT set egress-action=DROP
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:14:21.510] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:21.510] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:21.713] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:21.713] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:21.840] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:22.512] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:25.328] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:14:26.096] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:26.608] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:27.632] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
[2020-12-24 10:14:28.656] [Transparenthelloworld] [hwT] [debug] [EGRESS] dropping packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 0ms

+ polycubectl detach hwT veth1
+ polycubectl del hwT
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_position_after_and_before.sh" time="17.000000" status="Passed"><system-out>[2020-12-24 10:14:32.696] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:14:32.696] [polycubed] [info] configuration parameters: 
[2020-12-24 10:14:32.696] [polycubed] [info]  loglevel: info
[2020-12-24 10:14:32.696] [polycubed] [info]  daemon: false
[2020-12-24 10:14:32.696] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:14:32.696] [polycubed] [info]  port: 9000
[2020-12-24 10:14:32.696] [polycubed] [info]  addr: localhost
[2020-12-24 10:14:32.696] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:14:32.696] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:14:32.696] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:14:32.696] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:14:32.696] [polycubed] [info] polycubed starting...
[2020-12-24 10:14:32.696] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:14:34.841] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:14:34.842] [polycubed] [info] rest server starting ...
[2020-12-24 10:14:34.888] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:14:34.898] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:14:34.911] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:14:34.920] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:14:34.952] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:14:34.961] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:14:35.002] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:14:35.033] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:14:35.067] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:14:35.108] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:14:35.151] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:14:35.172] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:14:35.182] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:14:35.196] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:14:35.205] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:14:35.213] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:14:35.254] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:14:35.300] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:14:35.300] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:14:37.287] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:14:37.848] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:14:38.032] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:38.032] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:38.160] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:38.160] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:38.276] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:38.482] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:38.482] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:38.556] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwTA loglevel=TRACE
[2020-12-24 10:14:38.800] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:38.896] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:38.896] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:38.896] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:38.967] [Transparenthelloworld] [hwTA] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTB loglevel=TRACE
[2020-12-24 10:14:39.248] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:39.378] [Transparenthelloworld] [hwTB] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTC loglevel=TRACE
[2020-12-24 10:14:39.787] [Transparenthelloworld] [hwTC] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTD loglevel=TRACE
[2020-12-24 10:14:40.198] [Transparenthelloworld] [hwTD] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwTA hw0:port1 position=first
[2020-12-24 10:14:41.198] [Transparenthelloworld] [hwTA] [info] attached
[2020-12-24 10:14:41.198] [Transparenthelloworld] [hwTA] [info] parent peer is: veth1
+ polycubectl attach hwTB hw0:port1 position=last
[2020-12-24 10:14:42.224] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:42.224] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:42.224] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:42.224] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:42.224] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:14:42.224] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:14:42.224] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:42.480] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:14:42.480] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:14:42.480] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:42.480] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:42.480] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:42.484] [Transparenthelloworld] [hwTB] [info] attached
[2020-12-24 10:14:42.484] [Transparenthelloworld] [hwTB] [info] parent peer is: veth1
+ polycubectl attach hwTC hw0:port1 after=hwTA
[2020-12-24 10:14:43.946] [Transparenthelloworld] [hwTC] [info] attached
[2020-12-24 10:14:43.946] [Transparenthelloworld] [hwTC] [info] parent peer is: veth1
+ polycubectl attach hwTD hw0:port1 before=hwTB
[2020-12-24 10:14:45.412] [Transparenthelloworld] [hwTD] [info] attached
[2020-12-24 10:14:45.412] [Transparenthelloworld] [hwTD] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.172 ms

[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.172/0.172/0.172/0.000 ms
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:14:45.450] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwTA
+ polycubectl del hwTB
+ polycubectl del hwTC
+ polycubectl del hwTD
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.066 ms

[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.066/0.066/0.066/0.000 ms
[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:47.786] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:14:47.793] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_position_first.sh" time="17.000000" status="Passed"><system-out>[2020-12-24 10:14:49.989] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:14:49.990] [polycubed] [info] configuration parameters: 
[2020-12-24 10:14:49.990] [polycubed] [info]  loglevel: info
[2020-12-24 10:14:49.990] [polycubed] [info]  daemon: false
[2020-12-24 10:14:49.990] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:14:49.990] [polycubed] [info]  port: 9000
[2020-12-24 10:14:49.990] [polycubed] [info]  addr: localhost
[2020-12-24 10:14:49.990] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:14:49.990] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:14:49.990] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:14:49.990] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:14:49.990] [polycubed] [info] polycubed starting...
[2020-12-24 10:14:49.990] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:14:52.152] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:14:52.153] [polycubed] [info] rest server starting ...
[2020-12-24 10:14:52.201] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:14:52.213] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:14:52.229] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:14:52.238] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:14:52.271] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:14:52.280] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:14:52.323] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:14:52.356] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:14:52.390] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:14:52.433] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:14:52.478] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:14:52.499] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:14:52.510] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:14:52.525] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:14:52.533] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:14:52.542] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:14:52.584] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:14:52.632] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:14:52.632] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:14:54.583] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:14:55.140] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:14:55.536] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:55.536] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:55.696] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:55.696] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:55.736] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:55.849] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwTA loglevel=TRACE
[2020-12-24 10:14:56.080] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:56.080] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:56.080] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:56.176] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:56.259] [Transparenthelloworld] [hwTA] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTB loglevel=TRACE
[2020-12-24 10:14:56.592] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:56.668] [Transparenthelloworld] [hwTB] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTC loglevel=TRACE
[2020-12-24 10:14:56.916] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:14:56.916] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:56.916] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:57.078] [Transparenthelloworld] [hwTC] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTD loglevel=TRACE
[2020-12-24 10:14:57.490] [Transparenthelloworld] [hwTD] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwTA hw0:port1 position=first
[2020-12-24 10:14:58.493] [Transparenthelloworld] [hwTA] [info] attached
[2020-12-24 10:14:58.493] [Transparenthelloworld] [hwTA] [info] parent peer is: veth1
+ polycubectl attach hwTB hw0:port1 position=first
[2020-12-24 10:14:59.632] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:14:59.669] [Transparenthelloworld] [hwTB] [info] attached
[2020-12-24 10:14:59.669] [Transparenthelloworld] [hwTB] [info] parent peer is: veth1
+ polycubectl attach hwTC hw0:port1 position=first
[2020-12-24 10:14:59.888] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:14:59.888] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:14:59.888] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:14:59.888] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:14:59.888] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:14:59.888] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:00.144] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:00.144] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:00.144] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:00.144] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:00.144] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:00.838] [Transparenthelloworld] [hwTC] [info] attached
[2020-12-24 10:15:00.838] [Transparenthelloworld] [hwTC] [info] parent peer is: veth1
+ polycubectl attach hwTD hw0:port1 position=first
[2020-12-24 10:15:02.015] [Transparenthelloworld] [hwTD] [info] attached
[2020-12-24 10:15:02.015] [Transparenthelloworld] [hwTD] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.180 ms
[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] Forwarding packet

[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.180/0.180/0.180/0.000 ms
[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.058] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:02.058] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.059] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:02.059] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwTA
+ polycubectl del hwTB
+ polycubectl del hwTC
+ polycubectl del hwTD
+ polycubectl del hw0
[2020-12-24 10:15:04.608] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_position_last.sh" time="17.000000" status="Passed"><system-out>[2020-12-24 10:15:06.801] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:15:06.801] [polycubed] [info] configuration parameters: 
[2020-12-24 10:15:06.801] [polycubed] [info]  loglevel: info
[2020-12-24 10:15:06.801] [polycubed] [info]  daemon: false
[2020-12-24 10:15:06.801] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:15:06.801] [polycubed] [info]  port: 9000
[2020-12-24 10:15:06.801] [polycubed] [info]  addr: localhost
[2020-12-24 10:15:06.801] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:15:06.801] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:15:06.801] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:15:06.801] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:15:06.801] [polycubed] [info] polycubed starting...
[2020-12-24 10:15:06.801] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:15:08.952] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:15:08.953] [polycubed] [info] rest server starting ...
[2020-12-24 10:15:08.995] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:15:09.006] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:15:09.019] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:15:09.028] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:15:09.060] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:15:09.070] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:15:09.111] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:15:09.142] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:15:09.176] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:15:09.218] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:15:09.261] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:15:09.283] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:15:09.293] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:15:09.308] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:15:09.317] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:15:09.325] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:15:09.366] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:15:09.413] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:15:09.413] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:15:11.397] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:15:11.696] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:11.960] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:15:12.112] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:12.112] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:12.112] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:12.112] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:12.528] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:12.528] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:12.664] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwTA loglevel=TRACE
[2020-12-24 10:15:12.756] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:12.756] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:12.756] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:12.756] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:12.756] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:12.816] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:12.944] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:12.944] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:12.944] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:13.074] [Transparenthelloworld] [hwTA] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTB loglevel=TRACE
[2020-12-24 10:15:13.487] [Transparenthelloworld] [hwTB] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTC loglevel=TRACE
[2020-12-24 10:15:13.584] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:13.897] [Transparenthelloworld] [hwTC] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add hwTD loglevel=TRACE
[2020-12-24 10:15:14.309] [Transparenthelloworld] [hwTD] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwTA hw0:port1 position=last
[2020-12-24 10:15:15.295] [Transparenthelloworld] [hwTA] [info] attached
[2020-12-24 10:15:15.295] [Transparenthelloworld] [hwTA] [info] parent peer is: veth1
+ polycubectl attach hwTB hw0:port1 position=last
[2020-12-24 10:15:16.272] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:15:16.272] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:15:16.272] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:16.272] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:16.272] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:16.528] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:16.528] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:16.528] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:16.528] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:16.528] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:16.575] [Transparenthelloworld] [hwTB] [info] attached
[2020-12-24 10:15:16.575] [Transparenthelloworld] [hwTB] [info] parent peer is: veth1
+ polycubectl attach hwTC hw0:port1 position=last
[2020-12-24 10:15:16.784] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:17.040] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:17.864] [Transparenthelloworld] [hwTC] [info] attached
[2020-12-24 10:15:17.864] [Transparenthelloworld] [hwTC] [info] parent peer is: veth1
+ polycubectl attach hwTD hw0:port1 position=last
[2020-12-24 10:15:19.158] [Transparenthelloworld] [hwTD] [info] attached
[2020-12-24 10:15:19.158] [Transparenthelloworld] [hwTD] [info] parent peer is: veth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.154 ms
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1

[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.154/0.154/0.154/0.000 ms
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTD] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTC] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTB] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTA] [debug] [INGRESS] passing packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTA] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTB] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTC] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Transparenthelloworld] [hwTD] [debug] [EGRESS] passing packet
[2020-12-24 10:15:19.170] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hwTA
+ polycubectl del hwTB
+ polycubectl del hwTC
+ polycubectl del hwTD
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.065 ms
[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] Forwarding packet

[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.065/0.065/0.065/0.000 ms
[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:21.373] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:15:21.379] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_service_chain.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:15:23.572] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:15:23.573] [polycubed] [info] configuration parameters: 
[2020-12-24 10:15:23.573] [polycubed] [info]  loglevel: info
[2020-12-24 10:15:23.573] [polycubed] [info]  daemon: false
[2020-12-24 10:15:23.573] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:15:23.573] [polycubed] [info]  port: 9000
[2020-12-24 10:15:23.573] [polycubed] [info]  addr: localhost
[2020-12-24 10:15:23.573] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:15:23.573] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:15:23.573] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:15:23.573] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:15:23.573] [polycubed] [info] polycubed starting...
[2020-12-24 10:15:23.573] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:15:25.740] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:15:25.740] [polycubed] [info] rest server starting ...
[2020-12-24 10:15:25.788] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:15:25.798] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:15:25.812] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:15:25.821] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:15:25.854] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:15:25.864] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:15:25.906] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:15:25.939] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:15:25.973] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:15:26.016] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:15:26.060] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:15:26.082] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:15:26.092] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:15:26.107] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:15:26.116] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:15:26.125] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:15:26.166] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:15:26.213] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:15:26.213] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ polycubectl transparenthelloworld add th1 loglevel=TRACE
[2020-12-24 10:15:28.108] [Transparenthelloworld] [th1] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add th2 loglevel=TRACE
[2020-12-24 10:15:28.530] [Transparenthelloworld] [th2] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add th3 loglevel=TRACE
[2020-12-24 10:15:28.937] [Transparenthelloworld] [th3] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add th4 loglevel=TRACE
[2020-12-24 10:15:29.344] [Transparenthelloworld] [th4] [info] Creating Transparenthelloworld instance
+ polycubectl transparenthelloworld add th5 loglevel=TRACE
[2020-12-24 10:15:29.751] [Transparenthelloworld] [th5] [info] Creating Transparenthelloworld instance
+ polycubectl attach th3 veth1
[2020-12-24 10:15:30.192] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 10:15:30.604] [Transparenthelloworld] [th3] [info] attached
[2020-12-24 10:15:30.604] [Transparenthelloworld] [th3] [info] parent peer is: veth1
+ polycubectl attach th1 veth1 position=first
[2020-12-24 10:15:31.603] [Transparenthelloworld] [th1] [info] attached
[2020-12-24 10:15:31.603] [Transparenthelloworld] [th1] [info] parent peer is: veth1
+ polycubectl attach th5 veth1 position=last
[2020-12-24 10:15:32.609] [Transparenthelloworld] [th5] [info] attached
[2020-12-24 10:15:32.609] [Transparenthelloworld] [th5] [info] parent peer is: veth1
+ polycubectl attach th2 veth1 after=th1
[2020-12-24 10:15:33.424] [Transparenthelloworld] [th5] [debug] [EGRESS] passing packet
[2020-12-24 10:15:33.424] [Transparenthelloworld] [th3] [debug] [EGRESS] passing packet
[2020-12-24 10:15:33.424] [Transparenthelloworld] [th1] [debug] [EGRESS] passing packet
[2020-12-24 10:15:33.802] [Transparenthelloworld] [th2] [info] attached
[2020-12-24 10:15:33.802] [Transparenthelloworld] [th2] [info] parent peer is: veth1
+ polycubectl attach th4 veth1 before=th5
[2020-12-24 10:15:33.936] [Transparenthelloworld] [th1] [debug] [INGRESS] passing packet
[2020-12-24 10:15:33.936] [Transparenthelloworld] [th2] [debug] [INGRESS] passing packet
[2020-12-24 10:15:33.936] [Transparenthelloworld] [th3] [debug] [INGRESS] passing packet
[2020-12-24 10:15:33.936] [Transparenthelloworld] [th5] [debug] [INGRESS] passing packet
[2020-12-24 10:15:34.972] [Transparenthelloworld] [th4] [info] attached
[2020-12-24 10:15:34.972] [Transparenthelloworld] [th4] [info] parent peer is: veth1
+ polycubectl topology show veth1
+ egrep 'ingress service chain: th1 ---&gt; th2 ---&gt; th3 ---&gt; th4 ---&gt; th5 ---&gt; stack'
ingress service chain: th1 ---&gt; th2 ---&gt; th3 ---&gt; th4 ---&gt; th5 ---&gt; stack
+ polycubectl topology show veth1
+ egrep 'egress service chain: th5 ---&gt; th4 ---&gt; th3 ---&gt; th2 ---&gt; th1 ---&gt; stack'
egress service chain: th5 ---&gt; th4 ---&gt; th3 ---&gt; th2 ---&gt; th1 ---&gt; stack
+ polycubectl del th1
+ polycubectl del th2
+ polycubectl del th3
+ polycubectl del th4
+ polycubectl del th5
+ delete_veth 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_set_peer_after_attach.sh" time="10.000000" status="Passed"><system-out>[2020-12-24 10:15:38.833] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:15:38.834] [polycubed] [info] configuration parameters: 
[2020-12-24 10:15:38.834] [polycubed] [info]  loglevel: info
[2020-12-24 10:15:38.834] [polycubed] [info]  daemon: false
[2020-12-24 10:15:38.834] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:15:38.834] [polycubed] [info]  port: 9000
[2020-12-24 10:15:38.834] [polycubed] [info]  addr: localhost
[2020-12-24 10:15:38.834] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:15:38.834] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:15:38.834] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:15:38.834] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:15:38.834] [polycubed] [info] polycubed starting...
[2020-12-24 10:15:38.834] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:15:41.010] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:15:41.010] [polycubed] [info] rest server starting ...
[2020-12-24 10:15:41.056] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:15:41.067] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:15:41.081] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:15:41.091] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:15:41.124] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:15:41.134] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:15:41.176] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:15:41.209] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:15:41.244] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:15:41.287] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:15:41.332] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:15:41.355] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:15:41.365] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:15:41.381] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:15:41.389] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:15:41.398] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:15:41.440] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:15:41.489] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:15:41.489] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:15:43.452] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1
[2020-12-24 10:15:43.460] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2
[2020-12-24 10:15:43.465] [Helloworld] [hw0] [info] port port2 was connected
+ polycubectl transparenthelloworld add hwT loglevel=TRACE
[2020-12-24 10:15:43.891] [Transparenthelloworld] [hwT] [info] Creating Transparenthelloworld instance
+ polycubectl attach hwT hw0:port1
[2020-12-24 10:15:44.471] [Transparenthelloworld] [hwT] [info] attached
[2020-12-24 10:15:44.472] [Transparenthelloworld] [hwT] [info] parent peer is: 
+ polycubectl hw0 ports port1 set peer=veth1
[2020-12-24 10:15:44.818] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:15:44.818] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:44.818] [Helloworld] [hw0] [debug] Forwarding packet
+ polycubectl hw0 ports port2 set peer=veth2
[2020-12-24 10:15:45.456] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:45.488] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:45.488] [Helloworld] [hw0] [debug] Forwarding packet
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:15:46.037] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.113 ms
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1

[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] Forwarding packet
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.113/0.113/0.113/0.000 ms
[2020-12-24 10:15:46.037] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:46.037] [Transparenthelloworld] [hwT] [debug] [INGRESS] passing packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:46.037] [Transparenthelloworld] [hwT] [debug] [EGRESS] passing packet
[2020-12-24 10:15:46.037] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:15:46.043] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ polycubectl del hwT
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./transparent_services/test_standard_helloworld.sh" time="7.000000" status="Passed"><system-out>[2020-12-24 10:15:48.562] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:15:48.562] [polycubed] [info] configuration parameters: 
[2020-12-24 10:15:48.562] [polycubed] [info]  loglevel: info
[2020-12-24 10:15:48.562] [polycubed] [info]  daemon: false
[2020-12-24 10:15:48.562] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:15:48.562] [polycubed] [info]  port: 9000
[2020-12-24 10:15:48.562] [polycubed] [info]  addr: localhost
[2020-12-24 10:15:48.562] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:15:48.562] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:15:48.562] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:15:48.562] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:15:48.562] [polycubed] [info] polycubed starting...
[2020-12-24 10:15:48.562] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:15:50.739] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:15:50.739] [polycubed] [info] rest server starting ...
[2020-12-24 10:15:50.784] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:15:50.794] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:15:50.809] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:15:50.819] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:15:50.851] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:15:50.861] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:15:50.903] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:15:50.936] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:15:50.971] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:15:51.014] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:15:51.058] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:15:51.081] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:15:51.092] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:15:51.107] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:15:51.115] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:15:51.124] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:15:51.165] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:15:51.213] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:15:51.213] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw0 action=FORWARD loglevel=TRACE
[2020-12-24 10:15:53.124] [Helloworld] [hw0] [info] Creating Helloworld instance
+ polycubectl hw0 ports add port1 peer=veth1
[2020-12-24 10:15:53.616] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:53.688] [Helloworld] [hw0] [info] port port1 was connected
+ polycubectl hw0 ports add port2 peer=veth2
[2020-12-24 10:15:54.130] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:54.130] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
[2020-12-24 10:15:54.160] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:54.160] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:54.192] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:54.192] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:54.396] [Helloworld] [hw0] [info] port port2 was connected
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] Forwarding packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.109 ms
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0

[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 0
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.109/0.109/0.109/0.000 ms
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 1
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [INGRESS] Receiving packet from port 1
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] Forwarding packet
[2020-12-24 10:15:54.405] [Helloworld] [hw0] [debug] [EGRESS] Packet ongoing on port 0
+ polycubectl del hw0
[2020-12-24 10:15:54.411] [Helloworld] [hw0] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/test106.sh" time="11.000000" status="Passed"><system-out>[2020-12-24 10:15:55.583] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:15:55.584] [polycubed] [info] configuration parameters: 
[2020-12-24 10:15:55.584] [polycubed] [info]  loglevel: info
[2020-12-24 10:15:55.584] [polycubed] [info]  daemon: false
[2020-12-24 10:15:55.584] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:15:55.584] [polycubed] [info]  port: 9000
[2020-12-24 10:15:55.584] [polycubed] [info]  addr: localhost
[2020-12-24 10:15:55.584] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:15:55.584] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:15:55.584] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:15:55.584] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:15:55.584] [polycubed] [info] polycubed starting...
[2020-12-24 10:15:55.584] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:15:57.767] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:15:57.768] [polycubed] [info] rest server starting ...
[2020-12-24 10:15:57.813] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:15:57.824] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:15:57.838] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:15:57.849] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:15:57.882] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:15:57.893] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:15:57.936] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:15:57.970] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:15:58.006] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:15:58.051] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:15:58.097] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:15:58.120] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:15:58.132] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:15:58.148] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:15:58.157] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:15:58.167] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:15:58.211] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:15:58.260] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:15:58.260] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ add_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n '' ']'
+ polycubectl bridge add br1
[2020-12-24 10:16:00.592] [Bridge] [br1] [info] Creating Bridge instance
+ bridge_add_port br1 link11
+ polycubectl br1 ports add link11
[2020-12-24 10:16:00.600] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports link11 set peer=link11
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:01.527] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:02.389] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:02.389] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:16:02.389] [polycubed] [warning] Error processing packet in event: map::at
+ delete_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link del link11
+ create_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ add_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n '' ']'
+ polycubectl bridge add br1
[2020-12-24 10:16:03.353] [Bridge] [br1] [info] Creating Bridge instance
+ bridge_add_port br1 link11
+ polycubectl br1 ports add link11
[2020-12-24 10:16:03.360] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports link11 set peer=link11
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:04.289] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:05.145] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:05.145] [polycubed] [warning] Error processing packet in event: map::at
+ delete_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link del link11
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/test107.sh" time="10.000000" status="Passed"><system-out>[2020-12-24 10:16:06.228] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:16:06.229] [polycubed] [info] configuration parameters: 
[2020-12-24 10:16:06.229] [polycubed] [info]  loglevel: info
[2020-12-24 10:16:06.229] [polycubed] [info]  daemon: false
[2020-12-24 10:16:06.229] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:16:06.229] [polycubed] [info]  port: 9000
[2020-12-24 10:16:06.229] [polycubed] [info]  addr: localhost
[2020-12-24 10:16:06.229] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:16:06.229] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:16:06.229] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:16:06.229] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:16:06.229] [polycubed] [info] polycubed starting...
[2020-12-24 10:16:06.229] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:16:08.420] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:16:08.421] [polycubed] [info] rest server starting ...
[2020-12-24 10:16:08.464] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:16:08.475] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:16:08.489] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:16:08.499] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:16:08.531] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:16:08.541] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:16:08.583] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:16:08.616] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:16:08.650] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:16:08.693] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:16:08.737] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:16:08.761] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:16:08.772] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:16:08.788] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:16:08.797] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:16:08.805] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:16:08.847] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:16:08.894] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:16:08.895] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_link 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ for i in `seq 1 $1`
+ sudo ip link add link21 type veth peer name link22
+ sudo ip link set dev link21 up
+ sudo ip link set dev link22 up
+ add_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n '' ']'
+ polycubectl bridge add br1
[2020-12-24 10:16:11.292] [Bridge] [br1] [info] Creating Bridge instance
+ bridge_add_port br1 link11
+ polycubectl br1 ports add link11
[2020-12-24 10:16:11.299] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports link11 set peer=link11
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:12.222] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:13.077] [Bridge] [br1] [info] Destroying Ports instance
+ delete_link 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del link11
+ for i in `seq 1 $1`
+ sudo ip link del link21
+ create_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ add_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n '' ']'
+ polycubectl bridge add br1
[2020-12-24 10:16:14.086] [Bridge] [br1] [info] Creating Bridge instance
+ test_fail bridge_add_port br1 link22
+ set +e
++ bridge_add_port br1 link22
++ polycubectl br1 ports add link22
[2020-12-24 10:16:14.094] [Bridge] [br1] [info] Creating Ports instance
++ polycubectl br1 ports link22 set peer=link22
+ res='Interface  link22 does not exist or is down'
+ local status=2
+ set -e
+ '[' 2 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:14.106] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:15.087] [Bridge] [br1] [info] Destroying Ports instance
+ delete_link 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del link11
+ for i in `seq 1 $1`
+ sudo ip link del link21
Cannot find device "link21"
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/connectivity/test1.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 10:16:16.187] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:16:16.188] [polycubed] [info] configuration parameters: 
[2020-12-24 10:16:16.188] [polycubed] [info]  loglevel: info
[2020-12-24 10:16:16.188] [polycubed] [info]  daemon: false
[2020-12-24 10:16:16.188] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:16:16.188] [polycubed] [info]  port: 9000
[2020-12-24 10:16:16.188] [polycubed] [info]  addr: localhost
[2020-12-24 10:16:16.188] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:16:16.188] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:16:16.188] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:16:16.188] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:16:16.188] [polycubed] [info] polycubed starting...
[2020-12-24 10:16:16.188] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:16:18.360] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:16:18.360] [polycubed] [info] rest server starting ...
[2020-12-24 10:16:18.404] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:16:18.414] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:16:18.428] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:16:18.438] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:16:18.471] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:16:18.480] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:16:18.522] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:16:18.555] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:16:18.589] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:16:18.632] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:16:18.676] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:16:18.698] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:16:18.708] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:16:18.723] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:16:18.732] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:16:18.741] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:16:18.783] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:16:18.830] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:16:18.830] [polycubed] [info] loading metrics from yang files
+ create_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ set -e
+ add_bridges 1 TC
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br1 type=TC
[2020-12-24 10:16:21.433] [Bridge] [br1] [info] Creating Bridge instance
++ seq 1 4
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth1
+ polycubectl br1 ports add veth1
[2020-12-24 10:16:21.441] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth2
+ polycubectl br1 ports add veth2
[2020-12-24 10:16:22.357] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth3
+ polycubectl br1 ports add veth3
[2020-12-24 10:16:23.389] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth4
+ polycubectl br1 ports add veth4
[2020-12-24 10:16:24.429] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth4 set peer=veth4
+ ping_cycle 4
++ seq 1 4
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.176 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 509ms
rtt min/avg/max/mdev = 0.056/0.116/0.176/0.060 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.290 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.053/0.171/0.290/0.119 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.190 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.058 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.058/0.124/0.190/0.066 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.024/0.039/0.054/0.015 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.181 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.053/0.117/0.181/0.064 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.196 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.057 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.057/0.126/0.196/0.070 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.026 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.026/0.040/0.054/0.014 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.024/0.039/0.055/0.016 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.200 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.055/0.127/0.200/0.073 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.023 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.073 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.023/0.048/0.073/0.025 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.029 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.078 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.029/0.053/0.078/0.025 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.027 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.052 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.027/0.039/0.052/0.014 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:31.736] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:35.573] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:35.573] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:35.573] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:35.573] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:35.573] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:16:35.573] [polycubed] [warning] Error processing packet in event: bad_function_call
[2020-12-24 10:16:35.573] [polycubed] [warning] Error processing packet in event: bad_function_call
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/connectivity/test1_xdp.sh" time="21.000000" status="Passed"><system-out>[2020-12-24 10:16:36.765] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:16:36.766] [polycubed] [info] configuration parameters: 
[2020-12-24 10:16:36.766] [polycubed] [info]  loglevel: info
[2020-12-24 10:16:36.766] [polycubed] [info]  daemon: false
[2020-12-24 10:16:36.766] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:16:36.766] [polycubed] [info]  port: 9000
[2020-12-24 10:16:36.766] [polycubed] [info]  addr: localhost
[2020-12-24 10:16:36.766] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:16:36.766] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:16:36.766] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:16:36.766] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:16:36.766] [polycubed] [info] polycubed starting...
[2020-12-24 10:16:36.766] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:16:38.956] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:16:38.956] [polycubed] [info] rest server starting ...
[2020-12-24 10:16:39.000] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:16:39.011] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:16:39.025] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:16:39.035] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:16:39.067] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:16:39.077] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:16:39.119] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:16:39.151] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:16:39.185] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:16:39.228] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:16:39.272] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:16:39.294] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:16:39.305] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:16:39.320] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:16:39.329] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:16:39.338] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:16:39.379] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:16:39.426] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:16:39.426] [polycubed] [info] loading metrics from yang files
+ create_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ set -e
+ add_bridges 1 XDP_SKB
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n XDP_SKB ']'
+ polycubectl bridge add br1 type=XDP_SKB
[2020-12-24 10:16:42.030] [Bridge] [br1] [info] Creating Bridge instance
++ seq 1 4
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth1
+ polycubectl br1 ports add veth1
[2020-12-24 10:16:42.038] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth1 set peer=veth1
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth2
+ polycubectl br1 ports add veth2
[2020-12-24 10:16:42.974] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth2 set peer=veth2
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth3
+ polycubectl br1 ports add veth3
[2020-12-24 10:16:44.044] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth3 set peer=veth3
+ for i in `seq 1 $N`
+ bridge_add_port br1 veth4
+ polycubectl br1 ports add veth4
[2020-12-24 10:16:45.133] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth4 set peer=veth4
+ ping_cycle 4
++ seq 1 4
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.191 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.059 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 528ms
rtt min/avg/max/mdev = 0.059/0.125/0.191/0.066 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.249 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.057 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.057/0.153/0.249/0.096 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.183 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.055/0.119/0.183/0.064 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.051 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.024/0.037/0.051/0.014 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.265 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.053/0.159/0.265/0.106 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.270 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.053/0.161/0.270/0.109 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.023 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.023/0.038/0.054/0.016 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.027 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.040/0.054/0.014 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.270 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.053/0.161/0.270/0.109 ms
+ for i in `seq 1 $1`
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.032 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.051 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.032/0.041/0.051/0.011 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.050 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.024/0.037/0.050/0.013 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.021 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.052 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.021/0.036/0.052/0.016 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:16:52.440] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:16:56.208] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:56.208] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:56.208] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:56.208] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:16:56.208] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:16:56.208] [polycubed] [warning] Error processing packet in event: bad_function_call
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/vlan/test1.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:16:57.411] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:16:57.412] [polycubed] [info] configuration parameters: 
[2020-12-24 10:16:57.412] [polycubed] [info]  loglevel: info
[2020-12-24 10:16:57.412] [polycubed] [info]  daemon: false
[2020-12-24 10:16:57.412] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:16:57.412] [polycubed] [info]  port: 9000
[2020-12-24 10:16:57.412] [polycubed] [info]  addr: localhost
[2020-12-24 10:16:57.412] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:16:57.412] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:16:57.412] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:16:57.412] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:16:57.412] [polycubed] [info] polycubed starting...
[2020-12-24 10:16:57.412] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:16:59.598] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:16:59.599] [polycubed] [info] rest server starting ...
[2020-12-24 10:16:59.644] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:16:59.655] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:16:59.669] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:16:59.679] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:16:59.711] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:16:59.721] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:16:59.764] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:16:59.796] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:16:59.831] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:16:59.875] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:16:59.919] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:16:59.942] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:16:59.953] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:16:59.968] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:16:59.977] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:16:59.985] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:17:00.027] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:17:00.075] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:17:00.075] [polycubed] [info] loading metrics from yang files
+ create_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ set -e
+ add_bridges 1 TC
++ seq 1 1
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br1 type=TC
[2020-12-24 10:17:02.672] [Bridge] [br1] [info] Creating Bridge instance
+ bridge_add_port br1 veth1
+ polycubectl br1 ports add veth1
[2020-12-24 10:17:02.679] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl br1 ports add veth2
[2020-12-24 10:17:03.602] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth2 set peer=veth2
+ bridge_add_port br1 veth3
+ polycubectl br1 ports add veth3
[2020-12-24 10:17:04.644] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth3 set peer=veth3
+ bridge_add_port br1 veth4
+ polycubectl br1 ports add veth4
[2020-12-24 10:17:05.688] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth4 set peer=veth4
+ polycubectl br1 ports veth1 access set vlanid=10
+ polycubectl br1 ports veth2 access set vlanid=10
+ polycubectl br1 ports veth3 access set vlanid=20
+ polycubectl br1 ports veth4 access set vlanid=20
+ echo 'should pass'
should pass
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.223 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.060 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 518ms
rtt min/avg/max/mdev = 0.060/0.141/0.223/0.082 ms
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.025 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.060 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.025/0.042/0.060/0.018 ms
+ sudo ip netns exec ns3 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.280 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.053/0.166/0.280/0.114 ms
+ sudo ip netns exec ns4 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.027 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.040/0.054/0.014 ms
+ echo '+++should fail'
+++should fail
+ test_fail sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 503ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 518ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 501ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 513ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns3 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns3 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 527ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 511ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 526ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 509ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_bridges 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:17:16.963] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:17:20.837] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:20.837] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:20.837] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:20.837] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:20.837] [polycubed] [warning] Error processing packet in event: map::at
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/vlan/test2.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:17:22.093] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:17:22.094] [polycubed] [info] configuration parameters: 
[2020-12-24 10:17:22.094] [polycubed] [info]  loglevel: info
[2020-12-24 10:17:22.094] [polycubed] [info]  daemon: false
[2020-12-24 10:17:22.094] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:17:22.094] [polycubed] [info]  port: 9000
[2020-12-24 10:17:22.094] [polycubed] [info]  addr: localhost
[2020-12-24 10:17:22.094] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:17:22.094] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:17:22.094] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:17:22.094] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:17:22.094] [polycubed] [info] polycubed starting...
[2020-12-24 10:17:22.094] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:17:24.262] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:17:24.263] [polycubed] [info] rest server starting ...
[2020-12-24 10:17:24.304] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:17:24.314] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:17:24.328] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:17:24.337] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:17:24.369] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:17:24.378] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:17:24.419] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:17:24.451] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:17:24.484] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:17:24.525] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:17:24.568] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:17:24.590] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:17:24.600] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:17:24.615] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:17:24.623] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:17:24.632] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:17:24.673] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:17:24.719] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:17:24.719] [polycubed] [info] loading metrics from yang files
+ create_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ create_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ set -e
+ add_bridges 2 TC
++ seq 1 2
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br1 type=TC
[2020-12-24 10:17:27.399] [Bridge] [br1] [info] Creating Bridge instance
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br2 type=TC
[2020-12-24 10:17:28.317] [Bridge] [br2] [info] Creating Bridge instance
+ bridge_add_port br1 veth1
+ polycubectl br1 ports add veth1
[2020-12-24 10:17:28.325] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl br1 ports add veth2
[2020-12-24 10:17:29.252] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth2 set peer=veth2
+ bridge_add_port br1 link11
+ polycubectl br1 ports add link11
[2020-12-24 10:17:30.293] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports link11 set peer=link11
+ bridge_add_port br2 veth3
+ polycubectl br2 ports add veth3
[2020-12-24 10:17:31.334] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth3 set peer=veth3
+ bridge_add_port br2 veth4
+ polycubectl br2 ports add veth4
[2020-12-24 10:17:32.258] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth4 set peer=veth4
+ bridge_add_port br2 link12
+ polycubectl br2 ports add link12
[2020-12-24 10:17:33.310] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports link12 set peer=link12
+ polycubectl br1 ports veth1 access set vlanid=10
+ polycubectl br1 ports veth2 access set vlanid=20
+ polycubectl br2 ports veth3 access set vlanid=10
+ polycubectl br2 ports veth4 access set vlanid=20
+ polycubectl br1 ports link11 set mode=trunk
+ polycubectl br2 ports link12 set mode=trunk
+ polycubectl br1 ports link11 trunk allowed add 10
+ polycubectl br1 ports link11 trunk allowed add 20
+ polycubectl br2 ports link12 trunk allowed add 10
+ polycubectl br2 ports link12 trunk allowed add 20
+ echo 'should pass'
should pass
+ sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.301 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.064 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 513ms
rtt min/avg/max/mdev = 0.064/0.182/0.301/0.119 ms
+ sudo ip netns exec ns3 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.027 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.069 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.048/0.069/0.021 ms
+ sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.242 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.066 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.066/0.154/0.242/0.088 ms
+ sudo ip netns exec ns4 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.034 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.066 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.034/0.050/0.066/0.016 ms
+ echo '+++should fail'
+++should fail
+ test_fail sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 531ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 514ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 529ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 512ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:17:40.512] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:17:43.769] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:43.769] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:43.769] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:17:43.769] [polycubed] [warning] Error processing packet in event: map::at
+ for i in `seq 1 $1`
+ polycubectl br2 del
[2020-12-24 10:17:43.775] [Bridge] [br2] [info] Destroying Bridge instance
[2020-12-24 10:17:46.713] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:17:46.713] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:17:46.713] [Bridge] [br2] [info] Destroying Ports instance
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ delete_link 1
++ seq 1 1
+ for i in `seq 1 $1`
+ sudo ip link del link11
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/vlan/test3.sh" time="74.000000" status="Passed"><system-out>[2020-12-24 10:17:48.012] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:17:48.013] [polycubed] [info] configuration parameters: 
[2020-12-24 10:17:48.013] [polycubed] [info]  loglevel: info
[2020-12-24 10:17:48.013] [polycubed] [info]  daemon: false
[2020-12-24 10:17:48.013] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:17:48.013] [polycubed] [info]  port: 9000
[2020-12-24 10:17:48.013] [polycubed] [info]  addr: localhost
[2020-12-24 10:17:48.013] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:17:48.013] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:17:48.013] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:17:48.013] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:17:48.013] [polycubed] [info] polycubed starting...
[2020-12-24 10:17:48.013] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:17:50.205] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:17:50.206] [polycubed] [info] rest server starting ...
[2020-12-24 10:17:50.253] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:17:50.264] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:17:50.278] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:17:50.287] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:17:50.320] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:17:50.330] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:17:50.372] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:17:50.405] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:17:50.440] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:17:50.483] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:17:50.527] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:17:50.550] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:17:50.561] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:17:50.576] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:17:50.585] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:17:50.594] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:17:50.636] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:17:50.685] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:17:50.685] [polycubed] [info] loading metrics from yang files
+ create_veth 13
++ seq 1 13
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.0.5/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns6
+ sudo ip link add veth6_ type veth peer name veth6
+ sudo ip link set veth6_ netns ns6
+ sudo ip netns exec ns6 ip link set dev veth6_ up
+ sudo ip link set dev veth6 up
+ sudo ip netns exec ns6 ifconfig veth6_ 10.0.0.6/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns7
+ sudo ip link add veth7_ type veth peer name veth7
+ sudo ip link set veth7_ netns ns7
+ sudo ip netns exec ns7 ip link set dev veth7_ up
+ sudo ip link set dev veth7 up
+ sudo ip netns exec ns7 ifconfig veth7_ 10.0.0.7/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns8
+ sudo ip link add veth8_ type veth peer name veth8
+ sudo ip link set veth8_ netns ns8
+ sudo ip netns exec ns8 ip link set dev veth8_ up
+ sudo ip link set dev veth8 up
+ sudo ip netns exec ns8 ifconfig veth8_ 10.0.0.8/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns9
+ sudo ip link add veth9_ type veth peer name veth9
+ sudo ip link set veth9_ netns ns9
+ sudo ip netns exec ns9 ip link set dev veth9_ up
+ sudo ip link set dev veth9 up
+ sudo ip netns exec ns9 ifconfig veth9_ 10.0.0.9/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns10
+ sudo ip link add veth10_ type veth peer name veth10
+ sudo ip link set veth10_ netns ns10
+ sudo ip netns exec ns10 ip link set dev veth10_ up
+ sudo ip link set dev veth10 up
+ sudo ip netns exec ns10 ifconfig veth10_ 10.0.0.10/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns11
+ sudo ip link add veth11_ type veth peer name veth11
+ sudo ip link set veth11_ netns ns11
+ sudo ip netns exec ns11 ip link set dev veth11_ up
+ sudo ip link set dev veth11 up
+ sudo ip netns exec ns11 ifconfig veth11_ 10.0.0.11/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns12
+ sudo ip link add veth12_ type veth peer name veth12
+ sudo ip link set veth12_ netns ns12
+ sudo ip netns exec ns12 ip link set dev veth12_ up
+ sudo ip link set dev veth12 up
+ sudo ip netns exec ns12 ifconfig veth12_ 10.0.0.12/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns13
+ sudo ip link add veth13_ type veth peer name veth13
+ sudo ip link set veth13_ netns ns13
+ sudo ip netns exec ns13 ip link set dev veth13_ up
+ sudo ip link set dev veth13 up
+ sudo ip netns exec ns13 ifconfig veth13_ 10.0.0.13/24
+ create_link 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link add link11 type veth peer name link12
+ sudo ip link set dev link11 up
+ sudo ip link set dev link12 up
+ for i in `seq 1 $1`
+ sudo ip link add link21 type veth peer name link22
+ sudo ip link set dev link21 up
+ sudo ip link set dev link22 up
+ set -e
+ add_bridges 3 TC
++ seq 1 3
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br1 type=TC
[2020-12-24 10:17:53.970] [Bridge] [br1] [info] Creating Bridge instance
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br2 type=TC
[2020-12-24 10:17:54.877] [Bridge] [br2] [info] Creating Bridge instance
+ for i in `seq 1 $1`
+ '[' -n TC ']'
+ polycubectl bridge add br3 type=TC
[2020-12-24 10:17:55.766] [Bridge] [br3] [info] Creating Bridge instance
+ bridge_add_port br1 veth1
+ polycubectl br1 ports add veth1
[2020-12-24 10:17:55.774] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl br1 ports add veth2
[2020-12-24 10:17:56.698] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth2 set peer=veth2
+ bridge_add_port br1 veth3
+ polycubectl br1 ports add veth3
[2020-12-24 10:17:57.755] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth3 set peer=veth3
+ bridge_add_port br1 veth4
+ polycubectl br1 ports add veth4
[2020-12-24 10:17:58.815] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports veth4 set peer=veth4
+ bridge_add_port br1 link11
+ polycubectl br1 ports add link11
[2020-12-24 10:17:59.879] [Bridge] [br1] [info] Creating Ports instance
+ polycubectl br1 ports link11 set peer=link11
+ bridge_add_port br2 veth5
+ polycubectl br2 ports add veth5
[2020-12-24 10:18:00.938] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth5 set peer=veth5
+ bridge_add_port br2 veth6
+ polycubectl br2 ports add veth6
[2020-12-24 10:18:01.861] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth6 set peer=veth6
+ bridge_add_port br2 veth7
+ polycubectl br2 ports add veth7
[2020-12-24 10:18:02.921] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth7 set peer=veth7
+ bridge_add_port br2 veth8
+ polycubectl br2 ports add veth8
[2020-12-24 10:18:03.984] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth8 set peer=veth8
+ bridge_add_port br2 veth9
+ polycubectl br2 ports add veth9
[2020-12-24 10:18:05.038] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports veth9 set peer=veth9
+ bridge_add_port br2 link12
+ polycubectl br2 ports add link12
[2020-12-24 10:18:06.099] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports link12 set peer=link12
+ bridge_add_port br2 link21
+ polycubectl br2 ports add link21
[2020-12-24 10:18:07.165] [Bridge] [br2] [info] Creating Ports instance
+ polycubectl br2 ports link21 set peer=link21
+ bridge_add_port br3 veth10
+ polycubectl br3 ports add veth10
[2020-12-24 10:18:08.224] [Bridge] [br3] [info] Creating Ports instance
+ polycubectl br3 ports veth10 set peer=veth10
+ bridge_add_port br3 veth11
+ polycubectl br3 ports add veth11
[2020-12-24 10:18:09.166] [Bridge] [br3] [info] Creating Ports instance
+ polycubectl br3 ports veth11 set peer=veth11
+ bridge_add_port br3 veth12
+ polycubectl br3 ports add veth12
[2020-12-24 10:18:10.232] [Bridge] [br3] [info] Creating Ports instance
+ polycubectl br3 ports veth12 set peer=veth12
+ bridge_add_port br3 veth13
+ polycubectl br3 ports add veth13
[2020-12-24 10:18:11.303] [Bridge] [br3] [info] Creating Ports instance
+ polycubectl br3 ports veth13 set peer=veth13
+ bridge_add_port br3 link22
+ polycubectl br3 ports add link22
[2020-12-24 10:18:12.377] [Bridge] [br3] [info] Creating Ports instance
+ polycubectl br3 ports link22 set peer=link22
+ polycubectl br1 ports veth1 access set vlanid=10
+ polycubectl br1 ports veth2 access set vlanid=20
+ polycubectl br1 ports veth3 access set vlanid=20
+ polycubectl br1 ports veth4 access set vlanid=30
+ polycubectl br2 ports veth5 access set vlanid=10
+ polycubectl br2 ports veth6 access set vlanid=30
+ polycubectl br2 ports veth7 access set vlanid=40
+ polycubectl br2 ports veth8 access set vlanid=50
+ polycubectl br2 ports veth9 access set vlanid=50
+ polycubectl br3 ports veth10 access set vlanid=10
+ polycubectl br3 ports veth11 access set vlanid=40
+ polycubectl br3 ports veth12 access set vlanid=60
+ polycubectl br3 ports veth13 access set vlanid=60
+ polycubectl br1 ports link11 set mode=trunk
+ polycubectl br2 ports link12 set mode=trunk
+ polycubectl br2 ports link21 set mode=trunk
+ polycubectl br3 ports link22 set mode=trunk
+ polycubectl br1 ports link11 trunk allowed add 10
+ polycubectl br1 ports link11 trunk allowed add 30
+ polycubectl br2 ports link12 trunk allowed add 10
+ polycubectl br2 ports link12 trunk allowed add 30
+ polycubectl br2 ports link21 trunk allowed add 10
+ polycubectl br2 ports link21 trunk allowed add 40
+ polycubectl br3 ports link22 trunk allowed add 10
+ polycubectl br3 ports link22 trunk allowed add 40
+ echo ''

+ echo '++should pass++'
++should pass++
+ echo '++local bridge vlans++'
++local bridge vlans++
+ sudo ip netns exec ns2 ping 10.0.0.3 -c 2 -i 0.5
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.267 ms
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 517ms
rtt min/avg/max/mdev = 0.055/0.161/0.267/0.106 ms
+ sudo ip netns exec ns3 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.026 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.026/0.040/0.054/0.014 ms
+ sudo ip netns exec ns8 ping 10.0.0.9 -c 2 -i 0.5
PING 10.0.0.9 (10.0.0.9) 56(84) bytes of data.
64 bytes from 10.0.0.9: icmp_seq=1 ttl=64 time=0.262 ms
64 bytes from 10.0.0.9: icmp_seq=2 ttl=64 time=0.059 ms

--- 10.0.0.9 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.059/0.160/0.262/0.102 ms
+ sudo ip netns exec ns9 ping 10.0.0.8 -c 2 -i 0.5
PING 10.0.0.8 (10.0.0.8) 56(84) bytes of data.
64 bytes from 10.0.0.8: icmp_seq=1 ttl=64 time=0.023 ms
64 bytes from 10.0.0.8: icmp_seq=2 ttl=64 time=0.058 ms

--- 10.0.0.8 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.023/0.040/0.058/0.018 ms
+ sudo ip netns exec ns12 ping 10.0.0.13 -c 2 -i 0.5
PING 10.0.0.13 (10.0.0.13) 56(84) bytes of data.
64 bytes from 10.0.0.13: icmp_seq=1 ttl=64 time=0.188 ms
64 bytes from 10.0.0.13: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.0.13 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.056/0.122/0.188/0.066 ms
+ sudo ip netns exec ns13 ping 10.0.0.12 -c 2 -i 0.5
PING 10.0.0.12 (10.0.0.12) 56(84) bytes of data.
64 bytes from 10.0.0.12: icmp_seq=1 ttl=64 time=0.029 ms
64 bytes from 10.0.0.12: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.12 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.029/0.041/0.053/0.012 ms
+ echo ''

+ echo '++should pass++'
++should pass++
+ echo '++vlan10 over all switches++'
++vlan10 over all switches++
+ sudo ip netns exec ns1 ping 10.0.0.5 -c 2 -i 0.5
PING 10.0.0.5 (10.0.0.5) 56(84) bytes of data.
64 bytes from 10.0.0.5: icmp_seq=1 ttl=64 time=0.389 ms
64 bytes from 10.0.0.5: icmp_seq=2 ttl=64 time=0.071 ms

--- 10.0.0.5 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.071/0.230/0.389/0.159 ms
+ sudo ip netns exec ns1 ping 10.0.0.10 -c 2 -i 0.5
PING 10.0.0.10 (10.0.0.10) 56(84) bytes of data.
64 bytes from 10.0.0.10: icmp_seq=1 ttl=64 time=0.302 ms
64 bytes from 10.0.0.10: icmp_seq=2 ttl=64 time=0.080 ms

--- 10.0.0.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.080/0.191/0.302/0.111 ms
+ sudo ip netns exec ns5 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.033 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.065 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.033/0.049/0.065/0.016 ms
+ sudo ip netns exec ns5 ping 10.0.0.10 -c 2 -i 0.5
PING 10.0.0.10 (10.0.0.10) 56(84) bytes of data.
64 bytes from 10.0.0.10: icmp_seq=1 ttl=64 time=0.300 ms
64 bytes from 10.0.0.10: icmp_seq=2 ttl=64 time=0.063 ms

--- 10.0.0.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.063/0.181/0.300/0.119 ms
+ sudo ip netns exec ns10 ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.047 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.077 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.047/0.062/0.077/0.015 ms
+ sudo ip netns exec ns10 ping 10.0.0.5 -c 2 -i 0.5
PING 10.0.0.5 (10.0.0.5) 56(84) bytes of data.
64 bytes from 10.0.0.5: icmp_seq=1 ttl=64 time=0.037 ms
64 bytes from 10.0.0.5: icmp_seq=2 ttl=64 time=0.065 ms

--- 10.0.0.5 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.037/0.051/0.065/0.014 ms
+ echo ''

+ echo '++should pass++'
++should pass++
+ echo '++over 2 bridges++'
++over 2 bridges++
+ sudo ip netns exec ns4 ping 10.0.0.6 -c 2 -i 0.5
PING 10.0.0.6 (10.0.0.6) 56(84) bytes of data.
64 bytes from 10.0.0.6: icmp_seq=1 ttl=64 time=0.328 ms
64 bytes from 10.0.0.6: icmp_seq=2 ttl=64 time=0.073 ms

--- 10.0.0.6 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.073/0.200/0.328/0.128 ms
+ sudo ip netns exec ns6 ping 10.0.0.4 -c 2 -i 0.5
PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.
64 bytes from 10.0.0.4: icmp_seq=1 ttl=64 time=0.032 ms
64 bytes from 10.0.0.4: icmp_seq=2 ttl=64 time=0.069 ms

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.050/0.069/0.019 ms
+ sudo ip netns exec ns7 ping 10.0.0.11 -c 2 -i 0.5
PING 10.0.0.11 (10.0.0.11) 56(84) bytes of data.
64 bytes from 10.0.0.11: icmp_seq=1 ttl=64 time=0.267 ms
64 bytes from 10.0.0.11: icmp_seq=2 ttl=64 time=0.070 ms

--- 10.0.0.11 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.070/0.168/0.267/0.099 ms
+ sudo ip netns exec ns11 ping 10.0.0.7 -c 2 -i 0.5
PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=0.033 ms
64 bytes from 10.0.0.7: icmp_seq=2 ttl=64 time=0.065 ms

--- 10.0.0.7 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.033/0.049/0.065/0.016 ms
+ echo ''

+ echo '++should FAIL++'
++should FAIL++
+ echo '++should FAIL++'
++should FAIL++
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 502ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.3 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.

--- 10.0.0.3 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 517ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 529ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.6 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.6 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.6 (10.0.0.6) 56(84) bytes of data.

--- 10.0.0.6 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 512ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.7 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.7 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.

--- 10.0.0.7 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 527ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.8 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.8 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.8 (10.0.0.8) 56(84) bytes of data.

--- 10.0.0.8 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 510ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns1 ping 10.0.0.9 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.9 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.9 (10.0.0.9) 56(84) bytes of data.

--- 10.0.0.9 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 524ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.11 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.11 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.11 (10.0.0.11) 56(84) bytes of data.

--- 10.0.0.11 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 507ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.12 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.12 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.12 (10.0.0.12) 56(84) bytes of data.

--- 10.0.0.12 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 522ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns4 ping 10.0.0.13 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.0.0.13 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.13 (10.0.0.13) 56(84) bytes of data.

--- 10.0.0.13 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 505ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 520ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.4 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.4 (10.0.0.4) 56(84) bytes of data.

--- 10.0.0.4 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 503ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.5 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.5 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.5 (10.0.0.5) 56(84) bytes of data.

--- 10.0.0.5 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 514ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.6 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.6 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.6 (10.0.0.6) 56(84) bytes of data.

--- 10.0.0.6 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 529ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.7 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.7 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.

--- 10.0.0.7 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 512ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.8 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.8 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.8 (10.0.0.8) 56(84) bytes of data.

--- 10.0.0.8 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 527ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.9 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.9 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.9 (10.0.0.9) 56(84) bytes of data.

--- 10.0.0.9 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 511ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.10 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.10 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.10 (10.0.0.10) 56(84) bytes of data.

--- 10.0.0.10 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 526ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.11 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.11 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.11 (10.0.0.11) 56(84) bytes of data.

--- 10.0.0.11 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 508ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.12 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.12 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.12 (10.0.0.12) 56(84) bytes of data.

--- 10.0.0.12 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 523ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.13 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.13 -c 2 -i 0.5 -w 1
+ res='PING 10.0.0.13 (10.0.0.13) 56(84) bytes of data.

--- 10.0.0.13 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 506ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_bridges 3
++ seq 1 3
+ for i in `seq 1 $1`
+ polycubectl br1 del
[2020-12-24 10:18:43.079] [Bridge] [br1] [info] Destroying Bridge instance
[2020-12-24 10:18:47.985] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:18:47.985] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:18:47.985] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:18:47.985] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:18:47.985] [Bridge] [br1] [info] Destroying Ports instance
[2020-12-24 10:18:47.985] [polycubed] [warning] Error processing packet in event: map::at
+ for i in `seq 1 $1`
+ polycubectl br2 del
[2020-12-24 10:18:47.992] [Bridge] [br2] [info] Destroying Bridge instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
[2020-12-24 10:18:54.529] [Bridge] [br2] [info] Destroying Ports instance
+ for i in `seq 1 $1`
+ polycubectl br3 del
[2020-12-24 10:18:54.536] [Bridge] [br3] [info] Destroying Bridge instance
[2020-12-24 10:18:58.777] [Bridge] [br3] [info] Destroying Ports instance
[2020-12-24 10:18:58.777] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:18:58.777] [Bridge] [br3] [info] Destroying Ports instance
[2020-12-24 10:18:58.777] [Bridge] [br3] [info] Destroying Ports instance
[2020-12-24 10:18:58.777] [Bridge] [br3] [info] Destroying Ports instance
[2020-12-24 10:18:58.777] [Bridge] [br3] [info] Destroying Ports instance
+ delete_veth 13
++ seq 1 13
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
+ for i in `seq 1 $1`
+ sudo ip link del veth6
+ sudo ip netns del ns6
+ for i in `seq 1 $1`
+ sudo ip link del veth7
+ sudo ip netns del ns7
+ for i in `seq 1 $1`
+ sudo ip link del veth8
+ sudo ip netns del ns8
+ for i in `seq 1 $1`
+ sudo ip link del veth9
+ sudo ip netns del ns9
+ for i in `seq 1 $1`
+ sudo ip link del veth10
+ sudo ip netns del ns10
+ for i in `seq 1 $1`
+ sudo ip link del veth11
+ sudo ip netns del ns11
+ for i in `seq 1 $1`
+ sudo ip link del veth12
+ sudo ip netns del ns12
+ for i in `seq 1 $1`
+ sudo ip link del veth13
+ sudo ip netns del ns13
+ delete_link 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del link11
+ for i in `seq 1 $1`
+ sudo ip link del link21
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/vlan_and_stp/test1.sh" time="142.000000" status="Passed"><system-out>[2020-12-24 10:19:01.425] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:19:01.425] [polycubed] [info] configuration parameters: 
[2020-12-24 10:19:01.425] [polycubed] [info]  loglevel: info
[2020-12-24 10:19:01.425] [polycubed] [info]  daemon: false
[2020-12-24 10:19:01.425] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:19:01.425] [polycubed] [info]  port: 9000
[2020-12-24 10:19:01.425] [polycubed] [info]  addr: localhost
[2020-12-24 10:19:01.425] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:19:01.425] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:19:01.425] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:19:01.425] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:19:01.425] [polycubed] [info] polycubed starting...
[2020-12-24 10:19:01.425] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:19:03.604] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:19:03.605] [polycubed] [info] rest server starting ...
[2020-12-24 10:19:03.653] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:19:03.663] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:19:03.678] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:19:03.688] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:19:03.720] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:19:03.731] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:19:03.773] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:19:03.805] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:19:03.840] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:19:03.882] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:19:03.925] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:19:03.948] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:19:03.958] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:19:03.973] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:19:03.982] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:19:03.991] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:19:04.032] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:19:04.079] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:19:04.079] [polycubed] [info] loading metrics from yang files
setting up topology..
[2020-12-24 10:19:06.610] [Bridge] [b1] [info] Creating Bridge instance
[2020-12-24 10:19:07.525] [Bridge] [b2] [info] Creating Bridge instance
[2020-12-24 10:19:08.421] [Bridge] [b3] [info] Creating Bridge instance
[2020-12-24 10:19:09.346] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:19:09.346] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:19:09.354] [Bridge] [b1] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:19:09.847] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:19:09.854] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:19:09.854] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:19:09.865] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:19:09.870] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:19:10.512] [Bridge] [b2] [error] Port 0 not found
[2020-12-24 10:19:10.811] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:19:10.811] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:19:10.817] [Bridge] [b2] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:19:11.311] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:19:11.318] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:19:11.318] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:19:11.329] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:19:11.334] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:19:12.274] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:19:12.274] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:19:12.281] [Bridge] [b3] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:19:12.774] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:19:12.782] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:19:12.782] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:19:12.787] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:19:12.796] [Bridge] [b3] [info] Creating Ports instance
sleeping for convergence..
testing ports..
testing connectivity..
changing topology..
sleeping for convergence..
testing connectivity..
end.
cleaning up..
[2020-12-24 10:21:10.514] [Bridge] [b1] [info] Destroying Bridge instance
[2020-12-24 10:21:11.420] [polycubed] [warning] packetout: port b1:tob2 is down
[2020-12-24 10:21:11.420] [polycubed] [warning] packetout: port b1:tob2 is down
[2020-12-24 10:21:12.990] [polycubed] [warning] packetout: port b1:tob3 is down
[2020-12-24 10:21:12.990] [polycubed] [warning] packetout: port b1:tob3 is down
[2020-12-24 10:21:13.772] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:21:14.569] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:21:14.569] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:21:14.569] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:21:14.569] [Bridge] [b1] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:21:14.569] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:21:14.569] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:21:14.569] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:21:14.569] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:21:14.773] [Bridge] [b1] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:21:15.273] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:21:15.273] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:21:15.273] [Bridge] [b1] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:15.781] [Bridge] [b2] [info] Destroying Bridge instance
[2020-12-24 10:21:17.274] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:21:18.933] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:21:18.933] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:21:18.933] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:21:18.933] [Bridge] [b2] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:21:19.274] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:21:19.274] [polycubed] [warning] packetout: port b3:tob2 is down
[2020-12-24 10:21:19.275] [Bridge] [b2] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:19.775] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:21:19.775] [Bridge] [b2] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:21:20.282] [Bridge] [b3] [info] Destroying Bridge instance
[2020-12-24 10:21:21.241] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:21:21.241] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:21:21.241] [Bridge] [b3] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:21:21.275] [Bridge] [b3] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:21.775] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:21:21.776] [Bridge] [b3] [info] Destroying Stp instance for vlan 10
</system-out></testcase><testcase name="./../src/services/pcn-bridge/test/vlan_and_stp/test2.sh" time="157.000000" status="Passed"><system-out>[2020-12-24 10:21:23.458] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:21:23.459] [polycubed] [info] configuration parameters: 
[2020-12-24 10:21:23.459] [polycubed] [info]  loglevel: info
[2020-12-24 10:21:23.459] [polycubed] [info]  daemon: false
[2020-12-24 10:21:23.459] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:21:23.459] [polycubed] [info]  port: 9000
[2020-12-24 10:21:23.459] [polycubed] [info]  addr: localhost
[2020-12-24 10:21:23.459] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:21:23.459] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:21:23.459] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:21:23.459] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:21:23.459] [polycubed] [info] polycubed starting...
[2020-12-24 10:21:23.459] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:21:25.633] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:21:25.634] [polycubed] [info] rest server starting ...
[2020-12-24 10:21:25.681] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:21:25.692] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:21:25.706] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:21:25.716] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:21:25.749] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:21:25.759] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:21:25.802] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:21:25.834] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:21:25.869] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:21:25.913] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:21:25.958] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:21:25.981] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:21:25.991] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:21:26.006] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:21:26.015] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:21:26.023] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:21:26.066] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:21:26.115] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:21:26.115] [polycubed] [info] loading metrics from yang files
setting up topology..
[2020-12-24 10:21:28.646] [Bridge] [b1] [info] Creating Bridge instance
[2020-12-24 10:21:29.565] [Bridge] [b2] [info] Creating Bridge instance
[2020-12-24 10:21:30.470] [Bridge] [b3] [info] Creating Bridge instance
[2020-12-24 10:21:31.377] [Bridge] [b4] [info] Creating Bridge instance
[2020-12-24 10:21:32.304] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:21:32.305] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:21:32.311] [Bridge] [b1] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:32.805] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:21:32.812] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:21:32.813] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:21:32.823] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:21:32.827] [Bridge] [b1] [info] Creating Stp instance
[2020-12-24 10:21:32.832] [Bridge] [b1] [info] Creating Ports instance
[2020-12-24 10:21:33.616] [Bridge] [b2] [error] Port 0 not found
[2020-12-24 10:21:33.788] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:21:33.788] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:21:33.795] [Bridge] [b2] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:34.288] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:21:34.295] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:21:34.295] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:21:34.304] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:21:34.310] [Bridge] [b2] [info] Creating Stp instance
[2020-12-24 10:21:34.314] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:21:34.332] [Bridge] [b2] [info] Creating Ports instance
[2020-12-24 10:21:35.288] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:21:35.288] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:21:35.295] [Bridge] [b3] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:21:35.789] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:21:35.796] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:21:35.796] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:21:35.801] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:21:35.806] [Bridge] [b3] [info] Creating Stp instance
[2020-12-24 10:21:35.816] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:21:35.835] [Bridge] [b3] [info] Creating Ports instance
[2020-12-24 10:21:35.866] [Bridge] [b4] [info] Creating Ports instance
[2020-12-24 10:21:35.866] [Bridge] [b4] [info] Creating Stp instance
[2020-12-24 10:21:35.871] [Bridge] [b4] [info] Creating Stp instance
[2020-12-24 10:21:35.876] [Bridge] [b4] [info] Creating Stp instance
[2020-12-24 10:21:35.880] [Bridge] [b4] [info] Creating Stp instance
[2020-12-24 10:21:35.885] [Bridge] [b4] [info] Creating Ports instance
[2020-12-24 10:21:39.851] [polycubed] [warning] packetout: port b1:tob3 is down
[2020-12-24 10:21:49.285] [polycubed] [warning] packetout: port b3:tob4 is down
[2020-12-24 10:21:49.286] [polycubed] [warning] packetout: port b3:tob4 is down
sleeping for convergence..
testing ports..
testing connectivity..
changing topology..
[2020-12-24 10:22:46.663] [polycubed] [warning] packetout: port b2:tob4 is down
[2020-12-24 10:22:47.453] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:22:47.453] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:22:47.453] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:22:47.454] [polycubed] [warning] packetout: port b4:tob2 is down
[2020-12-24 10:22:47.454] [polycubed] [warning] packetout: port b4:tob2 is down
[2020-12-24 10:22:47.460] [Bridge] [b4] [info] Destroying Ports instance
sleeping for convergence..
testing ports..
testing connectivity..
end.
cleaning up..
[2020-12-24 10:23:41.666] [Bridge] [b1] [info] Destroying Bridge instance
[2020-12-24 10:23:42.460] [polycubed] [warning] packetout: port b1:tob2 is down
[2020-12-24 10:23:44.184] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:44.844] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:45.639] [polycubed] [warning] packetout: port b1:tov1 is down
[2020-12-24 10:23:45.653] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:23:45.653] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:23:45.653] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:45.653] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:23:45.653] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:23:45.653] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:45.653] [Bridge] [b1] [info] Destroying Stp instance for vlan 45
[2020-12-24 10:23:45.653] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:23:45.653] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:45.654] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:45.654] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:45.654] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:45.654] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:45.654] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:46.139] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:46.140] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:46.140] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:46.140] [Bridge] [b1] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:23:46.640] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:46.641] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:46.641] [Bridge] [b1] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:23:47.140] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:47.140] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:47.140] [polycubed] [warning] packetout: port b2:tob1 is down
[2020-12-24 10:23:47.141] [Bridge] [b1] [info] Destroying Ports instance
[2020-12-24 10:23:47.141] [Bridge] [b1] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:23:47.648] [Bridge] [b2] [info] Destroying Bridge instance
[2020-12-24 10:23:48.641] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:48.641] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:49.389] [polycubed] [warning] packetout: port b2:tob3 is down
[2020-12-24 10:23:50.890] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:50.890] [polycubed] [warning] packetout: port b3:tob2 is down
[2020-12-24 10:23:50.985] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:23:50.985] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:23:50.985] [polycubed] [warning] Error processing packet in event: map::at
[2020-12-24 10:23:50.985] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:23:50.985] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:50.985] [polycubed] [warning] packetout: port b3:tob2 is down
[2020-12-24 10:23:50.985] [Bridge] [b2] [info] Destroying Stp instance for vlan 45
[2020-12-24 10:23:51.391] [Bridge] [b2] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:23:51.891] [Bridge] [b2] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:23:52.391] [Bridge] [b2] [info] Destroying Ports instance
[2020-12-24 10:23:52.391] [Bridge] [b2] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:23:52.891] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:52.891] [polycubed] [warning] packetout: port b3:tob2 is down
[2020-12-24 10:23:52.891] [polycubed] [warning] packetout: port b3:tob1 is down
[2020-12-24 10:23:52.891] [polycubed] [warning] packetout: port b3:tob2 is down
[2020-12-24 10:23:52.897] [Bridge] [b3] [info] Destroying Bridge instance
[2020-12-24 10:23:54.892] [polycubed] [warning] packetout: port b3:tob4 is down
[2020-12-24 10:23:55.079] [polycubed] [warning] packetout: port b4:tob3 is down
[2020-12-24 10:23:55.885] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:23:55.885] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:23:55.885] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:23:55.885] [Bridge] [b3] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:23:55.892] [Bridge] [b3] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:23:56.392] [Bridge] [b3] [info] Destroying Stp instance for vlan 1
[2020-12-24 10:23:56.892] [Bridge] [b3] [info] Destroying Ports instance
[2020-12-24 10:23:56.893] [Bridge] [b3] [info] Destroying Stp instance for vlan 45
[2020-12-24 10:23:57.080] [polycubed] [warning] packetout: port b4:tob3 is down
[2020-12-24 10:23:57.400] [Bridge] [b4] [info] Destroying Bridge instance
[2020-12-24 10:23:57.404] [Bridge] [b4] [info] Destroying Ports instance
[2020-12-24 10:23:57.404] [Bridge] [b4] [info] Destroying Stp instance for vlan 45
[2020-12-24 10:23:57.580] [Bridge] [b4] [info] Destroying Stp instance for vlan 10
[2020-12-24 10:23:57.893] [Bridge] [b4] [info] Destroying Stp instance for vlan 14
[2020-12-24 10:23:58.393] [Bridge] [b4] [info] Destroying Stp instance for vlan 1
</system-out></testcase><testcase name="./../src/services/pcn-ddosmitigator/test/test1.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:24:00.099] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:24:00.100] [polycubed] [info] configuration parameters: 
[2020-12-24 10:24:00.100] [polycubed] [info]  loglevel: info
[2020-12-24 10:24:00.100] [polycubed] [info]  daemon: false
[2020-12-24 10:24:00.100] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:24:00.100] [polycubed] [info]  port: 9000
[2020-12-24 10:24:00.100] [polycubed] [info]  addr: localhost
[2020-12-24 10:24:00.100] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:24:00.100] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:24:00.100] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:24:00.100] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:24:00.100] [polycubed] [info] polycubed starting...
[2020-12-24 10:24:00.100] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:24:02.281] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:24:02.282] [polycubed] [info] rest server starting ...
[2020-12-24 10:24:02.324] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:24:02.335] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:24:02.349] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:24:02.359] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:24:02.391] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:24:02.401] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:24:02.442] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:24:02.475] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:24:02.510] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:24:02.552] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:24:02.596] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:24:02.619] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:24:02.630] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:24:02.646] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:24:02.655] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:24:02.664] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:24:02.705] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:24:02.753] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:24:02.753] [polycubed] [info] loading metrics from yang files
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ifconfig veth1 10.0.0.2/24
+ TYPE=TC
+ polycubectl ddosmitigator add d1 type=TC
[2020-12-24 10:24:05.079] [d1] [info] Creating Ddosmitigator instance d1
+ polycubectl attach d1 veth1
+ polycubectl ddosmitigator d1 set loglevel=INFO
+ echo 'Show statistics before ping and blacklists'
Show statistics before ping and blacklists
+ polycubectl ddosmitigator d1 stats show
[2020-12-24 10:24:05.938] [d1] [info] Creating Stats instance
pps: 0
pkts: 0

+ echo 'Test connectivity'
Test connectivity
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.043 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1004ms
rtt min/avg/max/mdev = 0.043/0.048/0.054/0.008 ms
+ polycubectl ddosmitigator d1 blacklist-src add 10.0.0.1
[2020-12-24 10:24:07.959] [d1] [info] reloading code ...
+ echo 'This ping should FAIL'
This ping should FAIL
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 4 -W 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 4 -W 2
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3070ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl ddosmitigator d1 show blacklist-src
Size of the terminal is too small, output could be missaligned.drop-pkts  ip
4          10.0.0.1

+ polycubectl ddosmitigator d1 blacklist-src del 10.0.0.1
[2020-12-24 10:24:13.772] [d1] [info] reloading code ...
+ echo 'This ping should PASS'
This ping should PASS
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.028 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.058 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1006ms
rtt min/avg/max/mdev = 0.028/0.043/0.058/0.015 ms
+ echo 'Set Debug level to Trace'
Set Debug level to Trace
+ polycubectl ddosmitigator d1 set loglevel=TRACE
+ polycubectl ddosmitigator d1 blacklist-dst add 10.0.0.1
[2020-12-24 10:24:16.236] [d1] [debug] BlacklistDst create
[2020-12-24 10:24:16.236] [d1] [debug] reloadCode true 
[2020-12-24 10:24:16.236] [d1] [info] reloading code ...
[2020-12-24 10:24:16.967] [d1] [debug] BlacklistDst Constructor. ip 10.0.0.1 
+ echo 'This ping should PASS'
This ping should PASS
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.061 ms
[2020-12-24 10:24:16.975] [d1] [debug] Passing accepted

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.061/0.061/0.061/0.000 ms
+ polycubectl ddosmitigator d1 blacklist-dst add 10.0.0.2
[2020-12-24 10:24:16.981] [d1] [debug] BlacklistDst create
[2020-12-24 10:24:16.981] [d1] [debug] reloadCode false 
[2020-12-24 10:24:16.981] [d1] [debug] BlacklistDst Constructor. ip 10.0.0.2 
+ echo 'This ping should FAIL'
This ping should FAIL
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 5 -W 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 5 -W 2
[2020-12-24 10:24:16.989] [d1] [debug] Dropcount proto:1 value: 5 
[2020-12-24 10:24:16.989] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:18.000] [d1] [debug] Dropcount proto:1 value: 6 
[2020-12-24 10:24:18.000] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:18.225] [d1] [debug] Passing accepted
[2020-12-24 10:24:19.024] [d1] [debug] Dropcount proto:1 value: 7 
[2020-12-24 10:24:19.024] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:20.048] [d1] [debug] Dropcount proto:1 value: 8 
[2020-12-24 10:24:20.048] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:21.072] [d1] [debug] Dropcount proto:1 value: 9 
[2020-12-24 10:24:21.072] [d1] [debug] Dropping packet ethtype: 8 
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 4083ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl ddosmitigator d1 show blacklist-dst
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst get vector
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst getEntry
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst getEntry
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst getIp 10.0.0.2 
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst toJsonObject
[2020-12-24 10:24:23.080] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:23.080] [d1] [debug] got 5 pkts
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst getIp 10.0.0.1 
[2020-12-24 10:24:23.080] [d1] [debug] BlacklistDst toJsonObject
[2020-12-24 10:24:23.080] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:23.080] [d1] [debug] got 0 pkts
Size of the terminal is too small, output could be missaligned.drop-pkts  ip
5          10.0.0.2
0          10.0.0.1

+ echo 'Show statistics after ping and blacklists'
Show statistics after ping and blacklists
+ polycubectl ddosmitigator d1 stats show
[2020-12-24 10:24:23.085] [d1] [debug] Stats getEntry
[2020-12-24 10:24:23.085] [d1] [info] Creating Stats instance
[2020-12-24 10:24:23.085] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:23.085] [d1] [debug] got 9 pkts
[2020-12-24 10:24:24.086] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:24.086] [d1] [debug] got 9 pkts
[2020-12-24 10:24:24.086] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:24.086] [d1] [debug] got 9 pkts
pps: 0
pkts: 9

+ cleanup
+ set +e
+ polycubectl detach d1 veth1
+ polycubectl ddosmitigator del d1
[2020-12-24 10:24:24.115] [d1] [debug] BlacklistDst Destructor. ip 10.0.0.2 
[2020-12-24 10:24:24.115] [d1] [debug] BlacklistDst Destructor. ip 10.0.0.1 
+ sudo ip link del veth1
+ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-ddosmitigator/test/test1_xdp.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:24:25.224] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:24:25.224] [polycubed] [info] configuration parameters: 
[2020-12-24 10:24:25.224] [polycubed] [info]  loglevel: info
[2020-12-24 10:24:25.224] [polycubed] [info]  daemon: false
[2020-12-24 10:24:25.224] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:24:25.224] [polycubed] [info]  port: 9000
[2020-12-24 10:24:25.224] [polycubed] [info]  addr: localhost
[2020-12-24 10:24:25.224] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:24:25.224] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:24:25.224] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:24:25.224] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:24:25.224] [polycubed] [info] polycubed starting...
[2020-12-24 10:24:25.224] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:24:27.396] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:24:27.397] [polycubed] [info] rest server starting ...
[2020-12-24 10:24:27.444] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:24:27.455] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:24:27.469] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:24:27.478] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:24:27.511] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:24:27.521] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:24:27.563] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:24:27.596] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:24:27.630] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:24:27.672] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:24:27.716] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:24:27.739] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:24:27.750] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:24:27.766] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:24:27.774] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:24:27.783] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:24:27.825] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:24:27.873] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:24:27.873] [polycubed] [info] loading metrics from yang files
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ifconfig veth1 10.0.0.2/24
+ TYPE=TC
+ polycubectl ddosmitigator add d1 type=TC
[2020-12-24 10:24:30.186] [d1] [info] Creating Ddosmitigator instance d1
+ polycubectl attach d1 veth1
+ polycubectl ddosmitigator d1 set loglevel=INFO
+ echo 'Show statistics before ping and blacklists'
Show statistics before ping and blacklists
+ polycubectl ddosmitigator d1 stats show
[2020-12-24 10:24:31.055] [d1] [info] Creating Stats instance
pps: 0
pkts: 0

+ echo 'Test connectivity'
Test connectivity
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.051 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1007ms
rtt min/avg/max/mdev = 0.051/0.052/0.054/0.007 ms
+ polycubectl ddosmitigator d1 blacklist-src add 10.0.0.1
[2020-12-24 10:24:33.079] [d1] [info] reloading code ...
+ echo 'This ping should FAIL'
This ping should FAIL
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 4 -W 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 4 -W 2
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3071ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl ddosmitigator d1 show blacklist-src
Size of the terminal is too small, output could be missaligned.drop-pkts  ip
4          10.0.0.1

+ polycubectl ddosmitigator d1 blacklist-src del 10.0.0.1
[2020-12-24 10:24:38.892] [d1] [info] reloading code ...
+ echo 'This ping should PASS'
This ping should PASS
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.032 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1003ms
rtt min/avg/max/mdev = 0.032/0.043/0.054/0.011 ms
+ echo 'Set Debug level to Trace'
Set Debug level to Trace
+ polycubectl ddosmitigator d1 set loglevel=TRACE
+ polycubectl ddosmitigator d1 blacklist-dst add 10.0.0.1
[2020-12-24 10:24:41.387] [d1] [debug] BlacklistDst create
[2020-12-24 10:24:41.387] [d1] [debug] reloadCode true 
[2020-12-24 10:24:41.387] [d1] [info] reloading code ...
[2020-12-24 10:24:42.114] [d1] [debug] BlacklistDst Constructor. ip 10.0.0.1 
+ echo 'This ping should PASS'
This ping should PASS
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1 -W 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.051 ms

[2020-12-24 10:24:42.122] [d1] [debug] Passing accepted
--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.051/0.051/0.051/0.000 ms
+ polycubectl ddosmitigator d1 blacklist-dst add 10.0.0.2
[2020-12-24 10:24:42.127] [d1] [debug] BlacklistDst create
[2020-12-24 10:24:42.127] [d1] [debug] reloadCode false 
[2020-12-24 10:24:42.127] [d1] [debug] BlacklistDst Constructor. ip 10.0.0.2 
+ echo 'This ping should FAIL'
This ping should FAIL
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 5 -W 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 5 -W 2
[2020-12-24 10:24:42.135] [d1] [debug] Dropcount proto:1 value: 5 
[2020-12-24 10:24:42.135] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:43.152] [d1] [debug] Dropcount proto:1 value: 6 
[2020-12-24 10:24:43.153] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:43.824] [d1] [debug] Passing accepted
[2020-12-24 10:24:44.176] [d1] [debug] Dropcount proto:1 value: 7 
[2020-12-24 10:24:44.176] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:45.200] [d1] [debug] Dropcount proto:1 value: 8 
[2020-12-24 10:24:45.200] [d1] [debug] Dropping packet ethtype: 8 
[2020-12-24 10:24:46.224] [d1] [debug] Dropcount proto:1 value: 9 
[2020-12-24 10:24:46.224] [d1] [debug] Dropping packet ethtype: 8 
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 4089ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl ddosmitigator d1 show blacklist-dst
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst get vector
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst getEntry
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst getEntry
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst getIp 10.0.0.2 
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst toJsonObject
[2020-12-24 10:24:48.231] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:48.231] [d1] [debug] got 5 pkts
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst getIp 10.0.0.1 
[2020-12-24 10:24:48.231] [d1] [debug] BlacklistDst toJsonObject
[2020-12-24 10:24:48.231] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:48.231] [d1] [debug] got 0 pkts
Size of the terminal is too small, output could be missaligned.drop-pkts  ip
5          10.0.0.2
0          10.0.0.1

+ echo 'Show statistics after ping and blacklists'
Show statistics after ping and blacklists
+ polycubectl ddosmitigator d1 stats show
[2020-12-24 10:24:48.236] [d1] [debug] Stats getEntry
[2020-12-24 10:24:48.236] [d1] [info] Creating Stats instance
[2020-12-24 10:24:48.236] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:48.236] [d1] [debug] got 9 pkts
[2020-12-24 10:24:49.237] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:49.237] [d1] [debug] got 9 pkts
[2020-12-24 10:24:49.237] [d1] [debug] getting dropped packets...
[2020-12-24 10:24:49.237] [d1] [debug] got 9 pkts
pps: 0
pkts: 9

+ cleanup
+ set +e
+ polycubectl detach d1 veth1
+ polycubectl ddosmitigator del d1
[2020-12-24 10:24:49.267] [d1] [debug] BlacklistDst Destructor. ip 10.0.0.2 
[2020-12-24 10:24:49.267] [d1] [debug] BlacklistDst Destructor. ip 10.0.0.1 
+ sudo ip link del veth1
+ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-dynmon/test/test1.sh" time="11.000000" status="Passed"><system-out>[2020-12-24 10:24:50.389] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:24:50.390] [polycubed] [info] configuration parameters: 
[2020-12-24 10:24:50.390] [polycubed] [info]  loglevel: info
[2020-12-24 10:24:50.390] [polycubed] [info]  daemon: false
[2020-12-24 10:24:50.390] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:24:50.390] [polycubed] [info]  port: 9000
[2020-12-24 10:24:50.390] [polycubed] [info]  addr: localhost
[2020-12-24 10:24:50.390] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:24:50.390] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:24:50.390] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:24:50.390] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:24:50.390] [polycubed] [info] polycubed starting...
[2020-12-24 10:24:50.390] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:24:52.588] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:24:52.589] [polycubed] [info] rest server starting ...
[2020-12-24 10:24:52.637] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:24:52.648] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:24:52.662] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:24:52.672] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:24:52.705] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:24:52.716] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:24:52.760] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:24:52.793] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:24:52.829] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:24:52.873] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:24:52.919] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:24:52.942] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:24:52.954] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:24:52.969] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:24:52.978] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:24:52.987] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:24:53.031] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:24:53.080] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:24:53.080] [polycubed] [info] loading metrics from yang files
+ set -e
++ dirname ./../src/services/pcn-dynmon/test/test1.sh
+ DIR=./../src/services/pcn-dynmon/test
+ TYPE=TC
+ '[' -n '' ']'
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl dynmon add dm type=TC
[2020-12-24 10:24:54.923] [Dynmon] [dm] [info] Creating Dynmon instance
+ polycubectl dm show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: dm
uuid: 2567f34f-30b7-4589-b3ca-3a193c1884b1
service-name: dynmon
type: TC
loglevel: INFO
parent: 
dataplane-config:
 ingress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
 egress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
metrics:

 ingress-metrics:
  

 egress-metrics:
  

+ polycubectl attach dm veth1
+ curl -H 'Content-Type: application/json' localhost:9000/polycube/v1/dynmon/dm/dataplane-config --upload-file ./../src/services/pcn-dynmon/test/test_dataplane.json
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0   913    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[2020-12-24 10:24:56.857] [Dynmon] [dm] [info] [Dynmon_CodeRewriter] No map marked as swappable, no rewrites performed

100   913    0     0  100   913      0    722  0:00:01  0:00:01 --:--:--   721
100   913    0     0  100   913      0    722  0:00:01  0:00:01 --:--:--   721
+ polycubectl dm show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: dm
uuid: 2567f34f-30b7-4589-b3ca-3a193c1884b1
service-name: dynmon
type: TC
loglevel: INFO
parent: veth1
dataplane-config:
 ingress-path:
  name: Packets counter probe
  code: 
 BPF_ARRAY(PKT_COUNTER, uint64_t, 1);
 static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
 unsigned int key = 0;
 uint64_t *pkt_counter = PKT_COUNTER.lookup(&amp;key);
 if (!pkt_counter){
    /*counter map not found !? */
    return RX_OK;
 }
 *pkt_counter+=1;
 pcn_log(ctx, LOG_TRACE, "counter: %d", *pkt_counter);
 return RX_OK;
 }

  metric-configs:
   name           map-name
   packets_total  PKT_COUNTER
 egress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
metrics:

 ingress-metrics:
  name           timestamp                value
  packets_total  1608805496996719.000000  [1 items]

 egress-metrics:
  

+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
++ grep -Po '[0-9]+(?= +packets transmitted)'
+ ping_result=2
+ set -e
+ polycubectl dm metrics show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.
ingress-metrics:
 name           timestamp                value
 packets_total  1608805499014963.000000  [1 items]

egress-metrics:
 

+ polycubectl dm open-metrics show
+ polycubectl dm metrics ingress-metrics packets_total show
Size of the terminal is too small, output could be missaligned.name: packets_total
timestamp: 1608805499026545.000000

value:
 

++ polycubectl dm metrics ingress-metrics packets_total value show
++ sed -n 's/^\[\([0-9]*\)\]$/\1/p'
+ metric_value=
+ '[' -eq 0 ']'
./../src/services/pcn-dynmon/test/test1.sh: line 56: [: -eq: unary operator expected
+ '[' -lt 2 ']'
./../src/services/pcn-dynmon/test/test1.sh: line 56: [: -lt: unary operator expected
+ echo 'packets_total: '
packets_total: 
+ echo 'TEST: OK'
TEST: OK
+ cleanup
+ set +e
+ polycubectl dynmon del dm
[2020-12-24 10:24:59.036] [Dynmon] [dm] [info] Destroying Dynmon instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-dynmon/test/test2.sh" time="11.000000" status="Passed"><system-out>[2020-12-24 10:25:01.239] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:25:01.239] [polycubed] [info] configuration parameters: 
[2020-12-24 10:25:01.239] [polycubed] [info]  loglevel: info
[2020-12-24 10:25:01.239] [polycubed] [info]  daemon: false
[2020-12-24 10:25:01.239] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:25:01.239] [polycubed] [info]  port: 9000
[2020-12-24 10:25:01.239] [polycubed] [info]  addr: localhost
[2020-12-24 10:25:01.239] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:25:01.239] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:25:01.239] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:25:01.239] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:25:01.239] [polycubed] [info] polycubed starting...
[2020-12-24 10:25:01.239] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:25:03.432] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:25:03.433] [polycubed] [info] rest server starting ...
[2020-12-24 10:25:03.480] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:25:03.492] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:25:03.506] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:25:03.516] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:25:03.550] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:25:03.560] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:25:03.603] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:25:03.636] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:25:03.672] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:25:03.715] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:25:03.760] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:25:03.783] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:25:03.794] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:25:03.809] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:25:03.818] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:25:03.827] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:25:03.869] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:25:03.918] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:25:03.918] [polycubed] [info] loading metrics from yang files
+ set -e
++ dirname ./../src/services/pcn-dynmon/test/test2.sh
+ DIR=./../src/services/pcn-dynmon/test
+ TYPE=TC
+ '[' -n '' ']'
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl dynmon add dm type=TC
[2020-12-24 10:25:05.777] [Dynmon] [dm] [info] Creating Dynmon instance
+ polycubectl dm show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: dm
uuid: e99a2d33-adc8-42d2-98e9-f931dc2db1d8
service-name: dynmon
type: TC
loglevel: INFO
parent: 
dataplane-config:
 ingress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
 egress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
metrics:

 ingress-metrics:
  

 egress-metrics:
  

+ polycubectl attach dm veth1
+ curl -H 'Content-Type: application/json' localhost:9000/polycube/v1/dynmon/dm/dataplane-config --upload-file ./../src/services/pcn-dynmon/test/test_map_extraction.json
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0  1314    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0[2020-12-24 10:25:07.719] [Dynmon] [dm] [info] [Dynmon_CodeRewriter] No map marked as swappable, no rewrites performed

100  1314    0     0  100  1314      0   1035  0:00:01  0:00:01 --:--:--  1035
100  1314    0     0  100  1314      0   1035  0:00:01  0:00:01 --:--:--  1034
+ polycubectl dm show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: dm
uuid: e99a2d33-adc8-42d2-98e9-f931dc2db1d8
service-name: dynmon
type: TC
loglevel: INFO
parent: veth1
dataplane-config:
 ingress-path:
  name: Feature extractor probe
  code: struct features {
    uint64_t timestamp;
    uint16_t length;
} __attribute__((packed));

struct session_key {
    __be32 saddr;
    __be32 daddr;
    __be16 sport;
    __be16 dport;
    __u8   proto;
} __attribute__((packed));


BPF_ARRAY(SIMPLE_ARRAY, struct features, 1);
BPF_TABLE("hash", struct session_key, int, SIMPLE_HASH, 1);

static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  struct session_key key = {.saddr=1, .daddr=2, .sport=11, .dport=22, .proto=0};
  int i = 0;
  int *value = SIMPLE_HASH.lookup_or_try_init(&amp;key, &amp;i);
  
  struct features newVal = {.timestamp=1010, .length=1010};
  SIMPLE_ARRAY.update(&amp;i, &amp;newVal);

  return RX_OK;
}


  metric-configs:
   name          map-name
   SIMPLE_ARRAY  SIMPLE_ARRAY
   SIMPLE_HASH   SIMPLE_HASH
 egress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
metrics:

 ingress-metrics:
  name          timestamp                value
  SIMPLE_ARRAY  1608805507861329.000000  [1 items]
  SIMPLE_HASH   1608805507861413.000000  &lt;nil&gt;

 egress-metrics:
  

+ set +e
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 0ms

+ set -e
+ polycubectl dm metrics show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.
ingress-metrics:
 name          timestamp                value
 SIMPLE_ARRAY  1608805508878174.000000  [1 items]
 SIMPLE_HASH   1608805508878372.000000  [1 items]

egress-metrics:
 

+ expected_sh='[{"key":{"saddr":1,"daddr":2,"sport":11,"dport":22,"proto":0},"value":0}]'
+ expected_sa='[{"timestamp":1010,"length":1010}]'
++ curl localhost:9000/polycube/v1/dynmon/dm/metrics/ingress-metrics/SIMPLE_HASH/value
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    73  100    73    0     0  73000      0 --:--:-- --:--:-- --:--:-- 73000
+ simple_hash_value='[{"key":{"saddr":1,"daddr":2,"sport":11,"dport":22,"proto":0},"value":0}]'
++ curl localhost:9000/polycube/v1/dynmon/dm/metrics/ingress-metrics/SIMPLE_ARRAY/value
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    34  100    34    0     0  34000      0 --:--:-- --:--:-- --:--:-- 34000
+ simple_array_value='[{"timestamp":1010,"length":1010}]'
+ '[' '[{"timestamp":1010,"length":1010}]' '!=' '[{"timestamp":1010,"length":1010}]' ']'
+ '[' '[{"key":{"saddr":1,"daddr":2,"sport":11,"dport":22,"proto":0},"value":0}]' '!=' '[{"key":{"saddr":1,"daddr":2,"sport":11,"dport":22,"proto":0},"value":0}]' ']'
+ queuestack_major=5
+ read major null
++ uname -r
++ sed 's/\./ /g'
+ ((  major &gt;= queuestack_major  ))
+ curl -H 'Content-Type: application/json' localhost:9000/polycube/v1/dynmon/dm/dataplane-config --upload-file ./../src/services/pcn-dynmon/test/test_queuestack.json
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0   749    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0[2020-12-24 10:25:10.040] [Dynmon] [dm] [info] [Dynmon_CodeRewriter] No map marked as swappable, no rewrites performed

100   749    0     0  100   749      0    592  0:00:01  0:00:01 --:--:--   592
+ polycubectl dm show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: dm
uuid: e99a2d33-adc8-42d2-98e9-f931dc2db1d8
service-name: dynmon
type: TC
loglevel: INFO
parent: veth1
dataplane-config:
 ingress-path:
  name: Feature extractor probe
  code: struct features {
    uint64_t timestamp;
    uint16_t length;
} __attribute__((packed));

BPF_QUEUE(SIMPLE_QUEUE, struct features, 1);

static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  struct features newVal = {.timestamp=1010, .length=1010};

  int *value = SIMPLE_QUEUE.push(&amp;newVal, 0);

  return RX_OK;
}

  metric-configs:
   name          map-name
   SIMPLE_QUEUE  SIMPLE_QUEUE
 egress-path:
  name: Default path config
  code: 
static __always_inline int handle_rx(struct CTXTYPE *ctx, struct pkt_metadata *md) {
  return RX_OK;
}
metrics:

 ingress-metrics:
  name          value  timestamp
  SIMPLE_QUEUE  &lt;nil&gt;  1608805510178720.000000

 egress-metrics:
  

+ set +e
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 0 received, 100% packet loss, time 0ms

+ set -e
++ curl localhost:9000/polycube/v1/dynmon/dm/metrics/ingress-metrics/SIMPLE_QUEUE/value
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    34  100    34    0     0  34000      0 --:--:-- --:--:-- --:--:-- 34000
+ simple_queue_value='[{"timestamp":1010,"length":1010}]'
+ '[' '[{"timestamp":1010,"length":1010}]' '!=' '[{"timestamp":1010,"length":1010}]' ']'
+ echo 'All tests passed!'
All tests passed!
+ cleanup
+ set +e
+ polycubectl dynmon del dm
[2020-12-24 10:25:11.204] [Dynmon] [dm] [info] Destroying Dynmon instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/test1.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:25:12.395] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:25:12.396] [polycubed] [info] configuration parameters: 
[2020-12-24 10:25:12.396] [polycubed] [info]  loglevel: info
[2020-12-24 10:25:12.396] [polycubed] [info]  daemon: false
[2020-12-24 10:25:12.396] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:25:12.396] [polycubed] [info]  port: 9000
[2020-12-24 10:25:12.396] [polycubed] [info]  addr: localhost
[2020-12-24 10:25:12.396] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:25:12.396] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:25:12.396] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:25:12.396] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:25:12.396] [polycubed] [info] polycubed starting...
[2020-12-24 10:25:12.396] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:25:14.587] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:25:14.587] [polycubed] [info] rest server starting ...
[2020-12-24 10:25:14.632] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:25:14.643] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:25:14.657] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:25:14.667] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:25:14.700] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:25:14.711] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:25:14.753] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:25:14.785] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:25:14.820] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:25:14.863] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:25:14.907] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:25:14.930] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:25:14.941] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:25:14.956] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:25:14.965] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:25:14.974] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:25:15.016] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:25:15.063] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:25:15.063] [polycubed] [info] loading metrics from yang files

Test 1 

++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:25:16.960] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:25:16.960] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS rule add 0 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:25:22.470] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:25:22.470] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:22.470] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:25:22.480] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:22.480] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:22.637] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:22.791] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:23.861] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.391s!
++ polycubectl firewall fw chain EGRESS rule add 0 src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:25:23.868] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:25:23.868] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:23.868] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:25:24.036] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:24.191] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:25.244] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37592s!
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.175 ms
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:25:25.286] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:25:25.808] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.175 ms
[2020-12-24 10:25:25.808] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.

[2020-12-24 10:25:25.808] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 522ms
rtt min/avg/max/mdev = 0.175/0.175/0.175/0.000 ms
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:25:25.809] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:25:25.815] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_disable_enable.sh" time="47.000000" status="Passed"><system-out>[2020-12-24 10:25:27.469] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:25:27.470] [polycubed] [info] configuration parameters: 
[2020-12-24 10:25:27.470] [polycubed] [info]  loglevel: info
[2020-12-24 10:25:27.470] [polycubed] [info]  daemon: false
[2020-12-24 10:25:27.470] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:25:27.470] [polycubed] [info]  port: 9000
[2020-12-24 10:25:27.470] [polycubed] [info]  addr: localhost
[2020-12-24 10:25:27.470] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:25:27.470] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:25:27.470] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:25:27.470] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:25:27.470] [polycubed] [info] polycubed starting...
[2020-12-24 10:25:27.470] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:25:29.660] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:25:29.660] [polycubed] [info] rest server starting ...
[2020-12-24 10:25:29.705] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:25:29.716] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:25:29.730] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:25:29.739] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:25:29.772] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:25:29.782] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:25:29.824] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:25:29.856] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:25:29.891] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:25:29.934] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:25:29.978] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:25:30.001] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:25:30.012] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:25:30.028] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:25:30.037] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:25:30.046] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:25:30.088] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:25:30.136] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:25:30.136] [polycubed] [info] loading metrics from yang files
[2020-12-24 10:25:31.971] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:25:31.971] [Firewall] [fw] [debug] Ingress and Egress chain added
Conntrack Test - Enable and Disable
Disabling conntrack
[2020-12-24 10:25:37.584] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:37.584] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:25:37.584] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:37.584] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:38.094] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:25:38.094] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:38.094] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:25:38.260] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:38.416] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:39.171] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07654s!
[2020-12-24 10:25:39.171] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:25:39.171] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:39.171] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:25:39.338] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:39.493] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:40.268] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09697s!
id: 0

[2020-12-24 10:25:40.275] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:25:40.275] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:40.275] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:25:40.441] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:40.596] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:41.348] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07307s!
[2020-12-24 10:25:41.348] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:25:41.348] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:25:41.348] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:25:41.515] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:25:41.670] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:42.429] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08049s!
id: 0

(1) Performing PING without conntrack
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.094 ms
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT disabled. Return RX_OK 
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:25:42.439] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT disabled. Return RX_OK 
[2020-12-24 10:25:42.960] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:42.960] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.097 ms

[2020-12-24 10:25:42.960] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:25:42.960] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:25:42.960] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT disabled. Return RX_OK 
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 521ms
rtt min/avg/max/mdev = 0.094/0.095/0.097/0.009 ms
[2020-12-24 10:25:42.961] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:42.961] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:25:42.961] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:25:42.961] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:25:42.961] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT disabled. Return RX_OK 
Enabling conntrack
Enabling automatic mode
[2020-12-24 10:25:44.582] [Firewall] [fw] [info] Rule 0 overwritten!
[2020-12-24 10:25:44.582] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:25:44.736] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:45.520] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:45.520] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:45.639] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05759s!
[2020-12-24 10:25:45.646] [Firewall] [fw] [info] Rule 0 overwritten!
[2020-12-24 10:25:45.646] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:25:45.776] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:45.776] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:25:45.801] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:46.704] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05812s!
(2) Sending NOT allowed NEW ICMP packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:25:46.713] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:25:47.216] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:25:47.217] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:25:47.568] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:47.568] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:25:47.568] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:47.568] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 503ms

(3) Performing allowed PING
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.121 ms
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:57.259] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:25:57.260] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:57.260] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:57.260] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:25:57.260] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:25:57.776] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:25:57.776] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.149 ms
[2020-12-24 10:25:57.776] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 

[2020-12-24 10:25:57.776] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 517ms
rtt min/avg/max/mdev = 0.121/0.135/0.149/0.014 ms
[2020-12-24 10:25:57.776] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:25:57.777] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
Enabling manual mode
[2020-12-24 10:25:58.195] [Firewall] [fw] [info] Rule 0 overwritten!
[2020-12-24 10:25:58.195] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:25:58.351] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:25:59.111] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.915357s!
[2020-12-24 10:25:59.117] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:25:59.273] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:00.024] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.907313s!
[2020-12-24 10:26:00.032] [Firewall] [fw] [info] Rule 0 overwritten!
[2020-12-24 10:26:00.032] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:26:00.187] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:00.880] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:00.880] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:26:00.942] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.909895s!
[2020-12-24 10:26:00.948] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:26:01.103] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:01.851] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.902775s!
(4) Sending NOT allowed NEW ICMP packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:26:01.860] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:02.384] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:02.385] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:02.385] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:02.385] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:26:02.385] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:26:03.440] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:03.440] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 524ms

(5) Performing allowed PING
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.100 ms
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:26:12.395] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:26:12.396] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.134 ms
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][Action]: receiving packet

[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:26:12.912] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 517ms
rtt min/avg/max/mdev = 0.100/0.117/0.134/0.017 ms
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:26:12.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
Test PASSED
[2020-12-24 10:26:12.919] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_echo.sh" time="30.000000" status="Passed"><system-out>[2020-12-24 10:26:14.488] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:26:14.489] [polycubed] [info] configuration parameters: 
[2020-12-24 10:26:14.489] [polycubed] [info]  loglevel: info
[2020-12-24 10:26:14.489] [polycubed] [info]  daemon: false
[2020-12-24 10:26:14.489] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:26:14.489] [polycubed] [info]  port: 9000
[2020-12-24 10:26:14.489] [polycubed] [info]  addr: localhost
[2020-12-24 10:26:14.489] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:26:14.489] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:26:14.489] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:26:14.489] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:26:14.489] [polycubed] [info] polycubed starting...
[2020-12-24 10:26:14.489] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:26:16.665] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:26:16.666] [polycubed] [info] rest server starting ...
[2020-12-24 10:26:16.714] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:26:16.724] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:26:16.739] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:26:16.749] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:26:16.783] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:26:16.793] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:26:16.836] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:26:16.870] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:26:16.906] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:26:16.950] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:26:16.996] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:26:17.019] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:26:17.031] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:26:17.046] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:26:17.055] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:26:17.065] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:26:17.108] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:26:17.158] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:26:17.158] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:26:19.007] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:26:19.007] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:26:23.920] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:23.920] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append conntrack=NEW action=DROP
[2020-12-24 10:26:24.483] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:26:24.637] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:24.688] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:24.688] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:26:25.382] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.898872s!
[2020-12-24 10:26:25.382] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:26:25.536] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:26.299] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.916299s!
id: 0

++ polycubectl firewall fw chain INGRESS append conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:26:26.305] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:26:26.459] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:27.206] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.901271s!
[2020-12-24 10:26:27.206] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:26:27.361] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:28.110] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.904036s!
id: 1

++ polycubectl firewall fw chain EGRESS append conntrack=NEW action=FORWARD
[2020-12-24 10:26:28.117] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:26:28.272] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:29.019] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.902737s!
[2020-12-24 10:26:29.019] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:26:29.173] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:29.926] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.90664s!
id: 0

++ polycubectl firewall fw chain EGRESS append conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:26:29.933] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:26:30.088] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:30.833] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.899592s!
[2020-12-24 10:26:30.833] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:26:30.989] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:31.744] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.910648s!
id: 1

++ echo 'ICMP Echo Conntrack Test [No automatic forward][Interactive mode]'
ICMP Echo Conntrack Test [No automatic forward][Interactive mode]
++ set +e
++ echo '(1) Sending NOT allowed NEW ICMP packet'
(1) Sending NOT allowed NEW ICMP packet
++ sudo ip netns exec ns1 ping -c 2 -i 0.5 10.0.0.2
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:31.781] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:26:31.782] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:32.304] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:32.305] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:32.305] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:26:32.305] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:26:32.624] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:32.624] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:26:33.392] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:33.392] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 522ms

++ [[ 1 == 0 ]]
++ echo '(2) Performing allowed PING'
(2) Performing allowed PING
++ sudo ping -c 2 -i 0.5 10.0.0.1
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][Action]: receiving packet
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.117 ms
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:26:42.346] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:26:42.864] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:26:42.864] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:42.864] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.140 ms
[2020-12-24 10:26:42.864] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet

[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 518ms
rtt min/avg/max/mdev = 0.117/0.128/0.140/0.016 ms
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:26:42.865] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ [[ 0 != 0 ]]
++ echo 'Test PASSED'
Test PASSED
++ exit 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:26:42.871] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_echo_2.sh" time="31.000000" status="Passed"><system-out>[2020-12-24 10:26:44.511] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:26:44.512] [polycubed] [info] configuration parameters: 
[2020-12-24 10:26:44.512] [polycubed] [info]  loglevel: info
[2020-12-24 10:26:44.512] [polycubed] [info]  daemon: false
[2020-12-24 10:26:44.512] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:26:44.512] [polycubed] [info]  port: 9000
[2020-12-24 10:26:44.512] [polycubed] [info]  addr: localhost
[2020-12-24 10:26:44.512] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:26:44.512] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:26:44.512] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:26:44.512] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:26:44.512] [polycubed] [info] polycubed starting...
[2020-12-24 10:26:44.512] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:26:46.706] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:26:46.707] [polycubed] [info] rest server starting ...
[2020-12-24 10:26:46.752] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:26:46.763] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:26:46.777] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:26:46.787] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:26:46.819] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:26:46.830] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:26:46.872] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:26:46.904] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:26:46.939] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:26:46.982] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:26:47.026] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:26:47.048] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:26:47.059] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:26:47.075] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:26:47.085] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:26:47.094] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:26:47.136] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:26:47.183] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:26:47.183] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:26:49.022] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:26:49.022] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:26:54.128] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:26:54.128] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append conntrack=NEW action=DROP
[2020-12-24 10:26:54.532] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:26:54.688] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:55.440] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.907458s!
[2020-12-24 10:26:55.440] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:26:55.594] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:56.363] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.923114s!
id: 0

++ polycubectl firewall fw chain INGRESS append conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:26:56.370] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:26:56.526] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:57.280] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.910057s!
[2020-12-24 10:26:57.280] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:26:57.438] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:58.192] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.911489s!
id: 1

++ polycubectl firewall fw chain EGRESS append conntrack=NEW action=FORWARD
[2020-12-24 10:26:58.205] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:26:58.398] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:26:59.362] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.15678s!
[2020-12-24 10:26:59.362] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:26:59.559] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:00.323] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.960745s!
id: 0

++ polycubectl firewall fw chain EGRESS append conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:27:00.330] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:27:00.487] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:01.237] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.906946s!
[2020-12-24 10:27:01.237] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:27:01.393] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:02.064] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:02.064] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:27:02.150] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.912145s!
id: 1

++ echo 'ICMP Echo Conntrack Test [No automatic forward][Transaction mode]'
ICMP Echo Conntrack Test [No automatic forward][Transaction mode]
++ set +e
++ echo '(1) Sending NOT allowed NEW ICMP packet'
(1) Sending NOT allowed NEW ICMP packet
++ sudo ip netns exec ns1 ping -c 2 -i 0.5 10.0.0.2
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:02.193] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:27:02.320] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:02.320] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:02.704] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:02.704] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:02.704] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:02.704] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:02.705] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 511ms

++ [[ 1 == 0 ]]
++ echo '(2) Performing allowed PING'
(2) Performing allowed PING
++ sudo ping -c 2 -i 0.5 10.0.0.1
[2020-12-24 10:27:12.716] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][Action]: receiving packet
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.105 ms
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:27:12.717] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.150 ms
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][Action]: receiving packet

[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 516ms
rtt min/avg/max/mdev = 0.105/0.127/0.150/0.025 ms
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:27:13.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ [[ 0 != 0 ]]
++ echo 'Test PASSED'
Test PASSED
++ exit 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:27:13.239] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_echo_3.sh" time="27.000000" status="Passed"><system-out>[2020-12-24 10:27:15.538] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:27:15.538] [polycubed] [info] configuration parameters: 
[2020-12-24 10:27:15.538] [polycubed] [info]  loglevel: info
[2020-12-24 10:27:15.538] [polycubed] [info]  daemon: false
[2020-12-24 10:27:15.538] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:27:15.538] [polycubed] [info]  port: 9000
[2020-12-24 10:27:15.538] [polycubed] [info]  addr: localhost
[2020-12-24 10:27:15.538] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:27:15.538] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:27:15.538] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:27:15.538] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:27:15.538] [polycubed] [info] polycubed starting...
[2020-12-24 10:27:15.538] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:27:17.727] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:27:17.728] [polycubed] [info] rest server starting ...
[2020-12-24 10:27:17.772] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:27:17.783] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:27:17.797] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:27:17.807] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:27:17.840] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:27:17.850] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:27:17.892] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:27:17.925] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:27:17.959] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:27:18.002] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:27:18.046] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:27:18.069] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:27:18.079] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:27:18.095] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:27:18.104] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:27:18.112] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:27:18.154] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:27:18.201] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:27:18.201] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:27:20.042] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:27:20.042] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:27:25.360] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:25.360] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
[2020-12-24 10:27:25.616] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:25.616] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=NEW action=DROP
[2020-12-24 10:27:25.954] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:27:26.110] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:27.010] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05546s!
[2020-12-24 10:27:27.010] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:27:27.164] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:28.090] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07958s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=NEW action=FORWARD
[2020-12-24 10:27:28.096] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:27:28.252] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:29.153] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05713s!
[2020-12-24 10:27:29.153] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:27:29.308] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:30.219] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06557s!
id: 0

++ echo 'ICMP Echo Conntrack Test [Automatic forward][Transaction mode]'
ICMP Echo Conntrack Test [Automatic forward][Transaction mode]
++ set +e
++ echo '(1) Sending NOT allowed NEW ICMP packet'
(1) Sending NOT allowed NEW ICMP packet
++ sudo ip netns exec ns1 ping -c 2 -i 0.5 10.0.0.2
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:30.267] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:30.768] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:30.769] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:30.769] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:30.769] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:30.769] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:27:33.040] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:33.040] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:33.040] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:33.040] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 501ms

++ [[ 1 == 0 ]]
++ echo '(2) Performing allowed PING'
(2) Performing allowed PING
++ sudo ping -c 2 -i 0.5 10.0.0.1
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.130 ms
[2020-12-24 10:27:40.806] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:27:40.807] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.148 ms

[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:41.328] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 521ms
rtt min/avg/max/mdev = 0.130/0.139/0.148/0.009 ms
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:27:41.329] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ [[ 0 != 0 ]]
++ echo 'Test PASSED'
Test PASSED
++ exit 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:27:41.335] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_echo_4.sh" time="27.000000" status="Passed"><system-out>[2020-12-24 10:27:42.547] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:27:42.548] [polycubed] [info] configuration parameters: 
[2020-12-24 10:27:42.548] [polycubed] [info]  loglevel: info
[2020-12-24 10:27:42.548] [polycubed] [info]  daemon: false
[2020-12-24 10:27:42.548] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:27:42.548] [polycubed] [info]  port: 9000
[2020-12-24 10:27:42.548] [polycubed] [info]  addr: localhost
[2020-12-24 10:27:42.548] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:27:42.548] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:27:42.548] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:27:42.548] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:27:42.548] [polycubed] [info] polycubed starting...
[2020-12-24 10:27:42.548] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:27:44.761] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:27:44.762] [polycubed] [info] rest server starting ...
[2020-12-24 10:27:44.810] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:27:44.821] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:27:44.836] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:27:44.847] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:27:44.881] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:27:44.892] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:27:44.935] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:27:44.968] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:27:45.004] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:27:45.047] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:27:45.092] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:27:45.115] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:27:45.126] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:27:45.142] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:27:45.152] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:27:45.162] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:27:45.204] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:27:45.252] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:27:45.252] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:27:47.081] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:27:47.082] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:27:51.984] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:51.984] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=NEW action=DROP
[2020-12-24 10:27:53.053] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:27:53.208] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:54.118] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.06448s!
[2020-12-24 10:27:54.118] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:27:54.274] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:55.201] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08367s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=NEW action=FORWARD
[2020-12-24 10:27:55.209] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:27:55.365] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:56.270] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06122s!
[2020-12-24 10:27:56.270] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:27:56.424] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:27:57.333] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06324s!
id: 0

++ echo 'ICMP Echo Conntrack Test [Automatic forward][Interactive mode]'
ICMP Echo Conntrack Test [Automatic forward][Interactive mode]
++ set +e
++ echo '(1) Sending NOT allowed NEW ICMP packet'
(1) Sending NOT allowed NEW ICMP packet
++ sudo ip netns exec ns1 ping -c 2 -i 0.5 10.0.0.2
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:57.345] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:27:57.872] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:57.872] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:27:57.872] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:27:57.873] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:27:59.408] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:27:59.408] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:27:59.664] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:27:59.664] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 527ms

++ [[ 1 == 0 ]]
++ echo '(2) Performing allowed PING'
(2) Performing allowed PING
++ sudo ping -c 2 -i 0.5 10.0.0.1
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.126 ms
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:28:07.921] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:28:08.432] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.151 ms
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet

[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 511ms
rtt min/avg/max/mdev = 0.126/0.138/0.151/0.017 ms
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:28:08.433] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ [[ 0 != 0 ]]
++ echo 'Test PASSED'
Test PASSED
++ exit 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:28:08.439] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_error.sh" time="26.000000" status="Failed"><failure type="failure">[2020-12-24 10:28:09.616] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:28:09.617] [polycubed] [info] configuration parameters: 
[2020-12-24 10:28:09.617] [polycubed] [info]  loglevel: info
[2020-12-24 10:28:09.617] [polycubed] [info]  daemon: false
[2020-12-24 10:28:09.617] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:28:09.617] [polycubed] [info]  port: 9000
[2020-12-24 10:28:09.617] [polycubed] [info]  addr: localhost
[2020-12-24 10:28:09.617] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:28:09.617] [polycubed] [info] polycubed starting...
[2020-12-24 10:28:09.617] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:28:11.859] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:28:11.859] [polycubed] [info] rest server starting ...
[2020-12-24 10:28:11.905] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:28:11.916] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:28:11.932] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:28:11.942] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:28:11.977] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:28:11.988] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:28:12.032] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:28:12.066] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:28:12.102] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:28:12.147] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:28:12.193] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:28:12.217] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:28:12.229] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:28:12.245] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:28:12.255] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:28:12.264] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:28:12.308] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:28:12.358] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:28:12.358] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:28:14.135] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:28:14.135] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:19.690] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:19.691] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:19.691] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:19.858] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:19.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:19.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:20.015] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08861s!
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:20.779] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:20.948] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:21.123] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:21.889] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.11021s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:21.896] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:21.896] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:21.896] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:22.064] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:22.221] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:23.136] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24049s!
[2020-12-24 10:28:23.137] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:23.137] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:23.137] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:23.306] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:23.463] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:24.379] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.2425s!
id: 1

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:24.385] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:24.385] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:24.385] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:24.555] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:24.713] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24951s!
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:25.635] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:25.807] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:25.969] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:26.902] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.26712s!
id: 2

++ polycubectl firewall fw chain EGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:26.909] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:26.910] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:26.910] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:27.082] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:27.241] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:28.013] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.10399s!
[2020-12-24 10:28:28.013] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:28.014] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:28.014] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:28.080] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:28.080] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:28.185] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:28.345] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:28.592] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:28.592] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:29.124] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.11014s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:29.130] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:29.130] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:29.131] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:29.302] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:29.461] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25778s!
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:30.389] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:30.559] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:30.717] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:31.647] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25859s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:31.653] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:31.653] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:31.653] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:31.823] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:31.983] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25274s!
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:32.906] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:33.077] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:33.236] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:34.163] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25671s!
id: 2

++ set +x
ICMP Error Conntrack Test [Interactive mode]
(1) Sending UDP packet that will trigger an error response
exec of "nping" failed: No such file or directory
[2020-12-24 10:28:34.214] [Firewall] [fw] [info] [fw] Destroying firewall...
</failure><system-out>[2020-12-24 10:28:09.616] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:28:09.617] [polycubed] [info] configuration parameters: 
[2020-12-24 10:28:09.617] [polycubed] [info]  loglevel: info
[2020-12-24 10:28:09.617] [polycubed] [info]  daemon: false
[2020-12-24 10:28:09.617] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:28:09.617] [polycubed] [info]  port: 9000
[2020-12-24 10:28:09.617] [polycubed] [info]  addr: localhost
[2020-12-24 10:28:09.617] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:28:09.617] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:28:09.617] [polycubed] [info] polycubed starting...
[2020-12-24 10:28:09.617] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:28:11.859] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:28:11.859] [polycubed] [info] rest server starting ...
[2020-12-24 10:28:11.905] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:28:11.916] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:28:11.932] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:28:11.942] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:28:11.977] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:28:11.988] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:28:12.032] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:28:12.066] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:28:12.102] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:28:12.147] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:28:12.193] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:28:12.217] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:28:12.229] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:28:12.245] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:28:12.255] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:28:12.264] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:28:12.308] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:28:12.358] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:28:12.358] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:28:14.135] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:28:14.135] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:19.690] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:19.691] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:19.691] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:19.858] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:19.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:19.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:20.015] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08861s!
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:20.779] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:20.779] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:20.948] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:21.123] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:21.889] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.11021s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:21.896] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:21.896] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:21.896] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:22.064] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:22.221] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:23.136] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24049s!
[2020-12-24 10:28:23.137] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:23.137] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:23.137] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:23.306] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:23.463] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:24.379] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.2425s!
id: 1

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:24.385] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:24.385] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:24.385] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:24.555] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:24.713] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24951s!
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:25.635] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:25.635] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:25.807] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:25.969] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:26.902] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.26712s!
id: 2

++ polycubectl firewall fw chain EGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:26.909] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:26.910] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:26.910] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:27.082] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:27.241] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:28.013] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.10399s!
[2020-12-24 10:28:28.013] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:28.014] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:28.014] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:28.080] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:28.080] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:28.185] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:28.345] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:28.592] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:28.592] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:29.124] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.11014s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:29.130] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:29.130] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:29.131] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:29.302] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:29.461] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25778s!
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:30.388] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:30.389] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:30.559] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:30.717] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:31.647] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25859s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:31.653] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:31.653] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:31.653] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:31.823] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:31.983] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25274s!
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:32.906] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:32.906] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:33.077] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:33.236] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:34.163] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25671s!
id: 2

++ set +x
ICMP Error Conntrack Test [Interactive mode]
(1) Sending UDP packet that will trigger an error response
exec of "nping" failed: No such file or directory
[2020-12-24 10:28:34.214] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_icmp_error_2.sh" time="26.000000" status="Failed"><failure type="failure">[2020-12-24 10:28:35.660] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:28:35.661] [polycubed] [info] configuration parameters: 
[2020-12-24 10:28:35.661] [polycubed] [info]  loglevel: info
[2020-12-24 10:28:35.661] [polycubed] [info]  daemon: false
[2020-12-24 10:28:35.661] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:28:35.661] [polycubed] [info]  port: 9000
[2020-12-24 10:28:35.661] [polycubed] [info]  addr: localhost
[2020-12-24 10:28:35.661] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:28:35.661] [polycubed] [info] polycubed starting...
[2020-12-24 10:28:35.661] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:28:37.875] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:28:37.875] [polycubed] [info] rest server starting ...
[2020-12-24 10:28:37.920] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:28:37.931] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:28:37.946] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:28:37.956] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:28:37.989] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:28:38.000] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:28:38.042] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:28:38.075] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:28:38.110] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:28:38.153] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:28:38.198] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:28:38.221] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:28:38.232] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:28:38.248] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:28:38.258] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:28:38.267] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:28:38.310] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:28:38.358] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:28:38.358] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:28:40.175] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:28:40.176] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:28:45.488] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:45.488] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw chain INGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:45.863] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:45.863] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:45.863] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:46.032] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:46.189] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:46.256] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:46.256] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:46.954] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09126s!
[2020-12-24 10:28:46.955] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:46.955] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:46.955] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:47.124] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:47.300] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:48.064] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.10922s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:48.071] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:48.071] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:48.071] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:48.240] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:48.399] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24849s!
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:49.319] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:49.489] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:49.648] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:50.565] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24547s!
id: 1

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:50.571] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:50.572] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:50.572] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:50.741] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:50.898] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24029s!
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:51.812] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:51.982] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:52.140] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:53.056] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24362s!
id: 2

++ polycubectl firewall fw chain EGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:53.062] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:53.062] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:53.062] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:53.229] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:53.385] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:53.680] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:53.680] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0803s!
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:54.143] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:54.312] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:54.469] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:55.234] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0914s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:55.241] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:55.241] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:55.242] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:55.413] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:55.472] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:55.472] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:55.571] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.24986s!
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:56.492] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:56.661] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:56.818] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:57.735] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.24399s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:57.743] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:57.743] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:57.743] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:57.913] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:58.073] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:59.003] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.26042s!
[2020-12-24 10:28:59.004] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:59.004] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:59.004] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:59.175] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:59.332] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:00.257] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25317s!
id: 2

++ set +x
ICMP Error Conntrack Test [Transaction mode]
(1) Sending UDP packet that will trigger an error response
exec of "nping" failed: No such file or directory
[2020-12-24 10:29:00.309] [Firewall] [fw] [info] [fw] Destroying firewall...
</failure><system-out>[2020-12-24 10:28:35.660] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:28:35.661] [polycubed] [info] configuration parameters: 
[2020-12-24 10:28:35.661] [polycubed] [info]  loglevel: info
[2020-12-24 10:28:35.661] [polycubed] [info]  daemon: false
[2020-12-24 10:28:35.661] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:28:35.661] [polycubed] [info]  port: 9000
[2020-12-24 10:28:35.661] [polycubed] [info]  addr: localhost
[2020-12-24 10:28:35.661] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:28:35.661] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:28:35.661] [polycubed] [info] polycubed starting...
[2020-12-24 10:28:35.661] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:28:37.875] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:28:37.875] [polycubed] [info] rest server starting ...
[2020-12-24 10:28:37.920] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:28:37.931] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:28:37.946] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:28:37.956] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:28:37.989] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:28:38.000] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:28:38.042] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:28:38.075] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:28:38.110] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:28:38.153] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:28:38.198] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:28:38.221] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:28:38.232] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:28:38.248] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:28:38.258] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:28:38.267] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:28:38.310] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:28:38.358] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:28:38.358] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:28:40.175] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:28:40.176] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:28:45.488] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:45.488] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw chain INGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:45.863] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:45.863] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:45.863] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:46.032] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:46.189] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:46.256] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:46.256] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:46.954] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09126s!
[2020-12-24 10:28:46.955] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:28:46.955] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:46.955] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:47.124] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:47.300] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:48.064] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.10922s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:48.071] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:48.071] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:48.071] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:48.240] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:48.399] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24849s!
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:28:49.319] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:49.319] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:49.489] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:49.648] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:50.565] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24547s!
id: 1

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:50.571] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:50.572] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:50.572] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:50.741] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:50.898] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24029s!
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:28:51.812] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:51.812] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:51.982] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:52.140] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:53.056] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.24362s!
id: 2

++ polycubectl firewall fw chain EGRESS append l4proto=UDP action=FORWARD
[2020-12-24 10:28:53.062] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:53.062] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:53.062] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:53.229] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:53.385] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:53.680] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:28:53.680] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0803s!
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:28:54.142] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:54.143] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:54.312] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:54.469] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:55.234] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0914s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP conntrack=RELATED action=FORWARD
[2020-12-24 10:28:55.241] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:55.241] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:55.242] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:55.413] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:55.472] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:28:55.472] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:28:55.571] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.24986s!
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:28:56.491] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:56.492] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:56.661] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:56.818] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:57.735] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.24399s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=DROP
[2020-12-24 10:28:57.743] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:57.743] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:57.743] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:57.913] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:58.073] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:28:59.003] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.26042s!
[2020-12-24 10:28:59.004] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:28:59.004] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:28:59.004] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:28:59.175] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:28:59.332] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:00.257] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.25317s!
id: 2

++ set +x
ICMP Error Conntrack Test [Transaction mode]
(1) Sending UDP packet that will trigger an error response
exec of "nping" failed: No such file or directory
[2020-12-24 10:29:00.309] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_complete_1.sh" time="28.000000" status="Passed"><system-out>[2020-12-24 10:29:01.822] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:29:01.822] [polycubed] [info] configuration parameters: 
[2020-12-24 10:29:01.822] [polycubed] [info]  loglevel: info
[2020-12-24 10:29:01.822] [polycubed] [info]  daemon: false
[2020-12-24 10:29:01.822] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:29:01.822] [polycubed] [info]  port: 9000
[2020-12-24 10:29:01.822] [polycubed] [info]  addr: localhost
[2020-12-24 10:29:01.822] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:29:01.822] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:29:01.822] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:29:01.822] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:29:01.822] [polycubed] [info] polycubed starting...
[2020-12-24 10:29:01.822] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:29:04.041] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:29:04.042] [polycubed] [info] rest server starting ...
[2020-12-24 10:29:04.089] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:29:04.100] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:29:04.115] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:29:04.125] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:29:04.159] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:29:04.170] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:29:04.212] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:29:04.246] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:29:04.281] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:29:04.324] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:29:04.368] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:29:04.391] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:29:04.402] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:29:04.418] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:29:04.427] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:29:04.437] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:29:04.479] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:29:04.526] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:29:04.526] [polycubed] [info] loading metrics from yang files
TCP Conntrack Test (ns2-&gt;ns1) [No automatic forward][Interactive mode]
[2020-12-24 10:29:06.331] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:29:06.331] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:29:11.600] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:11.600] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:11.899] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:29:12.057] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:12.982] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08326s!
[2020-12-24 10:29:12.982] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:29:13.142] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:14.081] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09808s!
[2020-12-24 10:29:14.087] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:29:14.247] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:15.163] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07581s!
[2020-12-24 10:29:15.163] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:29:15.322] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:16.248] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08483s!
[2020-12-24 10:29:16.255] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:29:16.415] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:17.339] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08429s!
[2020-12-24 10:29:17.339] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:29:17.497] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:18.425] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0853s!
[2020-12-24 10:29:18.432] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:29:18.602] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:19.024] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:19.024] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:19.535] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.10278s!
[2020-12-24 10:29:19.535] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:29:19.536] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:19.536] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:29:19.695] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:20.628] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09316s!
[2020-12-24 10:29:20.634] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:29:20.797] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:21.725] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09084s!
[2020-12-24 10:29:21.725] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:29:21.887] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:22.822] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09632s!
Starting netcat server
Starting netcat client
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 2
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3971567773, AckN: 0. ConnStatus: 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
Connection to 10.0.0.1 60123 port [tcp/*] succeeded!
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:29:25.833] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 12
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1516728240, AckN: 3988344989. ConnStatus: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3988344989, AckN: 1533505456. ConnStatus: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3988344989, AckN: 1533505456. ConnStatus: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1533505456, AckN: 4005122205. ConnStatus: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:29:25.834] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 4005122205, AckN: 1550282672. ConnStatus: 1
(1) Checking that netcat client performed the connection.
(2) Checking that netcat server has been gracefully closed.
Test PASSED
[2020-12-24 10:29:27.843] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_complete_2.sh" time="29.000000" status="Passed"><system-out>[2020-12-24 10:29:29.884] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:29:29.885] [polycubed] [info] configuration parameters: 
[2020-12-24 10:29:29.885] [polycubed] [info]  loglevel: info
[2020-12-24 10:29:29.885] [polycubed] [info]  daemon: false
[2020-12-24 10:29:29.885] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:29:29.885] [polycubed] [info]  port: 9000
[2020-12-24 10:29:29.885] [polycubed] [info]  addr: localhost
[2020-12-24 10:29:29.885] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:29:29.885] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:29:29.885] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:29:29.885] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:29:29.885] [polycubed] [info] polycubed starting...
[2020-12-24 10:29:29.885] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:29:32.140] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:29:32.140] [polycubed] [info] rest server starting ...
[2020-12-24 10:29:32.189] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:29:32.201] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:29:32.216] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:29:32.227] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:29:32.262] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:29:32.273] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:29:32.317] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:29:32.351] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:29:32.387] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:29:32.432] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:29:32.477] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:29:32.501] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:29:32.512] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:29:32.529] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:29:32.538] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:29:32.548] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:29:32.591] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:29:32.640] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:29:32.640] [polycubed] [info] loading metrics from yang files
TCP Conntrack Test (ns1-&gt;ns2) [No automatic forward][Interactive mode]
[2020-12-24 10:29:34.457] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:29:34.457] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:29:39.760] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:39.760] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:40.339] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:29:40.513] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:41.430] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0905s!
[2020-12-24 10:29:41.430] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:29:41.594] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:42.540] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.10989s!
[2020-12-24 10:29:42.547] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:29:42.712] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:43.632] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08496s!
[2020-12-24 10:29:43.632] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:29:43.798] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:44.723] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09164s!
[2020-12-24 10:29:44.731] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:29:44.895] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:45.816] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08491s!
[2020-12-24 10:29:45.816] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:29:45.981] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:46.904] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08822s!
[2020-12-24 10:29:46.914] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:29:47.089] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:47.440] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:47.440] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:47.696] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:47.696] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:29:48.007] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09389s!
[2020-12-24 10:29:48.008] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:29:48.173] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:49.096] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08832s!
[2020-12-24 10:29:49.102] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:29:49.268] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:50.187] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08452s!
[2020-12-24 10:29:50.187] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:29:50.354] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:29:51.283] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09662s!
Starting netcat server
Starting netcat client
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55188 dPort: 60123 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 2
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2876779296, AckN: 0. ConnStatus: 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
Connection to 10.0.0.2 60123 port [tcp/*] succeeded!
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [egress] [Parser] sPort: 60123 dPort: 55188 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 12
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3772373403, AckN: 2893556512. ConnStatus: 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from SYN_SENT to SYN_RECV
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55188 dPort: 60123 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2893556512, AckN: 3789150619. ConnStatus: 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from SYN_RECV to ESTABLISHED
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55188 dPort: 60123 
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2893556512, AckN: 3789150619. ConnStatus: 1
[2020-12-24 10:29:54.297] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from ESTABLISHED to FIN_WAIT_1. Seq: 3789150619
[2020-12-24 10:29:54.297] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [egress] [Parser] sPort: 60123 dPort: 55188 
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3789150619, AckN: 2910333728. ConnStatus: 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from FIN_WAIT_1 to FIN_WAIT_2
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from FIN_WAIT_1 to LAST_ACK
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55188 dPort: 60123 
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:29:54.298] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2910333728, AckN: 3805927835. ConnStatus: 1
[2020-12-24 10:29:54.298] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from LAST_ACK to TIME_WAIT
(1) Checking that netcat client performed the connection.
(2) Checking that netcat server has been gracefully closed.
Test PASSED
[2020-12-24 10:29:56.308] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_complete_3.sh" time="29.000000" status="Passed"><system-out>[2020-12-24 10:29:58.045] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:29:58.045] [polycubed] [info] configuration parameters: 
[2020-12-24 10:29:58.045] [polycubed] [info]  loglevel: info
[2020-12-24 10:29:58.045] [polycubed] [info]  daemon: false
[2020-12-24 10:29:58.045] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:29:58.045] [polycubed] [info]  port: 9000
[2020-12-24 10:29:58.045] [polycubed] [info]  addr: localhost
[2020-12-24 10:29:58.045] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:29:58.045] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:29:58.045] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:29:58.045] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:29:58.045] [polycubed] [info] polycubed starting...
[2020-12-24 10:29:58.045] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:30:00.295] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:30:00.295] [polycubed] [info] rest server starting ...
[2020-12-24 10:30:00.341] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:30:00.353] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:30:00.369] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:30:00.380] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:30:00.415] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:30:00.426] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:30:00.470] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:30:00.505] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:30:00.541] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:30:00.586] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:30:00.632] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:30:00.656] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:30:00.667] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:30:00.684] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:30:00.694] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:30:00.704] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:30:00.748] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:30:00.797] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:30:00.797] [polycubed] [info] loading metrics from yang files
TCP Conntrack Test (ns2-&gt;ns1) [Automatic forward][Interactive mode]
[2020-12-24 10:30:02.604] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:30:02.604] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:30:07.664] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:07.664] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:08.870] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:30:09.036] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:09.960] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09008s!
[2020-12-24 10:30:09.960] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:30:10.126] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:11.070] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.10995s!
[2020-12-24 10:30:11.076] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:30:11.250] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:12.164] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08772s!
[2020-12-24 10:30:12.164] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:30:12.330] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:13.242] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07818s!
[2020-12-24 10:30:13.250] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:30:13.415] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:14.323] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07376s!
[2020-12-24 10:30:14.324] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:30:14.486] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:15.401] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07751s!
[2020-12-24 10:30:15.408] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:30:15.573] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:15.600] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:15.600] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:30:16.485] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07664s!
[2020-12-24 10:30:16.485] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:30:16.624] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:16.624] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:16.651] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:17.570] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08568s!
[2020-12-24 10:30:17.578] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:30:17.744] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:18.662] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08446s!
[2020-12-24 10:30:18.662] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:30:18.828] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:19.753] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09056s!
Starting netcat server
Starting netcat client
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] sPort: 39810 dPort: 60123 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Action]: receiving packet
Connection to 10.0.0.1 60123 port [tcp/*] succeeded!
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 2
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 867886266, AckN: 0. ConnStatus: 0
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 39810 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 12
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2435015652, AckN: 884663482. ConnStatus: 1
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from SYN_SENT to SYN_RECV
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] sPort: 39810 dPort: 60123 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 884663482, AckN: 2451792868. ConnStatus: 1
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from SYN_RECV to ESTABLISHED
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] sPort: 39810 dPort: 60123 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 884663482, AckN: 2451792868. ConnStatus: 1
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from ESTABLISHED to FIN_WAIT_1. Seq: 2451792868
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 39810 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2451792868, AckN: 901440698. ConnStatus: 1
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to FIN_WAIT_2
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to LAST_ACK
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] sPort: 39810 dPort: 60123 
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:30:22.765] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 901440698, AckN: 2468570084. ConnStatus: 1
[2020-12-24 10:30:22.765] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from LAST_ACK to TIME_WAIT
(1) Checking that netcat client performed the connection.
(2) Checking that netcat server has been gracefully closed.
Test PASSED
[2020-12-24 10:30:24.775] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_complete_4.sh" time="29.000000" status="Passed"><system-out>[2020-12-24 10:30:27.204] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:30:27.204] [polycubed] [info] configuration parameters: 
[2020-12-24 10:30:27.204] [polycubed] [info]  loglevel: info
[2020-12-24 10:30:27.205] [polycubed] [info]  daemon: false
[2020-12-24 10:30:27.205] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:30:27.205] [polycubed] [info]  port: 9000
[2020-12-24 10:30:27.205] [polycubed] [info]  addr: localhost
[2020-12-24 10:30:27.205] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:30:27.205] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:30:27.205] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:30:27.205] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:30:27.205] [polycubed] [info] polycubed starting...
[2020-12-24 10:30:27.205] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:30:29.416] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:30:29.416] [polycubed] [info] rest server starting ...
[2020-12-24 10:30:29.460] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:30:29.471] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:30:29.486] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:30:29.496] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:30:29.529] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:30:29.540] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:30:29.583] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:30:29.616] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:30:29.650] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:30:29.693] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:30:29.738] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:30:29.760] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:30:29.772] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:30:29.788] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:30:29.797] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:30:29.806] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:30:29.848] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:30:29.896] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:30:29.896] [polycubed] [info] loading metrics from yang files
TCP Conntrack Test (ns1-&gt;ns2) [Automatic forward][Interactive mode]
[2020-12-24 10:30:31.753] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:30:31.753] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:30:37.105] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:37.105] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:37.986] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:30:38.149] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:39.067] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08073s!
[2020-12-24 10:30:39.067] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:30:39.231] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:40.173] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.10594s!
[2020-12-24 10:30:40.180] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:30:40.345] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:41.268] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08859s!
[2020-12-24 10:30:41.268] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:30:41.434] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:42.351] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08292s!
[2020-12-24 10:30:42.359] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:30:42.523] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:43.438] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07941s!
[2020-12-24 10:30:43.438] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:30:43.603] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:44.272] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:44.272] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:44.526] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08797s!
[2020-12-24 10:30:44.533] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:30:44.699] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:45.296] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:45.296] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:30:45.616] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08326s!
[2020-12-24 10:30:45.616] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:30:45.782] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:46.708] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09158s!
[2020-12-24 10:30:46.715] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:30:46.883] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:47.808] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.09278s!
[2020-12-24 10:30:47.808] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:30:47.976] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:false portstc:true portdst:true flags_map:false 
[2020-12-24 10:30:48.901] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0923s!
Starting netcat server
Starting netcat client
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55392 dPort: 60123 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
Connection to 10.0.0.2 60123 port [tcp/*] succeeded!
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 2
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3878248911, AckN: 0. ConnStatus: 0
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [egress] [Parser] sPort: 60123 dPort: 55392 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 12
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2606839503, AckN: 3895026127. ConnStatus: 1
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from SYN_SENT to SYN_RECV
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55392 dPort: 60123 
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3895026127, AckN: 2623616719. ConnStatus: 1
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from SYN_RECV to ESTABLISHED
[2020-12-24 10:30:51.914] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:51.914] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55392 dPort: 60123 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3895026127, AckN: 2623616719. ConnStatus: 1
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from ESTABLISHED to FIN_WAIT_1. Seq: 2623616719
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [egress] [Parser] sPort: 60123 dPort: 55392 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2623616719, AckN: 3911803343. ConnStatus: 1
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from FIN_WAIT_1 to FIN_WAIT_2
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVegress] Changing state from FIN_WAIT_1 to LAST_ACK
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 55392 dPort: 60123 
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:30:51.915] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3911803343, AckN: 2640393935. ConnStatus: 1
[2020-12-24 10:30:51.915] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWingress] Changing state from LAST_ACK to TIME_WAIT
(1) Checking that netcat client performed the connection.
(2) Checking that netcat server has been gracefully closed.
Test PASSED
[2020-12-24 10:30:53.924] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_handshake_1.sh" time="26.000000" status="Passed"><system-out>[2020-12-24 10:30:56.351] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:30:56.351] [polycubed] [info] configuration parameters: 
[2020-12-24 10:30:56.351] [polycubed] [info]  loglevel: info
[2020-12-24 10:30:56.351] [polycubed] [info]  daemon: false
[2020-12-24 10:30:56.351] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:30:56.351] [polycubed] [info]  port: 9000
[2020-12-24 10:30:56.351] [polycubed] [info]  addr: localhost
[2020-12-24 10:30:56.351] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:30:56.351] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:30:56.351] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:30:56.351] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:30:56.351] [polycubed] [info] polycubed starting...
[2020-12-24 10:30:56.351] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:30:58.580] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:30:58.580] [polycubed] [info] rest server starting ...
[2020-12-24 10:30:58.625] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:30:58.636] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:30:58.650] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:30:58.661] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:30:58.694] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:30:58.705] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:30:58.749] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:30:58.782] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:30:58.818] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:30:58.862] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:30:58.908] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:30:58.931] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:30:58.943] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:30:58.959] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:30:58.968] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:30:58.978] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:30:59.021] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:30:59.071] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:30:59.071] [polycubed] [info] loading metrics from yang files
TCP Initial handshake Conntrack Test [No automatic forward][Interactive mode]
[2020-12-24 10:31:00.906] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:31:00.906] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:31:06.288] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:06.288] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:06.735] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:06.899] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:07.818] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0836s!
[2020-12-24 10:31:07.819] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:07.982] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:08.920] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.10171s!
[2020-12-24 10:31:08.927] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:09.094] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:10.011] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08437s!
[2020-12-24 10:31:10.011] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:10.178] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:11.100] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08849s!
[2020-12-24 10:31:11.106] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:31:11.271] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:12.189] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08264s!
[2020-12-24 10:31:12.189] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:31:12.353] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:13.277] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08799s!
[2020-12-24 10:31:13.284] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:31:13.451] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:13.712] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:13.712] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:31:14.369] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0844s!
[2020-12-24 10:31:14.369] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:31:14.535] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:14.992] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:14.992] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:15.459] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09039s!
[2020-12-24 10:31:15.466] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:31:15.630] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:16.547] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0807s!
[2020-12-24 10:31:16.547] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:31:16.713] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:17.641] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09424s!
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:20.653] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40012 dPort: 60123 
[2020-12-24 10:31:20.653] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:31:20.653] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1331679751, AckN: 0. ConnStatus: 0
Connection to 10.0.0.1 60123 port [tcp/*] succeeded!
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 40012 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 12
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 449733376, AckN: 1348456967. ConnStatus: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from SYN_SENT to SYN_RECV
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40012 dPort: 60123 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1348456967, AckN: 466510592. ConnStatus: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from SYN_RECV to ESTABLISHED
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40012 dPort: 60123 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1348456967, AckN: 466510592. ConnStatus: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from ESTABLISHED to FIN_WAIT_1. Seq: 466510592
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 40012 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 466510592, AckN: 1365234183. ConnStatus: 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to FIN_WAIT_2
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to LAST_ACK
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40012 dPort: 60123 
[2020-12-24 10:31:20.654] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 1
[2020-12-24 10:31:20.654] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:31:20.655] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 1
[2020-12-24 10:31:20.655] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:31:20.655] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:20.655] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:31:20.655] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1365234183, AckN: 483287808. ConnStatus: 1
[2020-12-24 10:31:20.655] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from LAST_ACK to TIME_WAIT
Test PASSED
[2020-12-24 10:31:20.660] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_tcp_handshake_2.sh" time="23.000000" status="Passed"><system-out>[2020-12-24 10:31:22.496] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:31:22.497] [polycubed] [info] configuration parameters: 
[2020-12-24 10:31:22.497] [polycubed] [info]  loglevel: info
[2020-12-24 10:31:22.497] [polycubed] [info]  daemon: false
[2020-12-24 10:31:22.497] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:31:22.497] [polycubed] [info]  port: 9000
[2020-12-24 10:31:22.497] [polycubed] [info]  addr: localhost
[2020-12-24 10:31:22.497] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:31:22.497] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:31:22.497] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:31:22.497] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:31:22.497] [polycubed] [info] polycubed starting...
[2020-12-24 10:31:22.497] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:31:24.720] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:31:24.721] [polycubed] [info] rest server starting ...
[2020-12-24 10:31:24.764] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:31:24.775] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:31:24.790] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:31:24.800] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:31:24.833] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:31:24.844] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:31:24.887] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:31:24.920] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:31:24.956] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:31:24.999] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:31:25.044] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:31:25.067] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:31:25.079] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:31:25.094] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:31:25.104] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:31:25.113] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:31:25.155] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:31:25.204] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:31:25.204] [polycubed] [info] loading metrics from yang files
TCP Initial handshake Conntrack Test [Automatic forward][Interactive mode]
[2020-12-24 10:31:27.010] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:31:27.010] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:31:32.400] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:32.400] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:33.249] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:33.249] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:31:33.249] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:31:33.414] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:31:33.578] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:34.337] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.08775s!
[2020-12-24 10:31:34.337] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:34.337] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:31:34.337] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:31:34.502] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:31:34.682] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:35.441] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.1037s!
[2020-12-24 10:31:35.448] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:31:35.611] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:36.520] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07148s!
[2020-12-24 10:31:36.520] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:31:36.682] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:37.594] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.07364s!
[2020-12-24 10:31:37.600] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:31:37.778] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:38.690] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.09053s!
[2020-12-24 10:31:38.690] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:31:38.855] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:39.774] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.08374s!
[2020-12-24 10:31:39.824] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:39.824] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:41.360] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:41.360] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40098 dPort: 60123 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CHAINFORWARDER 2
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackMatch]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackMatch]: received a packet with state 0
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Action]: receiving packet
Connection to 10.0.0.1 60123 port [tcp/*] succeeded!
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 0
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 2
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1744088607, AckN: 0. ConnStatus: 0
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 40098 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [ingress] [Parser] Call HORUS 5 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 12
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2360317678, AckN: 1760865823. ConnStatus: 1
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from SYN_SENT to SYN_RECV
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40098 dPort: 60123 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1760865823, AckN: 2377094894. ConnStatus: 1
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from SYN_RECV to ESTABLISHED
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40098 dPort: 60123 
[2020-12-24 10:31:42.787] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.787] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1760865823, AckN: 2377094894. ConnStatus: 1
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from ESTABLISHED to FIN_WAIT_1. Seq: 2377094894
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x6 
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 60123 dPort: 40098 
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ingress] [Parser] Call HORUS 5 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 2377094894, AckN: 1777643039. ConnStatus: 1
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to FIN_WAIT_2
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ConntrackTableUpdate] [REVingress] Changing state from FIN_WAIT_1 to LAST_ACK
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x6 
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [egress] [Parser] sPort: 40098 dPort: 60123 
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Conntrack mode == 2 ESTABLISHED calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 10
[2020-12-24 10:31:42.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 1777643039, AckN: 2393872110. ConnStatus: 1
[2020-12-24 10:31:42.788] [Firewall] [fw] [trace] [ConntrackTableUpdate] [FWegress] Changing state from LAST_ACK to TIME_WAIT
Test PASSED
[2020-12-24 10:31:42.792] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_udp.sh" time="23.000000" status="Failed"><failure type="failure">[2020-12-24 10:31:45.602] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:31:45.603] [polycubed] [info] configuration parameters: 
[2020-12-24 10:31:45.603] [polycubed] [info]  loglevel: info
[2020-12-24 10:31:45.603] [polycubed] [info]  daemon: false
[2020-12-24 10:31:45.603] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:31:45.603] [polycubed] [info]  port: 9000
[2020-12-24 10:31:45.603] [polycubed] [info]  addr: localhost
[2020-12-24 10:31:45.603] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:31:45.603] [polycubed] [info] polycubed starting...
[2020-12-24 10:31:45.603] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:31:47.795] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:31:47.796] [polycubed] [info] rest server starting ...
[2020-12-24 10:31:47.840] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:31:47.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:31:47.865] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:31:47.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:31:47.907] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:31:47.918] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:31:47.960] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:31:47.992] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:31:48.026] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:31:48.069] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:31:48.113] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:31:48.135] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:31:48.145] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:31:48.161] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:31:48.169] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:31:48.178] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:31:48.220] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:31:48.267] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:31:48.267] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:31:50.117] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:31:50.117] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:31:55.572] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:55.696] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:55.696] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:55.727] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:56.622] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.04941s!
[2020-12-24 10:31:56.622] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:56.775] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:57.691] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.06933s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:31:57.698] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:57.854] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:58.749] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05068s!
[2020-12-24 10:31:58.749] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:58.905] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:59.806] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0573s!
id: 1

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:31:59.948] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:31:59.954] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:00.108] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:01.004] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05048s!
[2020-12-24 10:32:01.005] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:01.158] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:02.059] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0547s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:02.066] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:02.222] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:03.117] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05087s!
[2020-12-24 10:32:03.117] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:03.120] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:03.120] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:03.272] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:03.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:03.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:32:04.173] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05568s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:04.180] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:04.336] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:05.232] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05207s!
[2020-12-24 10:32:05.232] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:05.387] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:06.289] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05677s!
id: 2

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:32:06.433] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [No automatic forward][Interactive mode]'
UDP Conntrack Test [No automatic forward][Interactive mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:32:06.477] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</failure><system-out>[2020-12-24 10:31:45.602] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:31:45.603] [polycubed] [info] configuration parameters: 
[2020-12-24 10:31:45.603] [polycubed] [info]  loglevel: info
[2020-12-24 10:31:45.603] [polycubed] [info]  daemon: false
[2020-12-24 10:31:45.603] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:31:45.603] [polycubed] [info]  port: 9000
[2020-12-24 10:31:45.603] [polycubed] [info]  addr: localhost
[2020-12-24 10:31:45.603] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:31:45.603] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:31:45.603] [polycubed] [info] polycubed starting...
[2020-12-24 10:31:45.603] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:31:47.795] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:31:47.796] [polycubed] [info] rest server starting ...
[2020-12-24 10:31:47.840] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:31:47.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:31:47.865] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:31:47.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:31:47.907] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:31:47.918] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:31:47.960] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:31:47.992] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:31:48.026] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:31:48.069] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:31:48.113] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:31:48.135] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:31:48.145] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:31:48.161] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:31:48.169] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:31:48.178] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:31:48.220] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:31:48.267] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:31:48.267] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:31:50.117] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:31:50.117] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:31:55.572] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:55.696] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:31:55.696] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:31:55.727] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:56.622] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.04941s!
[2020-12-24 10:31:56.622] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:31:56.775] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:57.691] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.06933s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:31:57.698] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:57.854] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:58.749] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05068s!
[2020-12-24 10:31:58.749] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:31:58.905] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:31:59.806] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0573s!
id: 1

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:31:59.948] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:31:59.954] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:00.108] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:01.004] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05048s!
[2020-12-24 10:32:01.005] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:01.158] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:02.059] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.0547s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:02.066] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:02.222] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:03.117] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05087s!
[2020-12-24 10:32:03.117] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:03.120] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:03.120] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:03.272] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:03.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:03.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:32:04.173] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05568s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:04.180] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:04.336] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:05.232] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05207s!
[2020-12-24 10:32:05.232] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:05.387] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:06.289] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05677s!
id: 2

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:32:06.433] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [No automatic forward][Interactive mode]'
UDP Conntrack Test [No automatic forward][Interactive mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:32:06.477] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_udp_2.sh" time="23.000000" status="Failed"><failure type="failure">[2020-12-24 10:32:08.596] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:08.597] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:08.597] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:08.597] [polycubed] [info]  daemon: false
[2020-12-24 10:32:08.597] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:08.597] [polycubed] [info]  port: 9000
[2020-12-24 10:32:08.597] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:08.597] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:08.597] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:08.597] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:10.794] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:10.794] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:10.840] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:10.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:10.865] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:10.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:10.908] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:10.919] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:10.962] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:10.995] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:11.030] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:11.074] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:11.119] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:11.142] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:11.152] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:11.167] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:11.176] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:11.184] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:11.226] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:11.275] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:11.275] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:13.100] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:13.100] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:32:17.968] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:17.968] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:18.580] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:18.735] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:18.736] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:18.736] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:19.637] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05765s!
[2020-12-24 10:32:19.638] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:19.792] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:20.713] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07498s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:20.720] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:32:20.876] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:21.777] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05688s!
[2020-12-24 10:32:21.777] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:32:21.933] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:22.837] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.06025s!
id: 1

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:32:22.981] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:32:22.988] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:23.143] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:24.044] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05554s!
[2020-12-24 10:32:24.044] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:24.199] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:25.102] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05801s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:25.109] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:25.264] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:26.167] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05746s!
[2020-12-24 10:32:26.167] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:26.322] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:26.416] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:26.416] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:32:27.231] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06383s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:27.237] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:27.394] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:27.440] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:27.440] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:28.297] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05936s!
[2020-12-24 10:32:28.297] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:28.453] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:29.360] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06317s!
id: 2

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:32:29.504] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [No automatic forward][Transaction mode]'
UDP Conntrack Test [No automatic forward][Transaction mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:32:29.555] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</failure><system-out>[2020-12-24 10:32:08.596] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:08.597] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:08.597] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:08.597] [polycubed] [info]  daemon: false
[2020-12-24 10:32:08.597] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:08.597] [polycubed] [info]  port: 9000
[2020-12-24 10:32:08.597] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:08.597] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:08.597] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:08.597] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:08.597] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:10.794] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:10.794] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:10.840] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:10.851] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:10.865] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:10.875] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:10.908] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:10.919] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:10.962] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:10.995] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:11.030] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:11.074] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:11.119] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:11.142] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:11.152] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:11.167] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:11.176] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:11.184] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:11.226] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:11.275] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:11.275] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:13.100] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:13.100] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:32:17.968] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:17.968] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=OFF
++ polycubectl firewall fw chain INGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:18.580] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:18.735] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:18.736] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:18.736] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:19.637] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05765s!
[2020-12-24 10:32:19.638] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:19.792] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:20.713] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07498s!
id: 0

++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:20.720] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:32:20.876] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:21.777] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05688s!
[2020-12-24 10:32:21.777] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:32:21.933] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:22.837] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.06025s!
id: 1

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:32:22.981] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:32:22.988] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:23.143] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:24.044] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05554s!
[2020-12-24 10:32:24.044] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:24.199] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:25.102] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05801s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=ESTABLISHED action=FORWARD
[2020-12-24 10:32:25.109] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:25.264] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:26.167] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05746s!
[2020-12-24 10:32:26.167] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:26.322] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:26.416] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:26.416] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:32:27.231] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06383s!
id: 1

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:32:27.237] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:27.394] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:27.440] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:32:27.440] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:32:28.297] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05936s!
[2020-12-24 10:32:28.297] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:32:28.453] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:29.360] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.06317s!
id: 2

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:32:29.504] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [No automatic forward][Transaction mode]'
UDP Conntrack Test [No automatic forward][Transaction mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:32:29.555] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_udp_3.sh" time="19.000000" status="Failed"><failure type="failure">[2020-12-24 10:32:31.595] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:31.596] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:31.596] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:31.596] [polycubed] [info]  daemon: false
[2020-12-24 10:32:31.596] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:31.596] [polycubed] [info]  port: 9000
[2020-12-24 10:32:31.596] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:31.596] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:31.596] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:31.596] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:33.767] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:33.768] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:33.811] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:33.822] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:33.835] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:33.844] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:33.876] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:33.886] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:33.927] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:33.959] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:33.993] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:34.035] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:34.078] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:34.101] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:34.111] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:34.126] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:34.134] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:34.143] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:34.184] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:34.231] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:34.231] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:36.111] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:36.111] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:32:41.520] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:41.520] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
++ set +x
[2020-12-24 10:32:41.951] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:41.951] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:32:41.951] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:32:42.115] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:32:42.267] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05859s!
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:32:43.010] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:32:43.173] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:32:43.340] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:44.085] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07514s!
id: 0

[2020-12-24 10:32:44.230] [Firewall] [fw] [debug] [fw] Default action set. 
[2020-12-24 10:32:44.236] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:44.390] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:45.285] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04809s!
[2020-12-24 10:32:45.285] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:45.438] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:46.334] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04938s!
id: 0

[2020-12-24 10:32:46.341] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:46.494] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:47.388] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04777s!
[2020-12-24 10:32:47.389] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:47.544] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:48.446] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05753s!
id: 1

[2020-12-24 10:32:48.592] [Firewall] [fw] [debug] [fw] Default action set. 
UDP Conntrack Test [Automatic forward][Transaction mode]
(1) Sending NOT allowed NEW UDP packet
exec of "nping" failed: No such file or directory
[2020-12-24 10:32:48.643] [Firewall] [fw] [info] [fw] Destroying firewall...
</failure><system-out>[2020-12-24 10:32:31.595] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:31.596] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:31.596] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:31.596] [polycubed] [info]  daemon: false
[2020-12-24 10:32:31.596] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:31.596] [polycubed] [info]  port: 9000
[2020-12-24 10:32:31.596] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:31.596] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:31.596] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:31.596] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:31.596] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:33.767] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:33.768] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:33.811] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:33.822] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:33.835] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:33.844] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:33.876] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:33.886] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:33.927] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:33.959] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:33.993] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:34.035] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:34.078] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:34.101] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:34.111] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:34.126] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:34.134] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:34.143] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:34.184] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:34.231] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:34.231] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:36.111] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:36.111] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:32:41.520] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:32:41.520] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
++ set +x
[2020-12-24 10:32:41.951] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:41.951] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:32:41.951] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:32:42.115] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:32:42.267] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.05859s!
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:32:43.010] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:32:43.010] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:32:43.173] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:32:43.340] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:44.085] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07514s!
id: 0

[2020-12-24 10:32:44.230] [Firewall] [fw] [debug] [fw] Default action set. 
[2020-12-24 10:32:44.236] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:44.390] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:45.285] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04809s!
[2020-12-24 10:32:45.285] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:32:45.438] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:46.334] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04938s!
id: 0

[2020-12-24 10:32:46.341] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:46.494] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:47.388] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04777s!
[2020-12-24 10:32:47.389] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:32:47.544] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:32:48.446] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05753s!
id: 1

[2020-12-24 10:32:48.592] [Firewall] [fw] [debug] [fw] Default action set. 
UDP Conntrack Test [Automatic forward][Transaction mode]
(1) Sending NOT allowed NEW UDP packet
exec of "nping" failed: No such file or directory
[2020-12-24 10:32:48.643] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/conntrack/test_udp_4.sh" time="19.000000" status="Failed"><failure type="failure">[2020-12-24 10:32:50.599] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:50.600] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:50.600] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:50.600] [polycubed] [info]  daemon: false
[2020-12-24 10:32:50.600] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:50.600] [polycubed] [info]  port: 9000
[2020-12-24 10:32:50.600] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:50.600] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:50.600] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:50.600] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:52.770] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:52.770] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:52.817] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:52.827] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:52.841] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:52.850] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:52.882] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:52.891] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:52.933] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:52.965] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:52.999] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:53.042] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:53.086] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:53.108] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:53.119] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:53.134] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:53.142] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:53.151] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:53.193] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:53.240] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:53.240] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:55.098] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:55.098] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:33:00.464] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:00.464] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:33:00.949] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:00.950] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:00.950] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:33:01.115] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:01.268] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07082s!
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:02.021] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:33:02.187] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:02.357] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:03.105] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0842s!
id: 0

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:33:03.247] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:33:03.254] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:03.407] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:04.296] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04256s!
[2020-12-24 10:33:04.296] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:04.449] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:05.344] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04789s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:33:05.352] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:33:05.507] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:06.402] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05052s!
[2020-12-24 10:33:06.402] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:33:06.558] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:07.459] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05676s!
id: 1

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:33:07.605] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [Automatic forward][Interactive mode]'
UDP Conntrack Test [Automatic forward][Interactive mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:33:07.653] [Firewall] [fw] [info] [fw] Destroying firewall...
[2020-12-24 10:33:07.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:07.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</failure><system-out>[2020-12-24 10:32:50.599] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:32:50.600] [polycubed] [info] configuration parameters: 
[2020-12-24 10:32:50.600] [polycubed] [info]  loglevel: info
[2020-12-24 10:32:50.600] [polycubed] [info]  daemon: false
[2020-12-24 10:32:50.600] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:32:50.600] [polycubed] [info]  port: 9000
[2020-12-24 10:32:50.600] [polycubed] [info]  addr: localhost
[2020-12-24 10:32:50.600] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:32:50.600] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:32:50.600] [polycubed] [info] polycubed starting...
[2020-12-24 10:32:50.600] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:32:52.770] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:32:52.770] [polycubed] [info] rest server starting ...
[2020-12-24 10:32:52.817] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:32:52.827] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:32:52.841] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:32:52.850] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:32:52.882] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:32:52.891] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:32:52.933] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:32:52.965] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:32:52.999] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:32:53.042] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:32:53.086] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:32:53.108] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:32:53.119] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:32:53.134] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:32:53.142] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:32:53.151] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:32:53.193] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:32:53.240] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:32:53.240] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:32:55.098] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:32:55.098] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:33:00.464] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:00.464] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw set accept-established=ON
++ polycubectl firewall fw chain INGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:33:00.949] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:00.950] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:00.950] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:33:01.115] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:01.268] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.07082s!
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:02.020] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:02.021] [Firewall] [fw] [debug] HORUS fields ENABLED: L4PROTO  - DISABLED SRCIP DSTIP SRCPORT DSTPORT  
[2020-12-24 10:33:02.187] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:02.357] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:03.105] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.0842s!
id: 0

++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:33:03.247] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS append l4proto=UDP conntrack=NEW action=FORWARD
[2020-12-24 10:33:03.254] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:03.407] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:04.296] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04256s!
[2020-12-24 10:33:04.296] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:04.449] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:05.344] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.04789s!
id: 0

++ polycubectl firewall fw chain EGRESS append l4proto=ICMP action=FORWARD
[2020-12-24 10:33:05.352] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:33:05.507] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:06.402] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05052s!
[2020-12-24 10:33:06.402] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:33:06.558] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:07.459] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.05676s!
id: 1

++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:33:07.605] [Firewall] [fw] [debug] [fw] Default action set. 
++ echo 'UDP Conntrack Test [Automatic forward][Interactive mode]'
UDP Conntrack Test [Automatic forward][Interactive mode]
++ echo '(1) Sending NOT allowed NEW UDP packet'
(1) Sending NOT allowed NEW UDP packet
+++ sudo ip netns exec ns1 nping --udp -c 1 -p 50000 -g 50000 10.0.0.2
exec of "nping" failed: No such file or directory
++ npingOutput=
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:33:07.653] [Firewall] [fw] [info] [fw] Destroying firewall...
[2020-12-24 10:33:07.888] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:07.888] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_append.sh" time="19.000000" status="Passed"><system-out>[2020-12-24 10:33:09.588] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:33:09.589] [polycubed] [info] configuration parameters: 
[2020-12-24 10:33:09.589] [polycubed] [info]  loglevel: info
[2020-12-24 10:33:09.589] [polycubed] [info]  daemon: false
[2020-12-24 10:33:09.589] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:33:09.589] [polycubed] [info]  port: 9000
[2020-12-24 10:33:09.589] [polycubed] [info]  addr: localhost
[2020-12-24 10:33:09.589] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:33:09.589] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:33:09.589] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:33:09.589] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:33:09.589] [polycubed] [info] polycubed starting...
[2020-12-24 10:33:09.589] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:33:11.780] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:33:11.781] [polycubed] [info] rest server starting ...
[2020-12-24 10:33:11.829] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:33:11.840] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:33:11.854] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:33:11.863] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:33:11.898] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:33:11.908] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:33:11.952] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:33:11.987] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:33:12.023] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:33:12.069] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:33:12.116] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:33:12.140] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:33:12.151] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:33:12.166] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:33:12.175] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:33:12.184] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:33:12.228] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:33:12.278] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:33:12.278] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:33:14.088] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:33:14.088] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:33:19.152] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:19.152] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:33:19.542] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:19.542] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:19.542] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:19.707] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:19.860] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:20.176] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:20.176] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:33:20.923] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38107s!
[2020-12-24 10:33:20.923] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:20.923] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:20.923] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:21.090] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:21.244] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:22.292] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.36905s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:33:22.298] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:22.298] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:22.299] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:22.464] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:22.619] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:23.671] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37284s!
[2020-12-24 10:33:23.671] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:23.671] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:23.672] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:23.839] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:23.993] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:25.046] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37507s!
id: 0

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.154 ms
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:25.058] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.168 ms
[2020-12-24 10:33:25.584] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet

[2020-12-24 10:33:25.584] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 526ms
rtt min/avg/max/mdev = 0.154/0.161/0.168/0.007 ms
[2020-12-24 10:33:25.584] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:25.585] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:33:25.590] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_counters.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:33:28.599] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:33:28.599] [polycubed] [info] configuration parameters: 
[2020-12-24 10:33:28.599] [polycubed] [info]  loglevel: info
[2020-12-24 10:33:28.599] [polycubed] [info]  daemon: false
[2020-12-24 10:33:28.599] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:33:28.599] [polycubed] [info]  port: 9000
[2020-12-24 10:33:28.599] [polycubed] [info]  addr: localhost
[2020-12-24 10:33:28.599] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:33:28.599] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:33:28.599] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:33:28.599] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:33:28.599] [polycubed] [info] polycubed starting...
[2020-12-24 10:33:28.599] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:33:30.789] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:33:30.789] [polycubed] [info] rest server starting ...
[2020-12-24 10:33:30.832] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:33:30.843] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:33:30.858] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:33:30.868] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:33:30.900] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:33:30.910] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:33:30.951] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:33:30.984] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:33:31.018] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:33:31.061] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:33:31.105] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:33:31.128] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:33:31.139] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:33:31.154] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:33:31.163] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:33:31.172] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:33:31.213] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:33:31.260] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:33:31.260] [polycubed] [info] loading metrics from yang files

Test counters 

[2020-12-24 10:33:33.112] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:33:33.112] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:33:38.096] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:38.096] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:33:38.595] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:33:38.595] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:38.595] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:38.761] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:38.916] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:39.982] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38758s!
[2020-12-24 10:33:39.989] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:33:39.989] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:33:39.989] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:33:40.155] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:33:40.308] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:33:41.353] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36425s!
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.153 ms
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:41.364] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:33:41.872] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.171 ms

[2020-12-24 10:33:41.872] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:33:41.872] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 508ms
rtt min/avg/max/mdev = 0.153/0.162/0.171/0.009 ms
[2020-12-24 10:33:41.872] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:41.873] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
Success.
[2020-12-24 10:33:41.900] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_counters_default.sh" time="13.000000" status="Passed"><system-out>[2020-12-24 10:33:43.624] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:33:43.625] [polycubed] [info] configuration parameters: 
[2020-12-24 10:33:43.625] [polycubed] [info]  loglevel: info
[2020-12-24 10:33:43.625] [polycubed] [info]  daemon: false
[2020-12-24 10:33:43.625] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:33:43.625] [polycubed] [info]  port: 9000
[2020-12-24 10:33:43.625] [polycubed] [info]  addr: localhost
[2020-12-24 10:33:43.625] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:33:43.625] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:33:43.625] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:33:43.625] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:33:43.625] [polycubed] [info] polycubed starting...
[2020-12-24 10:33:43.625] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:33:45.815] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:33:45.816] [polycubed] [info] rest server starting ...
[2020-12-24 10:33:45.860] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:33:45.871] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:33:45.885] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:33:45.895] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:33:45.927] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:33:45.937] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:33:45.979] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:33:46.012] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:33:46.047] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:33:46.089] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:33:46.133] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:33:46.156] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:33:46.167] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:33:46.182] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:33:46.191] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:33:46.200] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:33:46.242] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:33:46.289] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:33:46.289] [polycubed] [info] loading metrics from yang files

Test counters 

[2020-12-24 10:33:48.130] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:33:48.130] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:33:53.200] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:53.200] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.148 ms
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][ChainForwarder]: No ingress chain
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][DefaultAction]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:53.576] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.162 ms

[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 520ms
rtt min/avg/max/mdev = 0.148/0.155/0.162/0.007 ms
[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][ChainForwarder]: No ingress chain
[2020-12-24 10:33:54.096] [Firewall] [fw] [debug] [ingress][DefaultAction]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:33:54.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
PASSED
[2020-12-24 10:33:54.109] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_counters_default_2.sh" time="12.000000" status="Passed"><system-out>[2020-12-24 10:33:56.627] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:33:56.628] [polycubed] [info] configuration parameters: 
[2020-12-24 10:33:56.628] [polycubed] [info]  loglevel: info
[2020-12-24 10:33:56.628] [polycubed] [info]  daemon: false
[2020-12-24 10:33:56.628] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:33:56.628] [polycubed] [info]  port: 9000
[2020-12-24 10:33:56.628] [polycubed] [info]  addr: localhost
[2020-12-24 10:33:56.628] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:33:56.628] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:33:56.628] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:33:56.628] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:33:56.628] [polycubed] [info] polycubed starting...
[2020-12-24 10:33:56.628] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:33:58.810] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:33:58.811] [polycubed] [info] rest server starting ...
[2020-12-24 10:33:58.857] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:33:58.867] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:33:58.882] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:33:58.891] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:33:58.925] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:33:58.935] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:33:58.978] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:33:59.011] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:33:59.047] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:33:59.091] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:33:59.137] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:33:59.161] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:33:59.172] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:33:59.188] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:33:59.197] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:33:59.206] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:33:59.249] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:33:59.298] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:33:59.298] [polycubed] [info] loading metrics from yang files

Test counters 

[2020-12-24 10:34:01.147] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:34:01.147] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:34:06.867] [Firewall] [fw] [debug] [fw] Default action already set. 
[2020-12-24 10:34:06.871] [Firewall] [fw] [debug] [fw] Default action already set. 
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x1 
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 0 dPort: 0 
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.191 ms
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][ChainForwarder]: No ingress chain
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][DefaultAction]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x1 
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [egress] [Parser] sPort: 0 dPort: 0 
[2020-12-24 10:34:06.913] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:06.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:34:07.024] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:07.024] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:07.440] [Firewall] [fw] [trace] [ingress] [Parser] srcIp: 10.0.0.1 dstIp: 10.0.0.2 l4proto:0x1 
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.166 ms
[2020-12-24 10:34:07.440] [Firewall] [fw] [trace] [ingress] [Parser] sPort: 0 dPort: 0 

[2020-12-24 10:34:07.440] [Firewall] [fw] [trace] [ingress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 527ms
rtt min/avg/max/mdev = 0.166/0.178/0.191/0.018 ms
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][ChainForwarder]: No ingress chain
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][DefaultAction]: Receiving packet
[2020-12-24 10:34:07.440] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [trace] [egress] [Parser] srcIp: 10.0.0.2 dstIp: 10.0.0.1 l4proto:0x1 
[2020-12-24 10:34:07.441] [Firewall] [fw] [trace] [egress] [Parser] sPort: 0 dPort: 0 
[2020-12-24 10:34:07.441] [Firewall] [fw] [trace] [egress] [Parser] Call CONNTRACKLABEL 1 
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:07.441] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
PASSED
[2020-12-24 10:34:07.452] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_counters_flush.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:34:08.690] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:34:08.691] [polycubed] [info] configuration parameters: 
[2020-12-24 10:34:08.691] [polycubed] [info]  loglevel: info
[2020-12-24 10:34:08.691] [polycubed] [info]  daemon: false
[2020-12-24 10:34:08.691] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:34:08.691] [polycubed] [info]  port: 9000
[2020-12-24 10:34:08.691] [polycubed] [info]  addr: localhost
[2020-12-24 10:34:08.691] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:34:08.691] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:34:08.691] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:34:08.691] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:34:08.691] [polycubed] [info] polycubed starting...
[2020-12-24 10:34:08.691] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:34:10.879] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:34:10.879] [polycubed] [info] rest server starting ...
[2020-12-24 10:34:10.921] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:34:10.931] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:34:10.945] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:34:10.955] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:34:10.988] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:34:10.998] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:34:11.041] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:34:11.074] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:34:11.110] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:34:11.154] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:34:11.199] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:34:11.222] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:34:11.233] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:34:11.248] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:34:11.257] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:34:11.266] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:34:11.308] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:34:11.357] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:34:11.357] [polycubed] [info] loading metrics from yang files

Test counters 

[2020-12-24 10:34:13.188] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:34:13.188] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:34:18.639] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:34:18.639] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:18.639] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:18.800] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:18.800] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:18.806] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:18.960] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:20.023] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38337s!
[2020-12-24 10:34:20.029] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:34:20.029] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:20.030] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:20.197] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:20.351] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:21.405] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37583s!
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.176 ms
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:21.448] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:34:21.968] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.177 ms
[2020-12-24 10:34:21.968] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.

[2020-12-24 10:34:21.968] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:34:21.968] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 520ms
rtt min/avg/max/mdev = 0.176/0.176/0.177/0.013 ms
[2020-12-24 10:34:21.968] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:21.969] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
Success.
[2020-12-24 10:34:22.001] [Firewall] [fw] [info] [fw] Destroying firewall...
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_counters_reload.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 10:34:23.670] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:34:23.671] [polycubed] [info] configuration parameters: 
[2020-12-24 10:34:23.671] [polycubed] [info]  loglevel: info
[2020-12-24 10:34:23.671] [polycubed] [info]  daemon: false
[2020-12-24 10:34:23.671] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:34:23.671] [polycubed] [info]  port: 9000
[2020-12-24 10:34:23.671] [polycubed] [info]  addr: localhost
[2020-12-24 10:34:23.671] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:34:23.671] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:34:23.671] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:34:23.671] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:34:23.671] [polycubed] [info] polycubed starting...
[2020-12-24 10:34:23.671] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:34:25.855] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:34:25.856] [polycubed] [info] rest server starting ...
[2020-12-24 10:34:25.900] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:34:25.910] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:34:25.925] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:34:25.934] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:34:25.966] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:34:25.976] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:34:26.018] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:34:26.050] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:34:26.085] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:34:26.127] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:34:26.171] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:34:26.193] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:34:26.204] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:34:26.219] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:34:26.228] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:34:26.236] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:34:26.277] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:34:26.324] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:34:26.324] [polycubed] [info] loading metrics from yang files

Test counters 

[2020-12-24 10:34:28.164] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:34:28.164] [Firewall] [fw] [debug] Ingress and Egress chain added
[2020-12-24 10:34:33.392] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:33.392] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:33.606] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:34:33.607] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:33.607] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:33.772] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:33.904] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:33.904] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:33.926] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:34.995] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38826s!
[2020-12-24 10:34:35.002] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:34:35.002] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:35.002] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:35.169] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:35.321] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:36.373] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.3709s!
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.175 ms
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:36.412] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.168 ms
[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.

[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.168/0.171/0.175/0.013 ms
[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:36.912] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:36.913] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:34:36.920] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:34:36.920] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:36.920] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:37.087] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:37.243] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:false ipdst:true protocol:true portstc:false portdst:true flags_map:false 
[2020-12-24 10:34:38.452] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.53234s!
[2020-12-24 10:34:38.459] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:34:38.460] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:38.460] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:38.627] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:38.783] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:false flags_map:false 
[2020-12-24 10:34:40.007] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.54763s!
[2020-12-24 10:34:40.007] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:34:40.007] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:40.007] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:40.178] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:40.333] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:false flags_map:false 
[2020-12-24 10:34:41.541] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.53354s!
id: 1

Success.
[2020-12-24 10:34:41.566] [Firewall] [fw] [info] [fw] Destroying firewall...
[2020-12-24 10:34:41.584] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:41.584] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:41.584] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:41.584] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:42.096] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:42.096] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_delete.sh" time="41.000000" status="Passed"><system-out>[2020-12-24 10:34:43.676] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:34:43.677] [polycubed] [info] configuration parameters: 
[2020-12-24 10:34:43.677] [polycubed] [info]  loglevel: info
[2020-12-24 10:34:43.677] [polycubed] [info]  daemon: false
[2020-12-24 10:34:43.677] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:34:43.677] [polycubed] [info]  port: 9000
[2020-12-24 10:34:43.677] [polycubed] [info]  addr: localhost
[2020-12-24 10:34:43.677] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:34:43.677] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:34:43.677] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:34:43.677] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:34:43.677] [polycubed] [info] polycubed starting...
[2020-12-24 10:34:43.677] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:34:45.840] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:34:45.840] [polycubed] [info] rest server starting ...
[2020-12-24 10:34:45.885] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:34:45.896] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:34:45.910] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:34:45.920] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:34:45.952] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:34:45.962] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:34:46.004] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:34:46.036] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:34:46.071] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:34:46.114] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:34:46.158] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:34:46.181] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:34:46.192] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:34:46.208] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:34:46.217] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:34:46.226] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:34:46.267] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:34:46.314] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:34:46.315] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:34:48.225] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:34:48.225] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:34:53.816] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:34:53.959] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:34:53.966] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:34:53.966] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:53.966] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:54.128] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:54.128] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:54.132] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:54.286] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:55.338] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.37196s!
[2020-12-24 10:34:55.338] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:34:55.338] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:55.338] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:55.504] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:55.656] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:56.700] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.3624s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:34:56.706] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:34:56.707] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:56.707] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:56.874] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:57.028] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:58.072] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36566s!
[2020-12-24 10:34:58.072] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:34:58.072] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:34:58.072] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:34:58.238] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:34:58.392] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:34:59.445] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37257s!
id: 0

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.162 ms
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:59.483] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.157 ms
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 

[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.157/0.159/0.162/0.012 ms
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:34:59.984] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:34:59.985] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:34:59.991] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 0 rules...
[2020-12-24 10:35:00.145] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:00.712] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.72119s!
++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:00.721] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:35:01.232] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:01.232] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:01.232] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:01.233] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:35:01.296] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:01.296] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 511ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:01.728] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:01.729] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:01.729] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:01.895] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:02.048] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:02.832] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:02.832] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:03.096] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.3677s!
[2020-12-24 10:35:03.096] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:03.096] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:03.097] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:03.263] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:03.417] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:04.463] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36711s!
id: 0

++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   2     196                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.128 ms
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:04.479] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:04.624] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:04.624] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:35:04.624] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:04.624] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.170 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 529ms
rtt min/avg/max/mdev = 0.128/0.149/0.170/0.021 ms
[2020-12-24 10:35:05.008] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:05.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS append src=10.0.0.0/24 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:05.015] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:35:05.015] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:05.015] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:05.182] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:05.335] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:06.381] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36548s!
[2020-12-24 10:35:06.381] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:35:06.381] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:06.381] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:06.547] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:06.701] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:07.748] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.3669s!
id: 1

++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   2     196    10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   0     0      10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 2   2     196                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 2                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.148 ms
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:07.764] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.170 ms
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 

[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 508ms
rtt min/avg/max/mdev = 0.148/0.159/0.170/0.011 ms
[2020-12-24 10:35:08.272] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:08.273] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 1
[2020-12-24 10:35:08.280] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:08.280] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:08.280] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:08.447] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:08.602] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:09.648] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36838s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   4     392    10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   2     196                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.136 ms
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:09.694] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:09.695] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:09.695] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:09.695] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:10.224] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.170 ms

[2020-12-24 10:35:10.224] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:10.224] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 530ms
rtt min/avg/max/mdev = 0.136/0.153/0.170/0.017 ms
[2020-12-24 10:35:10.224] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:10.224] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:10.225] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:35:10.231] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 0 rules...
[2020-12-24 10:35:10.384] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:10.955] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.723596s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  action  description
 0   2     196    drop    DEFAULT

rule:
 id  action  description
 0   drop    Default Policy

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:10.970] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:35:11.472] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:11.472] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:11.472] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:11.473] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 502ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:11.977] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:11.977] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:11.978] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:12.143] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:12.297] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:13.349] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37124s!
[2020-12-24 10:35:13.349] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:13.349] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:13.349] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:13.516] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:13.670] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:14.711] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36268s!
id: 0

++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   4     392                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.123 ms
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:14.727] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.169 ms
[2020-12-24 10:35:15.248] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet

[2020-12-24 10:35:15.248] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 521ms
rtt min/avg/max/mdev = 0.123/0.146/0.169/0.023 ms
[2020-12-24 10:35:15.248] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:15.249] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS append src=10.0.0.0/24 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:15.256] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:35:15.256] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:15.256] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:15.422] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:15.576] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:16.620] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.3645s!
[2020-12-24 10:35:16.620] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:35:16.620] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:16.621] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:16.788] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:16.912] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:16.912] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:35:16.943] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:17.992] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.3716s!
id: 1

++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   2     196    10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   0     0      10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 2   4     392                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 2                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.121 ms
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:18.009] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.161 ms
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet

[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.121/0.141/0.161/0.020 ms
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:18.512] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:18.513] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:35:18.519] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:18.519] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:18.519] [Firewall] [fw] [debug] HORUS fields ENABLED: DSTIP L4PROTO  - DISABLED SRCIP SRCPORT DSTPORT  
[2020-12-24 10:35:18.686] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:18.841] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:19.891] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37168s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 1   4     392                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.0/24  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.135 ms
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:19.941] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:20.464] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.171 ms

[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 523ms
rtt min/avg/max/mdev = 0.135/0.153/0.171/0.018 ms
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:20.465] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:35:20.472] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 0 rules...
[2020-12-24 10:35:20.496] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:20.496] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:20.626] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:21.195] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.723387s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  action  description
 0   4     392    drop    DEFAULT

rule:
 id  action  description
 0   drop    Default Policy

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:21.210] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:21.211] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:21.712] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:35:21.713] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 501ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:35:22.217] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_insert.sh" time="23.000000" status="Passed"><system-out>[2020-12-24 10:35:24.735] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:35:24.735] [polycubed] [info] configuration parameters: 
[2020-12-24 10:35:24.735] [polycubed] [info]  loglevel: info
[2020-12-24 10:35:24.735] [polycubed] [info]  daemon: false
[2020-12-24 10:35:24.735] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:35:24.735] [polycubed] [info]  port: 9000
[2020-12-24 10:35:24.735] [polycubed] [info]  addr: localhost
[2020-12-24 10:35:24.735] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:35:24.735] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:35:24.735] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:35:24.735] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:35:24.735] [polycubed] [info] polycubed starting...
[2020-12-24 10:35:24.735] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:35:26.890] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:35:26.890] [polycubed] [info] rest server starting ...
[2020-12-24 10:35:26.931] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:35:26.942] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:35:26.955] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:35:26.965] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:35:26.997] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:35:27.006] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:35:27.048] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:35:27.080] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:35:27.114] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:35:27.157] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:35:27.201] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:35:27.223] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:35:27.233] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:35:27.248] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:35:27.256] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:35:27.264] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:35:27.306] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:35:27.352] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:35:27.352] [polycubed] [info] loading metrics from yang files

Test insert 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:35:29.241] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:35:29.241] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:35:34.320] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:34.320] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ polycubectl firewall fw chain INGRESS insert src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:34.695] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:35:34.695] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:34.695] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:34.861] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:35.014] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:36.070] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.3747s!
id: 0

++ polycubectl firewall fw chain EGRESS insert src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:35:36.076] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:36.077] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:36.077] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:36.243] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:36.398] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:37.445] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36808s!
id: 0

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.191 ms
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:37.492] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.170 ms
[2020-12-24 10:35:38.000] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet

[2020-12-24 10:35:38.000] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 508ms
rtt min/avg/max/mdev = 0.170/0.180/0.191/0.017 ms
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:38.001] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain INGRESS insert src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
[2020-12-24 10:35:38.008] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:35:38.008] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:38.008] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:38.176] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:38.330] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:39.383] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.37495s!
id: 0

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:39.392] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:39.392] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:39.392] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:39.392] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:39.392] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=DROP. Drop the packet. 
[2020-12-24 10:35:39.920] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:39.920] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:39.920] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:39.920] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:39.920] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=DROP. Drop the packet. 
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 527ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain INGRESS delete src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
[2020-12-24 10:35:40.400] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:35:40.401] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:40.401] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:40.567] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:40.722] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:41.772] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.3717s!
++ polycubectl firewall fw chain INGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: ingress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   2     196    10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1                                      forward  Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:41.787] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.122 ms
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:41.788] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:42.000] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:42.000] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:35:42.256] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:42.256] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:42.288] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.171 ms

[2020-12-24 10:35:42.288] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.122/0.146/0.171/0.027 ms
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:42.289] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain INGRESS insert id=1 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
[2020-12-24 10:35:42.296] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:35:42.296] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:42.297] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:42.464] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:42.512] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:42.512] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:35:42.512] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:42.512] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:42.619] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:43.668] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.37214s!
id: 1

++ polycubectl firewall fw chain INGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: ingress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   4     392    10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1   0     0      10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 2   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1   10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 2                                      forward  Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.133 ms
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:43.684] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:44.208] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.175 ms

[2020-12-24 10:35:44.208] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 524ms
rtt min/avg/max/mdev = 0.133/0.154/0.175/0.021 ms
[2020-12-24 10:35:44.208] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:44.209] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ set +e
++ polycubectl firewall fw chain INGRESS insert id=2 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
[2020-12-24 10:35:44.215] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:35:44.215] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:35:44.215] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:35:44.381] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:35:44.536] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:45.592] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.37739s!
id: 2

++ polycubectl firewall fw chain INGRESS insert id=5 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
id not allowed
++ polycubectl firewall fw chain INGRESS insert id=-1 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"id"}]}}
++ set -e
++ polycubectl firewall fw chain INGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: ingress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   6     588    10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1   0     0      10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 2   0     0      10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 3   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.1/32  10.0.0.2/32  ICMP     forward  
 1   10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 2   10.0.0.1/32  10.0.0.2/32  ICMP     drop     
 3                                      forward  Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.131 ms
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:45.620] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.167 ms
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2

[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 508ms
rtt min/avg/max/mdev = 0.131/0.149/0.167/0.018 ms
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:35:46.128] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:35:46.129] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:35:46.135] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_ipslpm.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:35:47.769] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:35:47.770] [polycubed] [info] configuration parameters: 
[2020-12-24 10:35:47.770] [polycubed] [info]  loglevel: info
[2020-12-24 10:35:47.770] [polycubed] [info]  daemon: false
[2020-12-24 10:35:47.770] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:35:47.770] [polycubed] [info]  port: 9000
[2020-12-24 10:35:47.770] [polycubed] [info]  addr: localhost
[2020-12-24 10:35:47.770] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:35:47.770] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:35:47.770] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:35:47.770] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:35:47.770] [polycubed] [info] polycubed starting...
[2020-12-24 10:35:47.770] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:35:49.998] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:35:49.998] [polycubed] [info] rest server starting ...
[2020-12-24 10:35:50.040] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:35:50.051] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:35:50.066] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:35:50.076] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:35:50.110] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:35:50.121] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:35:50.164] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:35:50.198] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:35:50.234] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:35:50.278] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:35:50.323] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:35:50.346] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:35:50.358] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:35:50.374] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:35:50.383] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:35:50.393] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:35:50.436] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:35:50.485] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:35:50.485] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:35:52.241] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:35:52.241] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS append src=10.0.0.0/8 action=DROP
[2020-12-24 10:35:57.778] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:35:57.934] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:58.128] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:35:58.128] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:35:58.683] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.905208s!
[2020-12-24 10:35:58.683] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:35:58.839] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:35:59.608] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.924976s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.0/8 action=DROP
[2020-12-24 10:35:59.615] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:35:59.771] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:00.523] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.907483s!
[2020-12-24 10:36:00.523] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:00.678] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:01.438] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.915404s!
id: 0

++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 action=FORWARD
[2020-12-24 10:36:01.445] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:36:01.601] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:02.355] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.910007s!
[2020-12-24 10:36:02.355] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:36:02.512] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:03.266] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.911206s!
id: 1

++ polycubectl firewall fw chain EGRESS append src=10.0.0.1 action=FORWARD
[2020-12-24 10:36:03.274] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:36:03.431] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:04.178] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.904038s!
[2020-12-24 10:36:04.178] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:36:04.333] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:05.080] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.902587s!
id: 1

++ polycubectl firewall fw chain INGRESS append src=10.0.0.2 action=FORWARD
[2020-12-24 10:36:05.087] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:36:05.242] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:05.988] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.901054s!
[2020-12-24 10:36:05.988] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 3 rules...
[2020-12-24 10:36:06.144] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:06.576] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:06.576] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:06.576] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:06.576] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:06.892] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 0.903883s!
id: 2

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2 action=FORWARD
[2020-12-24 10:36:06.899] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:36:07.055] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:07.800] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.900735s!
[2020-12-24 10:36:07.800] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:36:07.956] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:08.706] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.905347s!
id: 2

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:36:08.718] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
[2020-12-24 10:36:09.232] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:09.232] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:09.232] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:09.232] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 16
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 0
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 0
[2020-12-24 10:36:09.233] [Firewall] [fw] [debug] [ingress][Action]: Action taken: DROP
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 514ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:36:09.725] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_removerule.sh" time="23.000000" status="Passed"><system-out>[2020-12-24 10:36:12.776] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:36:12.777] [polycubed] [info] configuration parameters: 
[2020-12-24 10:36:12.777] [polycubed] [info]  loglevel: info
[2020-12-24 10:36:12.777] [polycubed] [info]  daemon: false
[2020-12-24 10:36:12.777] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:36:12.777] [polycubed] [info]  port: 9000
[2020-12-24 10:36:12.777] [polycubed] [info]  addr: localhost
[2020-12-24 10:36:12.777] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:36:12.777] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:36:12.777] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:36:12.777] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:36:12.777] [polycubed] [info] polycubed starting...
[2020-12-24 10:36:12.777] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:36:14.948] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:36:14.948] [polycubed] [info] rest server starting ...
[2020-12-24 10:36:14.996] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:36:15.007] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:36:15.021] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:36:15.030] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:36:15.062] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:36:15.073] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:36:15.114] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:36:15.147] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:36:15.181] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:36:15.223] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:36:15.266] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:36:15.288] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:36:15.299] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:36:15.314] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:36:15.322] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:36:15.330] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:36:15.371] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:36:15.418] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:36:15.418] [polycubed] [info] loading metrics from yang files
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:36:17.281] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:36:17.281] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=DROP
[2020-12-24 10:36:22.711] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:36:22.711] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:22.711] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:22.873] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:22.960] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:22.960] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:23.025] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:24.077] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.36608s!
[2020-12-24 10:36:24.077] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:36:24.077] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:24.077] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:24.242] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:24.395] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:25.429] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.35253s!
id: 0

++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:25.437] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:36:25.437] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:25.437] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:25.602] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:25.754] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:26.784] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.34681s!
[2020-12-24 10:36:26.784] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 2 rules...
[2020-12-24 10:36:26.784] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:26.784] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:26.949] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:27.103] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:28.132] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.34858s!
id: 1

++ polycubectl firewall fw chain EGRESS rule add 0 src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=DROP
[2020-12-24 10:36:28.140] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:28.140] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:28.140] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:28.303] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:28.456] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:29.493] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.35383s!
++ polycubectl firewall fw chain EGRESS rule add 1 src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:29.501] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:36:29.501] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:29.501] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:29.667] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:29.819] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:30.384] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:30.384] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:30.640] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:30.640] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:30.853] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.35282s!
++ polycubectl firewall fw chain INGRESS rule del 0
[2020-12-24 10:36:30.860] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:36:30.860] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:30.860] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:31.026] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:31.180] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:32.221] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.36096s!
++ polycubectl firewall fw chain EGRESS rule del 0
[2020-12-24 10:36:32.228] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:32.228] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:32.229] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:32.393] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:32.546] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:33.584] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.35513s!
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:33.595] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:33.595] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.156 ms
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:33.596] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.164 ms
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2

[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.156/0.160/0.164/0.004 ms
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:34.096] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:34.097] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:36:34.102] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_replace.sh" time="31.000000" status="Passed"><system-out>[2020-12-24 10:36:35.768] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:36:35.769] [polycubed] [info] configuration parameters: 
[2020-12-24 10:36:35.769] [polycubed] [info]  loglevel: info
[2020-12-24 10:36:35.769] [polycubed] [info]  daemon: false
[2020-12-24 10:36:35.769] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:36:35.769] [polycubed] [info]  port: 9000
[2020-12-24 10:36:35.769] [polycubed] [info]  addr: localhost
[2020-12-24 10:36:35.769] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:36:35.769] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:36:35.769] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:36:35.769] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:36:35.769] [polycubed] [info] polycubed starting...
[2020-12-24 10:36:35.769] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:36:37.948] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:36:37.949] [polycubed] [info] rest server starting ...
[2020-12-24 10:36:37.996] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:36:38.006] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:36:38.020] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:36:38.030] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:36:38.063] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:36:38.073] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:36:38.116] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:36:38.149] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:36:38.183] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:36:38.226] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:36:38.271] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:36:38.293] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:36:38.303] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:36:38.318] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:36:38.326] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:36:38.335] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:36:38.377] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:36:38.425] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:36:38.426] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:36:40.261] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:36:40.261] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS set default=DROP
[2020-12-24 10:36:45.827] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain EGRESS set default=DROP
[2020-12-24 10:36:45.970] [Firewall] [fw] [debug] [fw] Default action set. 
++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:45.976] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:36:45.977] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:45.977] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:46.142] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:46.256] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:46.256] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:46.296] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:47.362] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38583s!
[2020-12-24 10:36:47.362] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:36:47.362] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:47.363] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:47.529] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:47.683] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:48.729] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.36668s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:48.735] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:48.735] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:48.735] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:48.902] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:49.056] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:50.102] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36728s!
[2020-12-24 10:36:50.102] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:50.102] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:50.102] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:50.269] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:50.421] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:51.472] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37014s!
id: 0

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.178 ms
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:51.515] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.177 ms
[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0

[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:52.016] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.177/0.177/0.178/0.013 ms
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:52.017] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:36:52.023] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 0 rules...
[2020-12-24 10:36:52.179] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:52.749] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.725068s!
++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:36:52.757] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:53.264] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:36:53.265] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:36:53.424] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:53.424] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 507ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:53.763] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:53.764] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:53.764] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:53.928] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:54.082] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:55.135] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37151s!
[2020-12-24 10:36:55.135] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:55.135] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:55.135] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:55.216] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:55.217] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:55.303] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:55.457] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:56.514] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37896s!
id: 0

++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   2     196                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.120 ms
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:56.530] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:36:56.752] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:56.752] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:36:56.752] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:56.752] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.163 ms

[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 510ms
rtt min/avg/max/mdev = 0.120/0.141/0.163/0.024 ms
[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:57.040] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:36:57.041] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ polycubectl firewall fw chain EGRESS rule 0 add src=20.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:36:57.047] [Firewall] [fw] [info] Rule 0 overwritten!
[2020-12-24 10:36:57.047] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:36:57.047] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:36:57.047] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:36:57.215] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:36:57.372] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:36:58.426] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37909s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   2     196    20.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   2     196                                       drop     DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   20.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1                                      drop     Default Policy

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][IPsrc]: Receiving packet
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][IPsrc]: No match. (pkt-&gt;srcIp: 33554442) 
[2020-12-24 10:36:58.442] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:36:58.960] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:36:58.960] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:36:58.960] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:36:58.960] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 16
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][IPsrc]: Receiving packet
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][IPsrc]: No match. (pkt-&gt;srcIp: 33554442) 
[2020-12-24 10:36:58.961] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 518ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain EGRESS del rule 0
[2020-12-24 10:36:59.449] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 0 rules...
[2020-12-24 10:36:59.601] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:00.170] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 0.721544s!
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: drop

stats:
 id  pkts  bytes  action  description
 0   4     392    drop    DEFAULT

rule:
 id  action  description
 0   drop    Default Policy

++ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
++ set +e
+++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:37:00.186] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:00.688] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][ChainForwarder]: No egress chain
[2020-12-24 10:37:00.689] [Firewall] [fw] [debug] [egress][DefaultAction]: Receiving packet
++ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 502ms'
++ local status=1
++ set -e
++ '[' 1 -ne 0 ']'
++ return 0
++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:01.192] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:37:01.192] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:01.193] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:01.360] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:01.515] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:02.572] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37926s!
[2020-12-24 10:37:02.572] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:37:02.572] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:02.572] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:02.739] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:02.894] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:03.946] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37441s!
id: 0

++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.133 ms
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:37:03.993] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.169 ms
[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.

[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress] [Horus] RuleID: 0
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.133/0.151/0.169/0.018 ms
[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:04.496] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 0
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 0
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress] [Horus] RuleID: 0
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress] [Horus] ACTION=ACCEPT &amp; CT enabled. Tag with PASS_LABELING. 
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 FORWARDING_PASS_LABELING calling CONNTRACKTABLEUPDATE 4
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 0
[2020-12-24 10:37:04.497] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 0, AckN: 0. ConnStatus: 1
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:37:04.503] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/general/test_wrong_position.sh" time="25.000000" status="Passed"><system-out>[2020-12-24 10:37:06.759] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:37:06.759] [polycubed] [info] configuration parameters: 
[2020-12-24 10:37:06.759] [polycubed] [info]  loglevel: info
[2020-12-24 10:37:06.759] [polycubed] [info]  daemon: false
[2020-12-24 10:37:06.759] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:37:06.759] [polycubed] [info]  port: 9000
[2020-12-24 10:37:06.759] [polycubed] [info]  addr: localhost
[2020-12-24 10:37:06.759] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:37:06.759] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:37:06.759] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:37:06.759] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:37:06.759] [polycubed] [info] polycubed starting...
[2020-12-24 10:37:06.759] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:37:08.939] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:37:08.940] [polycubed] [info] rest server starting ...
[2020-12-24 10:37:08.984] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:37:08.995] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:37:09.010] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:37:09.020] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:37:09.054] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:37:09.064] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:37:09.108] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:37:09.141] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:37:09.177] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:37:09.220] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:37:09.266] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:37:09.289] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:37:09.300] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:37:09.315] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:37:09.324] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:37:09.333] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:37:09.376] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:37:09.425] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:37:09.425] [polycubed] [info] loading metrics from yang files

Test wrong position 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:37:11.262] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:37:11.262] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS append src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:16.720] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:37:16.720] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:37:16.723] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:37:16.723] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:16.723] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:16.888] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:17.043] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:18.112] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.38953s!
[2020-12-24 10:37:18.112] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 1 rules...
[2020-12-24 10:37:18.112] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:18.112] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:18.279] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:18.432] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:19.483] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.37122s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:19.490] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:37:19.490] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:19.490] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:19.657] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:19.811] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:20.858] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36837s!
[2020-12-24 10:37:20.858] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 1 rules...
[2020-12-24 10:37:20.858] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:20.859] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:21.025] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:21.180] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:22.229] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37116s!
id: 0

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:22.237] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:37:22.237] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:22.237] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:22.404] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:22.560] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:23.612] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37454s!
[2020-12-24 10:37:23.612] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 2 rules...
[2020-12-24 10:37:23.612] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:23.612] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:23.780] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:23.933] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:24.656] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:37:24.656] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:37:24.986] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.37437s!
id: 1

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:24.994] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:37:24.994] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:24.994] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:25.159] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:25.168] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:37:25.168] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:37:25.314] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:26.360] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36608s!
[2020-12-24 10:37:26.360] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 3 rules...
[2020-12-24 10:37:26.360] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:26.360] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:26.527] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:26.680] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:27.726] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36601s!
id: 2

++ polycubectl firewall fw chain EGRESS append src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
[2020-12-24 10:37:27.733] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 4 rules...
[2020-12-24 10:37:27.734] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:27.734] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:27.901] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:28.054] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:29.099] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36529s!
[2020-12-24 10:37:29.099] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 4 rules...
[2020-12-24 10:37:29.099] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:37:29.099] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP L4PROTO  - DISABLED SRCPORT DSTPORT  
[2020-12-24 10:37:29.267] [Firewall] [fw] [info] HORUS # offloaded rules: 1 
[2020-12-24 10:37:29.421] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:true flags_map:false 
[2020-12-24 10:37:30.467] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.36771s!
id: 3

++ set +e
++ polycubectl fw chain EGRESS rule del -1
-1 is not a valid flag
++ polycubectl fw chain EGRESS rule del 4
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ polycubectl fw chain EGRESS rule del 5
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ polycubectl fw chain EGRESS rule del 10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ set -e
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4                                      forward  Default Policy

++ set +e
++ polycubectl fw chain EGRESS rule show -1
-1 is not a valid flag
++ polycubectl fw chain EGRESS rule show 4
There is no rule 4
++ polycubectl fw chain EGRESS rule show 5
There is no rule 5
++ polycubectl fw chain EGRESS rule show 10
There is no rule 10
++ set -e
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4                                      forward  Default Policy

++ set +e
++ polycubectl fw chain INGRESS rule del -1
-1 is not a valid flag
++ polycubectl fw chain INGRESS rule del 1
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ polycubectl fw chain INGRESS rule del 2
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ polycubectl fw chain INGRESS rule del 10
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
++ polycubectl fw chain INGRESS rule show -1
-1 is not a valid flag
++ polycubectl fw chain INGRESS rule show 1
There is no rule 1
++ polycubectl fw chain INGRESS rule show 2
There is no rule 2
++ polycubectl fw chain INGRESS rule show 10
There is no rule 10
++ set -e
++ polycubectl fw chain EGRESS show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: egress
default: forward

stats:
 id  pkts  bytes  src          dst          l4proto  action   description
 0   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   0     0      10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4   0     0                                         forward  DEFAULT

rule:
 id  src          dst          l4proto  action   description
 0   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 1   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 2   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 3   10.0.0.2/32  10.0.0.1/32  ICMP     forward  
 4                                      forward  Default Policy

++ polycubectl fw chain EGRESS show rule 0
id: 0
src: 10.0.0.2/32
dst: 10.0.0.1/32
l4proto: ICMP
action: forward

++ polycubectl fw chain EGRESS show rule 1
id: 1
src: 10.0.0.2/32
dst: 10.0.0.1/32
l4proto: ICMP
action: forward

++ polycubectl fw chain EGRESS show rule 2
id: 2
src: 10.0.0.2/32
dst: 10.0.0.1/32
l4proto: ICMP
action: forward

++ polycubectl fw chain EGRESS show rule 3
id: 3
src: 10.0.0.2/32
dst: 10.0.0.1/32
l4proto: ICMP
action: forward

++ polycubectl fw chain INGRESS show rule 0
id: 0
src: 10.0.0.1/32
dst: 10.0.0.2/32
l4proto: ICMP
action: forward

++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:37:30.592] [Firewall] [fw] [info] [fw] Destroying firewall...
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_1.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 10:37:31.779] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:37:31.780] [polycubed] [info] configuration parameters: 
[2020-12-24 10:37:31.780] [polycubed] [info]  loglevel: info
[2020-12-24 10:37:31.780] [polycubed] [info]  daemon: false
[2020-12-24 10:37:31.780] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:37:31.780] [polycubed] [info]  port: 9000
[2020-12-24 10:37:31.780] [polycubed] [info]  addr: localhost
[2020-12-24 10:37:31.780] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:37:31.780] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:37:31.780] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:37:31.780] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:37:31.780] [polycubed] [info] polycubed starting...
[2020-12-24 10:37:31.780] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:37:33.972] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:37:33.972] [polycubed] [info] rest server starting ...
[2020-12-24 10:37:34.016] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:37:34.027] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:37:34.041] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:37:34.051] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:37:34.085] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:37:34.095] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:37:34.137] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:37:34.170] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:37:34.205] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:37:34.250] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:37:34.295] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:37:34.318] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:37:34.329] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:37:34.345] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:37:34.354] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:37:34.363] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:37:34.406] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:37:34.454] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:37:34.454] [polycubed] [info] loading metrics from yang files

Test 1 

++ TYPE=TC
++ '[' -n '' ']'
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw type=TC loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.073 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.082 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 507ms
rtt min/avg/max/mdev = 0.073/0.077/0.082/0.009 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ rm -f /tmp/batch.json
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_11.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 10:37:47.720] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:37:47.721] [polycubed] [info] configuration parameters: 
[2020-12-24 10:37:47.721] [polycubed] [info]  loglevel: info
[2020-12-24 10:37:47.721] [polycubed] [info]  daemon: false
[2020-12-24 10:37:47.721] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:37:47.721] [polycubed] [info]  port: 9000
[2020-12-24 10:37:47.721] [polycubed] [info]  addr: localhost
[2020-12-24 10:37:47.721] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:37:47.721] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:37:47.721] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:37:47.721] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:37:47.721] [polycubed] [info] polycubed starting...
[2020-12-24 10:37:47.721] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:37:49.919] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:37:49.919] [polycubed] [info] rest server starting ...
[2020-12-24 10:37:49.964] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:37:49.975] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:37:49.989] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:37:49.999] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:37:50.031] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:37:50.042] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:37:50.084] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:37:50.117] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:37:50.151] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:37:50.194] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:37:50.238] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:37:50.261] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:37:50.273] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:37:50.289] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:37:50.298] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:37:50.307] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:37:50.349] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:37:50.397] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:37:50.397] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.078 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.068 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 515ms
rtt min/avg/max/mdev = 0.068/0.073/0.078/0.005 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ rm -f /tmp/batch.json
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_1_xdp.sh" time="23.000000" status="Passed"><system-out>[2020-12-24 10:38:03.664] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:38:03.665] [polycubed] [info] configuration parameters: 
[2020-12-24 10:38:03.665] [polycubed] [info]  loglevel: info
[2020-12-24 10:38:03.665] [polycubed] [info]  daemon: false
[2020-12-24 10:38:03.665] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:38:03.665] [polycubed] [info]  port: 9000
[2020-12-24 10:38:03.665] [polycubed] [info]  addr: localhost
[2020-12-24 10:38:03.665] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:38:03.665] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:38:03.665] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:38:03.665] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:38:03.665] [polycubed] [info] polycubed starting...
[2020-12-24 10:38:03.665] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:38:05.862] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:38:05.862] [polycubed] [info] rest server starting ...
[2020-12-24 10:38:05.908] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:38:05.919] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:38:05.934] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:38:05.943] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:38:05.977] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:38:05.987] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:38:06.030] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:38:06.064] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:38:06.099] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:38:06.144] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:38:06.189] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:38:06.212] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:38:06.224] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:38:06.240] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:38:06.249] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:38:06.259] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:38:06.302] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:38:06.351] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:38:06.351] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-firewall/test/ping/test_ping_1.sh XDP_SKB

Test 1 

++ TYPE=TC
++ '[' -n XDP_SKB ']'
++ TYPE=XDP_SKB
++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw type=XDP_SKB loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.081 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.080 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 510ms
rtt min/avg/max/mdev = 0.080/0.080/0.081/0.009 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ rm -f /tmp/batch.json
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_2.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 10:38:26.451] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:38:26.451] [polycubed] [info] configuration parameters: 
[2020-12-24 10:38:26.451] [polycubed] [info]  loglevel: info
[2020-12-24 10:38:26.451] [polycubed] [info]  daemon: false
[2020-12-24 10:38:26.451] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:38:26.451] [polycubed] [info]  port: 9000
[2020-12-24 10:38:26.451] [polycubed] [info]  addr: localhost
[2020-12-24 10:38:26.451] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:38:26.451] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:38:26.451] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:38:26.451] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:38:26.451] [polycubed] [info] polycubed starting...
[2020-12-24 10:38:26.451] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:38:28.658] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:38:28.658] [polycubed] [info] rest server starting ...
[2020-12-24 10:38:28.704] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:38:28.715] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:38:28.730] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:38:28.740] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:38:28.772] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:38:28.783] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:38:28.825] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:38:28.858] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:38:28.893] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:38:28.936] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:38:28.980] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:38:29.003] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:38:29.014] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:38:29.030] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:38:29.040] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:38:29.049] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:38:29.092] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:38:29.139] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:38:29.139] [polycubed] [info] loading metrics from yang files

Test 2 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.080 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.078 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 511ms
rtt min/avg/max/mdev = 0.078/0.079/0.080/0.001 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ rm -f /tmp/batch.json
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_21.1.sh" time="23.000000" status="Passed"><system-out>[2020-12-24 10:38:42.413] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:38:42.413] [polycubed] [info] configuration parameters: 
[2020-12-24 10:38:42.413] [polycubed] [info]  loglevel: info
[2020-12-24 10:38:42.413] [polycubed] [info]  daemon: false
[2020-12-24 10:38:42.413] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:38:42.413] [polycubed] [info]  port: 9000
[2020-12-24 10:38:42.413] [polycubed] [info]  addr: localhost
[2020-12-24 10:38:42.413] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:38:42.413] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:38:42.413] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:38:42.413] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:38:42.413] [polycubed] [info] polycubed starting...
[2020-12-24 10:38:42.413] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:38:44.608] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:38:44.609] [polycubed] [info] rest server starting ...
[2020-12-24 10:38:44.652] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:38:44.663] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:38:44.677] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:38:44.686] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:38:44.720] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:38:44.730] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:38:44.773] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:38:44.807] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:38:44.843] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:38:44.887] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:38:44.932] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:38:44.956] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:38:44.966] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:38:44.982] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:38:44.991] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:38:44.999] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:38:45.043] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:38:45.093] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:38:45.093] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
+++ seq 0 1
++ for i in `seq 0 1`
++ polycubectl firewall fw chain INGRESS rule add 0 src=10.1.0.0/31 dst=10.1.0.0 l4proto=TCP sport=0 dport=0 tcpflags=SYN action=DROP
++ for i in `seq 0 1`
++ polycubectl firewall fw chain INGRESS rule add 1 src=10.1.1.1/31 dst=10.1.1.1 l4proto=TCP sport=1 dport=1 tcpflags=SYN action=DROP
++ polycubectl firewall fw chain INGRESS rule add 2 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
+++ seq 0 1
++ for i in `seq 0 1`
++ polycubectl firewall fw chain EGRESS rule add 0 src=10.1.0.0/32 dst=10.1.0.0 l4proto=TCP sport=0 dport=0 'tcpflags=!SYN' action=DROP
++ for i in `seq 0 1`
++ polycubectl firewall fw chain EGRESS rule add 1 src=10.1.1.1/32 dst=10.1.1.1 l4proto=TCP sport=1 dport=1 'tcpflags=!SYN' action=DROP
++ polycubectl firewall fw chain EGRESS rule add 2 src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.077 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.078 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.077/0.077/0.078/0.008 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_5.1.sh" time="66.000000" status="Passed"><system-out>[2020-12-24 10:39:05.380] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:39:05.381] [polycubed] [info] configuration parameters: 
[2020-12-24 10:39:05.381] [polycubed] [info]  loglevel: info
[2020-12-24 10:39:05.381] [polycubed] [info]  daemon: false
[2020-12-24 10:39:05.381] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:39:05.381] [polycubed] [info]  port: 9000
[2020-12-24 10:39:05.381] [polycubed] [info]  addr: localhost
[2020-12-24 10:39:05.381] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:39:05.381] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:39:05.381] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:39:05.381] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:39:05.381] [polycubed] [info] polycubed starting...
[2020-12-24 10:39:05.381] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:39:07.585] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:39:07.585] [polycubed] [info] rest server starting ...
[2020-12-24 10:39:07.628] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:39:07.639] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:39:07.654] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:39:07.664] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:39:07.697] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:39:07.708] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:39:07.750] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:39:07.783] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:39:07.818] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:39:07.862] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:39:07.906] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:39:07.929] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:39:07.940] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:39:07.955] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:39:07.965] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:39:07.974] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:39:08.016] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:39:08.063] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:39:08.063] [polycubed] [info] loading metrics from yang files

Test 5 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw
[2020-12-24 10:39:09.908] [Firewall] [fw] [info] Creating Firewall instance
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
[2020-12-24 10:39:27.573] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 4001 rules...
[2020-12-24 10:39:27.590] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:39:27.746] [Firewall] [fw] [info] HORUS # offloaded rules: 2048 
[2020-12-24 10:39:42.005] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 14.4316s!
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
[2020-12-24 10:39:54.469] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 4001 rules...
[2020-12-24 10:39:54.486] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:39:54.634] [Firewall] [fw] [info] HORUS # offloaded rules: 2048 
[2020-12-24 10:40:08.882] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 14.4126s!
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5 -w 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.091 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.091 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.091/0.091/0.091/0.000 ms
++ sudo ping 10.0.0.1 -c 2 -i 0.5 -w 1
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.052 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.073 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 504ms
rtt min/avg/max/mdev = 0.052/0.062/0.073/0.013 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
[2020-12-24 10:40:10.071] [Firewall] [fw] [info] [fw] Destroying firewall...
++ rm -f /tmp/batch.json
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/ping/test_ping_7.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:40:11.386] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:40:11.386] [polycubed] [info] configuration parameters: 
[2020-12-24 10:40:11.386] [polycubed] [info]  loglevel: info
[2020-12-24 10:40:11.386] [polycubed] [info]  daemon: false
[2020-12-24 10:40:11.386] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:40:11.386] [polycubed] [info]  port: 9000
[2020-12-24 10:40:11.386] [polycubed] [info]  addr: localhost
[2020-12-24 10:40:11.386] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:40:11.386] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:40:11.386] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:40:11.386] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:40:11.386] [polycubed] [info] polycubed starting...
[2020-12-24 10:40:11.386] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:40:13.605] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:40:13.605] [polycubed] [info] rest server starting ...
[2020-12-24 10:40:13.649] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:40:13.659] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:40:13.674] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:40:13.684] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:40:13.718] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:40:13.729] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:40:13.773] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:40:13.806] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:40:13.842] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:40:13.886] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:40:13.932] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:40:13.955] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:40:13.967] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:40:13.983] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:40:13.993] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:40:14.002] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:40:14.046] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:40:14.095] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:40:14.095] [polycubed] [info] loading metrics from yang files

Test 7 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
++ polycubectl firewall fw chain INGRESS rule add 0 src=10.0.0.1 dst=10.0.0.2 l4proto=ICMP action=FORWARD
++ polycubectl firewall fw chain EGRESS rule add 0 src=10.0.0.2/32 dst=10.0.0.1/32 l4proto=ICMP action=FORWARD
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -i 0.5
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.066 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.071 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 506ms
rtt min/avg/max/mdev = 0.066/0.068/0.071/0.008 ms
++ sudo ping 10.0.0.1 -c 2 -i 0.5
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.054 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.063 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 504ms
rtt min/avg/max/mdev = 0.054/0.058/0.063/0.008 ms
++ fwcleanup
++ set +e
++ polycubectl firewall del fw
++ delete_veth 2
++ delete_veth_pair
++ sudo ip link del veth1
++ sudo ip netns del ns1
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/tcp/test_tcp_1.sh" time="22.000000" status="Passed"><system-out>[2020-12-24 10:40:26.361] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:40:26.361] [polycubed] [info] configuration parameters: 
[2020-12-24 10:40:26.361] [polycubed] [info]  loglevel: info
[2020-12-24 10:40:26.361] [polycubed] [info]  daemon: false
[2020-12-24 10:40:26.361] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:40:26.361] [polycubed] [info]  port: 9000
[2020-12-24 10:40:26.361] [polycubed] [info]  addr: localhost
[2020-12-24 10:40:26.361] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:40:26.362] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:40:26.362] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:40:26.362] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:40:26.362] [polycubed] [info] polycubed starting...
[2020-12-24 10:40:26.362] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:40:28.558] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:40:28.559] [polycubed] [info] rest server starting ...
[2020-12-24 10:40:28.604] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:40:28.615] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:40:28.629] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:40:28.640] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:40:28.672] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:40:28.683] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:40:28.725] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:40:28.758] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:40:28.793] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:40:28.836] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:40:28.880] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:40:28.903] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:40:28.914] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:40:28.929] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:40:28.939] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:40:28.948] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:40:28.990] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:40:29.037] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:40:29.037] [polycubed] [info] loading metrics from yang files

Test TCP 1 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:40:30.875] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:40:30.875] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
[2020-12-24 10:40:36.454] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 129 rules...
[2020-12-24 10:40:36.455] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:40:36.455] [Firewall] [fw] [debug] HORUS fields ENABLED: DSTIP SRCPORT DSTPORT L4PROTO  - DISABLED SRCIP  
[2020-12-24 10:40:36.621] [Firewall] [fw] [info] HORUS # offloaded rules: 62 
[2020-12-24 10:40:36.656] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:40:36.656] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:40:36.656] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:36.656] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:40:36.843] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:false portdst:true flags_map:false 
[2020-12-24 10:40:38.420] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 1.96576s!
++ set +x
[2020-12-24 10:40:38.527] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 130 rules...
[2020-12-24 10:40:38.528] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:40:38.528] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP SRCPORT DSTPORT L4PROTO  - DISABLED  
[2020-12-24 10:40:38.696] [Firewall] [fw] [info] HORUS # offloaded rules: 63 
[2020-12-24 10:40:38.919] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:false flags_map:false 
[2020-12-24 10:40:40.484] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 1.95726s!
[2020-12-24 10:40:45.104] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.104] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=0] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][IPdst]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: +WILDCARD RULE+
[2020-12-24 10:40:45.500] [Firewall] [fw] [debug] [ingress][TCPFlagsLookup]: Receiving packet
Connection to 10.0.0.2 60123 port [tcp/*] succeeded!
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 0 offset 62
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 62
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 525749067, AckN: 0. ConnStatus: 0
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][IPdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][L4PortLookupdst]: +WILDCARD RULE+
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][TCPFlagsLookup]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 1 offset 0
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 63
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 12
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3962431565, AckN: 542526283. ConnStatus: 1
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][IPdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: +WILDCARD RULE+
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][TCPFlagsLookup]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 1 offset 0
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 63
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 542526283, AckN: 3979208781. ConnStatus: 1
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][IPdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: +WILDCARD RULE+
[2020-12-24 10:40:45.501] [Firewall] [fw] [debug] [ingress][TCPFlagsLookup]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 1 offset 1
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 64
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 11
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 542526283, AckN: 3979208781. ConnStatus: 1
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress] [Horus] receiving packet.
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress] [Horus] srcIp: 10.0.0.2 dstIp: 10.0.0.1
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][ChainForwarder]: calling EGRESS chain 7
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][IPdst]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][L4PortLookupdst]: +WILDCARD RULE+
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][TCPFlagsLookup]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][Bitscan]: Matching element 1 offset 1
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][Action]: receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][Action]: Rule matched: 64
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [egress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.2, Flags: 11
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 3979208781, AckN: 559303499. ConnStatus: 1
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ConntrackLabel]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ConntrackLabel][Label=1] Conntrack mode == 1 calling CHAINFORWARDER 2
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ChainForwarder]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ChainForwarder]: calling INGRESS chain 7
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][IPsrc]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][IPdst]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][L4ProtoLookup]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][L4PortLookupdst]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][L4PortLookupsrc]: +WILDCARD RULE+
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][TCPFlagsLookup]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Bitscan]: Matching element 1 offset 0
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: Rule matched: 63
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][Action]: Action taken: FORWARD
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ingress][ConntrackTableUpdate]: Receiving packet
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SrcIP: 10.0.0.1, Flags: 10
[2020-12-24 10:40:45.502] [Firewall] [fw] [debug] [ConntrackTableUpdate] received packet. SeqN: 559303499, AckN: 3995985997. ConnStatus: 1
[2020-12-24 10:40:45.508] [Firewall] [fw] [info] [fw] Destroying firewall...
[2020-12-24 10:40:45.872] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:40:45.872] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/tcp/test_tcp_2.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 10:40:48.385] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:40:48.385] [polycubed] [info] configuration parameters: 
[2020-12-24 10:40:48.385] [polycubed] [info]  loglevel: info
[2020-12-24 10:40:48.385] [polycubed] [info]  daemon: false
[2020-12-24 10:40:48.385] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:40:48.385] [polycubed] [info]  port: 9000
[2020-12-24 10:40:48.385] [polycubed] [info]  addr: localhost
[2020-12-24 10:40:48.385] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:40:48.385] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:40:48.385] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:40:48.385] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:40:48.386] [polycubed] [info] polycubed starting...
[2020-12-24 10:40:48.386] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:40:50.600] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:40:50.600] [polycubed] [info] rest server starting ...
[2020-12-24 10:40:50.645] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:40:50.656] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:40:50.670] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:40:50.680] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:40:50.714] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:40:50.725] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:40:50.769] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:40:50.803] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:40:50.839] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:40:50.884] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:40:50.930] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:40:50.953] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:40:50.965] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:40:50.981] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:40:50.991] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:40:51.001] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:40:51.045] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:40:51.095] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:40:51.095] [polycubed] [info] loading metrics from yang files

Test TCP 2 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=DEBUG
[2020-12-24 10:40:52.934] [Firewall] [fw] [info] Creating Firewall instance
[2020-12-24 10:40:52.934] [Firewall] [fw] [debug] Ingress and Egress chain added
++ polycubectl attach fw veth1
[2020-12-24 10:40:58.160] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:40:58.160] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
[2020-12-24 10:40:58.904] [Firewall] [fw] [info] [fw] Starting to update the ingress chain for 513 rules...
[2020-12-24 10:40:58.905] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:40:58.905] [Firewall] [fw] [debug] HORUS fields ENABLED: DSTIP SRCPORT DSTPORT L4PROTO  - DISABLED SRCIP  
[2020-12-24 10:40:59.074] [Firewall] [fw] [info] HORUS # offloaded rules: 126 
[2020-12-24 10:40:59.981] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:false portdst:true flags_map:false 
[2020-12-24 10:41:01.597] [Firewall] [fw] [info] [fw] Rules for the ingress chain have been updated in 2.69352s!
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
[2020-12-24 10:41:01.827] [Firewall] [fw] [info] [fw] Starting to update the egress chain for 261 rules...
[2020-12-24 10:41:01.829] [Firewall] [fw] [info] Horus Optimization ENABLED for this rule-set
[2020-12-24 10:41:01.829] [Firewall] [fw] [debug] HORUS fields ENABLED: SRCIP DSTIP SRCPORT DSTPORT L4PROTO  - DISABLED  
[2020-12-24 10:41:01.995] [Firewall] [fw] [info] HORUS # offloaded rules: 127 
[2020-12-24 10:41:02.412] [Firewall] [fw] [debug] Early break of pipeline conntrack:false ipsrc:true ipdst:true protocol:true portstc:true portdst:false flags_map:false 
[2020-12-24 10:41:03.989] [Firewall] [fw] [info] [fw] Rules for the egress chain have been updated in 2.16195s!
++ set +x
[2020-12-24 10:41:06.005] [Firewall] [fw] [info] [fw] Destroying firewall...
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress][Parser]: Packet not IP
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [egress][Parser]: Receiving packet
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [egress][Parser]: Packet not IP
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress][Parser]: Receiving packet
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress] [Horus] receiving packet.
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress] [Horus] srcIp: 10.0.0.1 dstIp: 10.0.0.2
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress] [Horus] Lookup MISS. Goto PIPELINE. 
[2020-12-24 10:41:06.008] [Firewall] [fw] [debug] [ingress] [Horus] call CONNTRACKLABEL 1 
./../src/services/pcn-firewall/test/tcp/test_tcp_2.sh: line 8:  4333 Terminated              sudo netcat -l 60123
./../src/services/pcn-firewall/test/tcp/test_tcp_2.sh: line 8:  4337 Terminated              sudo ip netns exec ns1 netcat -w 3 -nvz 10.0.0.2 60123
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/tcp/test_tcp_4.sh" time="126.000000" status="Passed"><system-out>[2020-12-24 10:41:08.472] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:41:08.473] [polycubed] [info] configuration parameters: 
[2020-12-24 10:41:08.473] [polycubed] [info]  loglevel: info
[2020-12-24 10:41:08.473] [polycubed] [info]  daemon: false
[2020-12-24 10:41:08.473] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:41:08.473] [polycubed] [info]  port: 9000
[2020-12-24 10:41:08.473] [polycubed] [info]  addr: localhost
[2020-12-24 10:41:08.473] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:41:08.473] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:41:08.473] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:41:08.473] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:41:08.473] [polycubed] [info] polycubed starting...
[2020-12-24 10:41:08.473] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:41:10.680] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:41:10.680] [polycubed] [info] rest server starting ...
[2020-12-24 10:41:10.724] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:41:10.735] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:41:10.749] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:41:10.759] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:41:10.791] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:41:10.801] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:41:10.843] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:41:10.876] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:41:10.911] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:41:10.953] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:41:10.997] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:41:11.020] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:41:11.031] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:41:11.047] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:41:11.056] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:41:11.066] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:41:11.108] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:41:11.155] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:41:11.155] [polycubed] [info] loading metrics from yang files

Test TCP 4 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
++ set +x
Connection to 10.0.0.2 60123 port [tcp/*] succeeded!
</system-out></testcase><testcase name="./../src/services/pcn-firewall/test/tcp/test_tcp_5.sh" time="18.000000" status="Passed"><system-out>[2020-12-24 10:43:14.488] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:43:14.489] [polycubed] [info] configuration parameters: 
[2020-12-24 10:43:14.489] [polycubed] [info]  loglevel: info
[2020-12-24 10:43:14.489] [polycubed] [info]  daemon: false
[2020-12-24 10:43:14.489] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:43:14.489] [polycubed] [info]  port: 9000
[2020-12-24 10:43:14.489] [polycubed] [info]  addr: localhost
[2020-12-24 10:43:14.489] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:43:14.489] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:43:14.489] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:43:14.489] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:43:14.489] [polycubed] [info] polycubed starting...
[2020-12-24 10:43:14.489] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:43:16.695] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:43:16.696] [polycubed] [info] rest server starting ...
[2020-12-24 10:43:16.741] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:43:16.752] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:43:16.766] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:43:16.777] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:43:16.811] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:43:16.822] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:43:16.866] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:43:16.901] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:43:16.937] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:43:16.981] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:43:17.028] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:43:17.051] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:43:17.063] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:43:17.079] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:43:17.088] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:43:17.097] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:43:17.141] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:43:17.191] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:43:17.191] [polycubed] [info] loading metrics from yang files

Test TCP 5 

++ create_veth 2
++ setup_veth_pair
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ sudo ip link set dev veth1 up
++ sudo ifconfig veth1 10.0.0.2/24
++ polycubectl firewall add fw loglevel=OFF
++ polycubectl attach fw veth1
++ set +x
++ polycubectl firewall fw chain INGRESS batch rules=
++ set +x
++ polycubectl firewall fw chain EGRESS batch rules=
++ set +x
Connection to 10.0.0.2 60123 port [tcp/*] succeeded!
</system-out></testcase><testcase name="./../src/services/pcn-helloworld/test/test1.sh" time="18.000000" status="Passed"><system-out>[2020-12-24 10:43:32.444] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:43:32.444] [polycubed] [info] configuration parameters: 
[2020-12-24 10:43:32.444] [polycubed] [info]  loglevel: info
[2020-12-24 10:43:32.444] [polycubed] [info]  daemon: false
[2020-12-24 10:43:32.445] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:43:32.445] [polycubed] [info]  port: 9000
[2020-12-24 10:43:32.445] [polycubed] [info]  addr: localhost
[2020-12-24 10:43:32.445] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:43:32.445] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:43:32.445] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:43:32.445] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:43:32.445] [polycubed] [info] polycubed starting...
[2020-12-24 10:43:32.445] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:43:34.629] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:43:34.630] [polycubed] [info] rest server starting ...
[2020-12-24 10:43:34.678] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:43:34.690] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:43:34.705] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:43:34.715] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:43:34.749] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:43:34.760] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:43:34.804] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:43:34.837] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:43:34.873] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:43:34.918] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:43:34.964] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:43:34.988] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:43:34.999] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:43:35.015] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:43:35.025] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:43:35.034] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:43:35.078] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:43:35.127] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:43:35.127] [polycubed] [info] loading metrics from yang files
+ set -e
+ TYPE=TC
+ '[' -n '' ']'
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw1 type=TC
[2020-12-24 10:43:37.045] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl helloworld hw1 ports add port1
[2020-12-24 10:43:37.051] [Helloworld] [hw1] [info] port port1 was connected
+ polycubectl helloworld hw1 ports add port2
[2020-12-24 10:43:37.056] [Helloworld] [hw1] [info] port port2 was connected
+ polycubectl connect hw1:port1 veth1
+ polycubectl connect hw1:port2 veth2
+ polycubectl helloworld hw1 set action=FORWARD
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.046 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1011ms
rtt min/avg/max/mdev = 0.046/0.051/0.056/0.005 ms
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.028 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1014ms
rtt min/avg/max/mdev = 0.028/0.041/0.055/0.014 ms
+ polycubectl helloworld hw1 set action=SLOWPATH
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
[2020-12-24 10:43:40.414] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
[2020-12-24 10:43:41.424] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
[2020-12-24 10:43:41.488] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1010ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
[2020-12-24 10:43:42.423] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
[2020-12-24 10:43:43.024] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
[2020-12-24 10:43:43.440] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
[2020-12-24 10:43:43.536] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1017ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl helloworld hw1 set action=DROP
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1018ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1025ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ polycubectl helloworld del hw1
[2020-12-24 10:43:48.454] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-helloworld/test/test1_xdp.sh" time="19.000000" status="Passed"><system-out>[2020-12-24 10:43:50.672] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:43:50.673] [polycubed] [info] configuration parameters: 
[2020-12-24 10:43:50.673] [polycubed] [info]  loglevel: info
[2020-12-24 10:43:50.673] [polycubed] [info]  daemon: false
[2020-12-24 10:43:50.673] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:43:50.673] [polycubed] [info]  port: 9000
[2020-12-24 10:43:50.673] [polycubed] [info]  addr: localhost
[2020-12-24 10:43:50.673] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:43:50.673] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:43:50.673] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:43:50.673] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:43:50.673] [polycubed] [info] polycubed starting...
[2020-12-24 10:43:50.673] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:43:52.868] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:43:52.868] [polycubed] [info] rest server starting ...
[2020-12-24 10:43:52.912] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:43:52.923] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:43:52.937] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:43:52.947] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:43:52.980] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:43:52.990] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:43:53.033] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:43:53.066] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:43:53.101] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:43:53.144] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:43:53.189] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:43:53.211] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:43:53.222] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:43:53.238] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:43:53.247] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:43:53.256] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:43:53.298] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:43:53.346] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:43:53.346] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-helloworld/test/test1.sh XDP_SKB
+ set -e
+ TYPE=TC
+ '[' -n XDP_SKB ']'
+ TYPE=XDP_SKB
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl helloworld add hw1 type=XDP_SKB
[2020-12-24 10:43:55.445] [Helloworld] [hw1] [info] Creating Helloworld instance
+ polycubectl helloworld hw1 ports add port1
[2020-12-24 10:43:55.452] [Helloworld] [hw1] [info] port port1 was connected
+ polycubectl helloworld hw1 ports add port2
[2020-12-24 10:43:55.457] [Helloworld] [hw1] [info] port port2 was connected
+ polycubectl connect hw1:port1 veth1
+ polycubectl connect hw1:port2 veth2
+ polycubectl helloworld hw1 set action=FORWARD
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.046 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.049 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1005ms
rtt min/avg/max/mdev = 0.046/0.047/0.049/0.007 ms
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.026 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.052 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1009ms
rtt min/avg/max/mdev = 0.026/0.039/0.052/0.013 ms
+ polycubectl helloworld hw1 set action=SLOWPATH
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
[2020-12-24 10:44:00.127] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
[2020-12-24 10:44:00.688] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
[2020-12-24 10:44:01.136] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port1
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1009ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
[2020-12-24 10:44:02.136] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
[2020-12-24 10:44:03.152] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
[2020-12-24 10:44:03.248] [Helloworld] [hw1] [info] packet arrived to the slowpath from port port2
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1016ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl helloworld hw1 set action=DROP
+ test_fail sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
+ res='PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1017ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ set +e
++ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
+ res='PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 1024ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ polycubectl helloworld del hw1
[2020-12-24 10:44:08.166] [Helloworld] [hw1] [info] Destroying Helloworld instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-loadbalancer-rp/test/test_weight.sh" time="62.000000" status="Passed"><system-out>[2020-12-24 10:44:09.362] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:44:09.362] [polycubed] [info] configuration parameters: 
[2020-12-24 10:44:09.362] [polycubed] [info]  loglevel: info
[2020-12-24 10:44:09.362] [polycubed] [info]  daemon: false
[2020-12-24 10:44:09.362] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:44:09.362] [polycubed] [info]  port: 9000
[2020-12-24 10:44:09.362] [polycubed] [info]  addr: localhost
[2020-12-24 10:44:09.362] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:44:09.362] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:44:09.362] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:44:09.362] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:44:09.362] [polycubed] [info] polycubed starting...
[2020-12-24 10:44:09.362] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:44:11.601] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:44:11.601] [polycubed] [info] rest server starting ...
[2020-12-24 10:44:11.644] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:44:11.655] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:44:11.670] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:44:11.681] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:44:11.714] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:44:11.725] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:44:11.767] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:44:11.801] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:44:11.836] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:44:11.879] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:44:11.924] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:44:11.947] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:44:11.958] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:44:11.974] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:44:11.984] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:44:11.993] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:44:12.035] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:44:12.083] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:44:12.083] [polycubed] [info] loading metrics from yang files
		#####Test#####		
[2020-12-24 10:44:15.349] [Lbrp] [lb1] [info] Creating Lbrp instance
[2020-12-24 10:44:15.349] [Lbrp] [lb1] [debug] [SrcIpRewrite] Received request to create SrcIpRewrite range  , new ip range  
[2020-12-24 10:44:15.349] [Lbrp] [lb1] [info] [Constructor]Creating SrcIpRewrite instance
[2020-12-24 10:44:15.355] [Lbrp] [lb1] [debug] [Service] Received request to create new service entry
[2020-12-24 10:44:15.355] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:15.360] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:15.360] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:15.360] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:15.365] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:15.365] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:15.365] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:15.370] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:15.370] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:15.370] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:15.374] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:15.374] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:15.374] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:25.382] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:25.382] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:25.382] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:25.386] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:25.386] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:25.387] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:35.394] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:35.394] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:35.394] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:35.400] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:35.400] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:35.400] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:45.406] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.406] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.406] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.411] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.411] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.411] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.416] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.416] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.416] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.420] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.421] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.421] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.424] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.424] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.424] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.428] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.428] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.428] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.433] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.433] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.433] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:45.437] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:45.437] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:45.437] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
[2020-12-24 10:44:55.444] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:55.444] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:55.444] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:55.449] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:55.450] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:55.450] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:55.455] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:55.455] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:55.455] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:44:55.460] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:44:55.460] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:44:55.460] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:45:05.467] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:45:05.467] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:45:05.467] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:45:05.473] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:45:05.473] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:45:05.473] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:45:05.478] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:45:05.478] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:45:05.478] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:45:05.484] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:45:05.484] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:45:05.484] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
There are no entries associated with that key
[2020-12-24 10:45:10.491] [Lbrp] [lb1] [debug] [Service] Received request to read a service entry
[2020-12-24 10:45:10.491] [Lbrp] [lb1] [debug] [Service] Virtual IP: 192.168.0.1, virtual port: 80, protocol: tcp
[2020-12-24 10:45:10.491] [Lbrp] [lb1] [error] [Service] There are no entries associated with that key
{"ietf-restconf:errors":{"error":[{"error-type":"application","error-tag":"data-missing"}]}}
name: lb1
uuid: 3c525bcf-d206-4d31-b856-b28c5c111afb
service-name: lbrp
type: TC
loglevel: TRACE
shadow: false
span: false
src-ip-rewrite:
 ip-range: 
 new_ip_range: 

</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_all_dnat.sh" time="56.000000" status="Failed"><failure type="failure">[2020-12-24 10:45:11.589] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:45:11.590] [polycubed] [info] configuration parameters: 
[2020-12-24 10:45:11.590] [polycubed] [info]  loglevel: info
[2020-12-24 10:45:11.590] [polycubed] [info]  daemon: false
[2020-12-24 10:45:11.590] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:45:11.590] [polycubed] [info]  port: 9000
[2020-12-24 10:45:11.590] [polycubed] [info]  addr: localhost
[2020-12-24 10:45:11.590] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:45:11.590] [polycubed] [info] polycubed starting...
[2020-12-24 10:45:11.590] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:45:13.799] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:45:13.800] [polycubed] [info] rest server starting ...
[2020-12-24 10:45:13.844] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:45:13.855] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:45:13.869] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:45:13.879] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:45:13.912] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:45:13.922] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:45:13.964] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:45:13.997] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:45:14.031] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:45:14.074] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:45:14.118] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:45:14.141] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:45:14.153] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:45:14.168] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:45:14.178] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:45:14.187] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:45:14.228] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:45:14.276] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:45:14.276] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:45:19.061] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:45:20.744] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ce:19:46:29:cc:76 - ip: 10.0.1.254/24]
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: be:8d:99:1d:33:83 - ip: 10.0.2.254/24]
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:45:29.008] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
netcat: connect to 10.0.3.1 port 60123 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ set +e
++ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
[2020-12-24 10:45:44.880] [Nat] [nat1] [info] Dropping packet
+ res='PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2039ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:45:55.175] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:45:55.181] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
[2020-12-24 10:45:57.191] [Router] [r1] [info] ARP reply '10.0.1.1 is at fa:df:fa:74:09:ca'
Connection to 10.0.3.1 60123 port [tcp/*] succeeded!
+ sleep 4
+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:46:02.953] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:46:04.507] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
</failure><system-out>[2020-12-24 10:45:11.589] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:45:11.590] [polycubed] [info] configuration parameters: 
[2020-12-24 10:45:11.590] [polycubed] [info]  loglevel: info
[2020-12-24 10:45:11.590] [polycubed] [info]  daemon: false
[2020-12-24 10:45:11.590] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:45:11.590] [polycubed] [info]  port: 9000
[2020-12-24 10:45:11.590] [polycubed] [info]  addr: localhost
[2020-12-24 10:45:11.590] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:45:11.590] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:45:11.590] [polycubed] [info] polycubed starting...
[2020-12-24 10:45:11.590] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:45:13.799] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:45:13.800] [polycubed] [info] rest server starting ...
[2020-12-24 10:45:13.844] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:45:13.855] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:45:13.869] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:45:13.879] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:45:13.912] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:45:13.922] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:45:13.964] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:45:13.997] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:45:14.031] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:45:14.074] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:45:14.118] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:45:14.141] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:45:14.153] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:45:14.168] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:45:14.178] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:45:14.187] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:45:14.228] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:45:14.276] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:45:14.276] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:45:19.061] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:45:20.744] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ce:19:46:29:cc:76 - ip: 10.0.1.254/24]
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:45:22.435] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: be:8d:99:1d:33:83 - ip: 10.0.2.254/24]
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:45:24.253] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:45:29.008] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
netcat: connect to 10.0.3.1 port 60123 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ set +e
++ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
[2020-12-24 10:45:44.880] [Nat] [nat1] [info] Dropping packet
+ res='PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2039ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:45:55.175] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:45:55.181] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
[2020-12-24 10:45:57.191] [Router] [r1] [info] ARP reply '10.0.1.1 is at fa:df:fa:74:09:ca'
Connection to 10.0.3.1 60123 port [tcp/*] succeeded!
+ sleep 4
+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:46:01.307] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:46:02.953] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:46:04.507] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_all_pf.sh" time="55.000000" status="Failed"><failure type="failure">[2020-12-24 10:46:07.141] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:46:07.142] [polycubed] [info] configuration parameters: 
[2020-12-24 10:46:07.142] [polycubed] [info]  loglevel: info
[2020-12-24 10:46:07.142] [polycubed] [info]  daemon: false
[2020-12-24 10:46:07.142] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:46:07.142] [polycubed] [info]  port: 9000
[2020-12-24 10:46:07.142] [polycubed] [info]  addr: localhost
[2020-12-24 10:46:07.142] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:46:07.142] [polycubed] [info] polycubed starting...
[2020-12-24 10:46:07.142] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:46:09.356] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:46:09.357] [polycubed] [info] rest server starting ...
[2020-12-24 10:46:09.401] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:46:09.412] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:46:09.427] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:46:09.437] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:46:09.471] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:46:09.482] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:46:09.526] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:46:09.561] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:46:09.597] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:46:09.645] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:46:09.694] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:46:09.718] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:46:09.729] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:46:09.745] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:46:09.754] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:46:09.764] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:46:09.807] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:46:09.857] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:46:09.857] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:46:14.588] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:46:16.280] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:46:17.136] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 96:bd:bf:05:66:c5 - ip: 10.0.1.254/24]
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: ca:54:f8:b3:10:83 - ip: 10.0.2.254/24]
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:46:27.120] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
netcat: connect to 10.0.3.1 port 80 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ set +e
++ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
[2020-12-24 10:46:46.576] [Nat] [nat1] [info] Dropping packet
+ res='PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2025ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:46:50.792] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:46:50.799] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule port-forwarding append proto=tcp external-ip=10.0.3.1 external-port=80 internal-ip=10.0.1.1 internal-port=8080
[2020-12-24 10:46:50.805] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:80 -&gt; 10.0.1.1:8080
id: 0

+ polycubectl nat1 rule port-forwarding append proto=udp external-ip=10.0.3.1 external-port=3000 internal-ip=10.0.1.1 internal-port=4000
[2020-12-24 10:46:50.812] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:3000 -&gt; 10.0.1.1:4000
id: 1

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
[2020-12-24 10:46:52.822] [Router] [r1] [info] ARP reply '10.0.1.1 is at 52:9f:a6:e3:c2:97'
Connection to 10.0.3.1 80 port [tcp/*] succeeded!
+ sleep 4
+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:46:58.575] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:47:00.134] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
./../src/services/pcn-nat/test/test_all_pf.sh: line 38:  6067 Terminated              sudo ip netns exec ns1 netcat -l -w 5 $tcp_int_port
</failure><system-out>[2020-12-24 10:46:07.141] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:46:07.142] [polycubed] [info] configuration parameters: 
[2020-12-24 10:46:07.142] [polycubed] [info]  loglevel: info
[2020-12-24 10:46:07.142] [polycubed] [info]  daemon: false
[2020-12-24 10:46:07.142] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:46:07.142] [polycubed] [info]  port: 9000
[2020-12-24 10:46:07.142] [polycubed] [info]  addr: localhost
[2020-12-24 10:46:07.142] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:46:07.142] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:46:07.142] [polycubed] [info] polycubed starting...
[2020-12-24 10:46:07.142] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:46:09.356] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:46:09.357] [polycubed] [info] rest server starting ...
[2020-12-24 10:46:09.401] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:46:09.412] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:46:09.427] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:46:09.437] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:46:09.471] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:46:09.482] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:46:09.526] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:46:09.561] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:46:09.597] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:46:09.645] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:46:09.694] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:46:09.718] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:46:09.729] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:46:09.745] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:46:09.754] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:46:09.764] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:46:09.807] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:46:09.857] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:46:09.857] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:46:14.588] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:46:16.280] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:46:17.136] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 96:bd:bf:05:66:c5 - ip: 10.0.1.254/24]
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:46:17.985] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: ca:54:f8:b3:10:83 - ip: 10.0.2.254/24]
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:46:19.813] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:46:27.120] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
netcat: connect to 10.0.3.1 port 80 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ test_fail sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ set +e
++ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
[2020-12-24 10:46:46.576] [Nat] [nat1] [info] Dropping packet
+ res='PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2025ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:46:50.792] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:46:50.799] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule port-forwarding append proto=tcp external-ip=10.0.3.1 external-port=80 internal-ip=10.0.1.1 internal-port=8080
[2020-12-24 10:46:50.805] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:80 -&gt; 10.0.1.1:8080
id: 0

+ polycubectl nat1 rule port-forwarding append proto=udp external-ip=10.0.3.1 external-port=3000 internal-ip=10.0.1.1 internal-port=4000
[2020-12-24 10:46:50.812] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:3000 -&gt; 10.0.1.1:4000
id: 1

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
[2020-12-24 10:46:52.822] [Router] [r1] [info] ARP reply '10.0.1.1 is at 52:9f:a6:e3:c2:97'
Connection to 10.0.3.1 80 port [tcp/*] succeeded!
+ sleep 4
+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:46:56.942] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:46:58.575] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:47:00.134] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
./../src/services/pcn-nat/test/test_all_pf.sh: line 38:  6067 Terminated              sudo ip netns exec ns1 netcat -l -w 5 $tcp_int_port
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_icmp_dnat.sh" time="41.000000" status="Passed"><system-out>[2020-12-24 10:47:02.777] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:47:02.778] [polycubed] [info] configuration parameters: 
[2020-12-24 10:47:02.778] [polycubed] [info]  loglevel: info
[2020-12-24 10:47:02.778] [polycubed] [info]  daemon: false
[2020-12-24 10:47:02.778] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:47:02.778] [polycubed] [info]  port: 9000
[2020-12-24 10:47:02.778] [polycubed] [info]  addr: localhost
[2020-12-24 10:47:02.778] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:47:02.778] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:47:02.778] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:47:02.778] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:47:02.778] [polycubed] [info] polycubed starting...
[2020-12-24 10:47:02.778] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:47:04.980] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:47:04.980] [polycubed] [info] rest server starting ...
[2020-12-24 10:47:05.024] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:47:05.035] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:47:05.049] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:47:05.059] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:47:05.092] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:47:05.102] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:47:05.144] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:47:05.177] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:47:05.212] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:47:05.254] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:47:05.299] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:47:05.321] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:47:05.332] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:47:05.348] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:47:05.357] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:47:05.366] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:47:05.407] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:47:05.455] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:47:05.455] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:47:10.205] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:47:11.869] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:47:12.944] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:47:13.546] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 6a:59:78:25:af:75 - ip: 10.0.1.254/24]
[2020-12-24 10:47:13.546] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:47:13.546] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:47:15.337] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 2a:9b:fb:33:fe:b4 - ip: 10.0.2.254/24]
[2020-12-24 10:47:15.337] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:47:15.337] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:47:21.392] [Nat] [nat1] [info] Dropping packet
+ test_fail sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ set +e
++ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
+ res='PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 0 received, 100% packet loss, time 2030ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:47:35.111] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ sudo ip netns exec ns2 ping 10.0.3.1 -c 3
[2020-12-24 10:47:35.122] [Router] [r1] [info] ARP reply '10.0.1.1 is at 76:53:12:ca:f1:86'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.424 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.061 ms
64 bytes from 10.0.3.1: icmp_seq=3 ttl=63 time=0.057 ms

--- 10.0.3.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2046ms
rtt min/avg/max/mdev = 0.057/0.180/0.424/0.172 ms
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:47:37.291] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:47:37.291] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:47:37.291] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:47:38.906] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:47:40.454] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_icmp_masq.sh" time="28.000000" status="Passed"><system-out>[2020-12-24 10:47:43.048] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:47:43.048] [polycubed] [info] configuration parameters: 
[2020-12-24 10:47:43.048] [polycubed] [info]  loglevel: info
[2020-12-24 10:47:43.048] [polycubed] [info]  daemon: false
[2020-12-24 10:47:43.048] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:47:43.048] [polycubed] [info]  port: 9000
[2020-12-24 10:47:43.048] [polycubed] [info]  addr: localhost
[2020-12-24 10:47:43.048] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:47:43.048] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:47:43.048] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:47:43.048] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:47:43.048] [polycubed] [info] polycubed starting...
[2020-12-24 10:47:43.048] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:47:45.245] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:47:45.246] [polycubed] [info] rest server starting ...
[2020-12-24 10:47:45.293] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:47:45.303] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:47:45.317] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:47:45.327] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:47:45.359] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:47:45.368] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:47:45.410] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:47:45.442] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:47:45.477] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:47:45.520] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:47:45.564] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:47:45.586] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:47:45.597] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:47:45.613] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:47:45.622] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:47:45.630] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:47:45.672] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:47:45.719] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:47:45.719] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:47:50.505] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:47:52.178] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:47:53.870] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 66:2e:2d:13:c1:52 - ip: 10.0.1.254/24]
[2020-12-24 10:47:53.870] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:47:53.870] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:47:55.674] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 66:43:d9:d3:6c:2e - ip: 10.0.2.254/24]
[2020-12-24 10:47:55.674] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:47:55.674] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:48:00.816] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule masquerade enable
[2020-12-24 10:48:03.402] [Nat] [nat1] [info] Enabled masquerade: 0.0.0.0 -&gt; 10.0.2.254
result: true

+ sudo ip netns exec ns1 ping 10.0.2.1 -c 3
[2020-12-24 10:48:03.445] [Router] [r1] [info] ARP reply '10.0.2.1 is at 3e:0c:ce:f8:d9:89'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.456 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.068 ms
64 bytes from 10.0.2.1: icmp_seq=3 ttl=63 time=0.050 ms

--- 10.0.2.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2043ms
rtt min/avg/max/mdev = 0.050/0.191/0.456/0.187 ms
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:48:05.622] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:48:05.622] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:48:05.622] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:48:07.235] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:48:08.781] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_icmp_snat.sh" time="29.000000" status="Passed"><system-out>[2020-12-24 10:48:11.376] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:48:11.377] [polycubed] [info] configuration parameters: 
[2020-12-24 10:48:11.377] [polycubed] [info]  loglevel: info
[2020-12-24 10:48:11.377] [polycubed] [info]  daemon: false
[2020-12-24 10:48:11.377] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:48:11.377] [polycubed] [info]  port: 9000
[2020-12-24 10:48:11.377] [polycubed] [info]  addr: localhost
[2020-12-24 10:48:11.377] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:48:11.377] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:48:11.377] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:48:11.377] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:48:11.377] [polycubed] [info] polycubed starting...
[2020-12-24 10:48:11.377] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:48:13.576] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:48:13.576] [polycubed] [info] rest server starting ...
[2020-12-24 10:48:13.621] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:48:13.632] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:48:13.647] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:48:13.657] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:48:13.691] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:48:13.702] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:48:13.745] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:48:13.779] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:48:13.815] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:48:13.859] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:48:13.905] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:48:13.928] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:48:13.939] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:48:13.955] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:48:13.964] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:48:13.973] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:48:14.015] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:48:14.064] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:48:14.065] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:48:18.798] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:48:20.476] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:48:22.153] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ea:c6:66:7f:fa:2e - ip: 10.0.1.254/24]
[2020-12-24 10:48:22.153] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:48:22.153] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:48:23.975] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 52:08:0a:19:db:83 - ip: 10.0.2.254/24]
[2020-12-24 10:48:23.975] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:48:23.975] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:48:30.256] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule snat append internal-net=10.0.1.0/24 external-ip=10.0.2.254
[2020-12-24 10:48:31.755] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.0/24 -&gt; 10.0.2.254
id: 0

+ sudo ip netns exec ns1 ping 10.0.2.1 -c 3
[2020-12-24 10:48:31.766] [Router] [r1] [info] ARP reply '10.0.2.1 is at a2:69:e8:56:f6:42'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.513 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.068 ms
64 bytes from 10.0.2.1: icmp_seq=3 ttl=63 time=0.061 ms

--- 10.0.2.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2042ms
rtt min/avg/max/mdev = 0.061/0.214/0.513/0.211 ms
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:48:33.913] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:48:33.913] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:48:33.913] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:48:35.541] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:48:37.083] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_tcp_dnat.sh" time="44.000000" status="Passed"><system-out>[2020-12-24 10:48:40.677] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:48:40.678] [polycubed] [info] configuration parameters: 
[2020-12-24 10:48:40.678] [polycubed] [info]  loglevel: info
[2020-12-24 10:48:40.678] [polycubed] [info]  daemon: false
[2020-12-24 10:48:40.678] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:48:40.678] [polycubed] [info]  port: 9000
[2020-12-24 10:48:40.678] [polycubed] [info]  addr: localhost
[2020-12-24 10:48:40.678] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:48:40.678] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:48:40.678] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:48:40.678] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:48:40.678] [polycubed] [info] polycubed starting...
[2020-12-24 10:48:40.678] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:48:42.862] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:48:42.863] [polycubed] [info] rest server starting ...
[2020-12-24 10:48:42.908] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:48:42.919] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:48:42.933] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:48:42.943] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:48:42.976] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:48:42.986] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:48:43.028] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:48:43.061] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:48:43.095] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:48:43.138] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:48:43.182] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:48:43.205] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:48:43.216] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:48:43.232] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:48:43.242] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:48:43.251] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:48:43.293] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:48:43.341] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:48:43.341] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:48:48.141] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:48:49.830] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:48:50.480] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:48:51.525] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: fe:b8:93:59:ff:53 - ip: 10.0.1.254/24]
[2020-12-24 10:48:51.525] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:48:51.525] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:48:53.339] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 72:7c:0b:e4:02:3a - ip: 10.0.2.254/24]
[2020-12-24 10:48:53.339] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:48:53.340] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:48:57.648] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
netcat: connect to 10.0.3.1 port 60123 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:49:12.110] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 60123
[2020-12-24 10:49:13.264] [Nat] [nat1] [info] Dropping packet
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 60123
[2020-12-24 10:49:14.121] [Router] [r1] [info] ARP reply '10.0.1.1 is at 02:4e:13:c7:ae:7b'
Connection to 10.0.3.1 60123 port [tcp/*] succeeded!
+ sleep 4
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:49:18.255] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:49:18.255] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:49:18.255] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:49:19.872] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:49:21.416] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
./../src/services/pcn-nat/test/test_tcp_dnat.sh: line 31:  7018 Terminated              sudo ip netns exec ns1 netcat -l -w 5 $tcp_port
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_tcp_masq.sh" time="34.000000" status="Passed"><system-out>[2020-12-24 10:49:24.052] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:49:24.053] [polycubed] [info] configuration parameters: 
[2020-12-24 10:49:24.053] [polycubed] [info]  loglevel: info
[2020-12-24 10:49:24.053] [polycubed] [info]  daemon: false
[2020-12-24 10:49:24.053] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:49:24.053] [polycubed] [info]  port: 9000
[2020-12-24 10:49:24.053] [polycubed] [info]  addr: localhost
[2020-12-24 10:49:24.053] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:49:24.053] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:49:24.053] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:49:24.053] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:49:24.053] [polycubed] [info] polycubed starting...
[2020-12-24 10:49:24.053] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:49:26.250] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:49:26.250] [polycubed] [info] rest server starting ...
[2020-12-24 10:49:26.293] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:49:26.304] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:49:26.319] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:49:26.329] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:49:26.362] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:49:26.373] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:49:26.417] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:49:26.450] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:49:26.486] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:49:26.530] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:49:26.576] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:49:26.599] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:49:26.611] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:49:26.627] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:49:26.636] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:49:26.646] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:49:26.689] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:49:26.738] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:49:26.738] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:49:31.477] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:49:33.157] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:49:33.744] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:49:34.850] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: d6:a9:35:e8:15:60 - ip: 10.0.1.254/24]
[2020-12-24 10:49:34.850] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:49:34.850] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:49:36.658] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 06:79:77:3a:01:03 - ip: 10.0.2.254/24]
[2020-12-24 10:49:36.658] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:49:36.658] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:49:41.168] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule masquerade enable
[2020-12-24 10:49:44.476] [Nat] [nat1] [info] Enabled masquerade: 0.0.0.0 -&gt; 10.0.2.254
result: true

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns2 netcat -l -w 5 60123
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 1
[2020-12-24 10:49:46.488] [Router] [r1] [info] ARP reply '10.0.2.1 is at 2e:e2:19:f2:53:72'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.542 ms

--- 10.0.2.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.542/0.542/0.542/0.000 ms
+ sleep 2
+ sudo ip netns exec ns1 netcat -w 5 -nvz 10.0.2.1 60123
Connection to 10.0.2.1 60123 port [tcp/*] succeeded!
+ sleep 4
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:49:52.614] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:49:52.614] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:49:52.614] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:49:54.244] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:49:55.788] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_tcp_pf.sh" time="44.000000" status="Passed"><system-out>[2020-12-24 10:49:58.428] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:49:58.429] [polycubed] [info] configuration parameters: 
[2020-12-24 10:49:58.429] [polycubed] [info]  loglevel: info
[2020-12-24 10:49:58.429] [polycubed] [info]  daemon: false
[2020-12-24 10:49:58.429] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:49:58.429] [polycubed] [info]  port: 9000
[2020-12-24 10:49:58.429] [polycubed] [info]  addr: localhost
[2020-12-24 10:49:58.429] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:49:58.429] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:49:58.429] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:49:58.429] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:49:58.429] [polycubed] [info] polycubed starting...
[2020-12-24 10:49:58.429] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:50:00.641] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:50:00.642] [polycubed] [info] rest server starting ...
[2020-12-24 10:50:00.688] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:50:00.699] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:50:00.714] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:50:00.724] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:50:00.758] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:50:00.768] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:50:00.812] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:50:00.845] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:50:00.881] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:50:00.925] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:50:00.970] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:50:00.994] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:50:01.005] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:50:01.021] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:50:01.030] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:50:01.039] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:50:01.082] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:50:01.131] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:50:01.131] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:50:05.862] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:50:07.538] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:50:08.816] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:50:09.227] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ce:e2:5f:81:6a:0a - ip: 10.0.1.254/24]
[2020-12-24 10:50:09.227] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:50:09.227] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:50:11.060] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 12:4f:89:a7:56:da - ip: 10.0.2.254/24]
[2020-12-24 10:50:11.060] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:50:11.060] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:50:16.752] [Nat] [nat1] [info] Dropping packet
+ test_tcp_fail
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ test_fail sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
+ set +e
++ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
netcat: connect to 10.0.3.1 port 80 (tcp) timed out: Operation now in progress
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ sleep 4
+ polycubectl nat1 rule port-forwarding append external-ip=10.0.3.1 external-port=80 internal-ip=10.0.1.1 internal-port=8080
[2020-12-24 10:50:29.940] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:80 -&gt; 10.0.1.1:8080
id: 0

+ test_tcp
+ sleep 2
+ sudo ip netns exec ns1 netcat -l -w 5 8080
+ sudo ip netns exec ns2 netcat -w 5 -nvz 10.0.3.1 80
[2020-12-24 10:50:31.950] [Router] [r1] [info] ARP reply '10.0.1.1 is at be:f7:3e:79:1e:fa'
Connection to 10.0.3.1 80 port [tcp/*] succeeded!
+ sleep 4
[2020-12-24 10:50:33.904] [Nat] [nat1] [info] Dropping packet
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:50:36.063] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:50:36.063] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:50:36.063] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:50:37.718] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:50:39.293] [Router] [r1] [info] Destroying Router instance
+ sudo pkill -SIGTERM netcat
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_udp_dnat.sh" time="28.000000" status="Failed"><failure type="failure">[2020-12-24 10:50:42.923] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:50:42.923] [polycubed] [info] configuration parameters: 
[2020-12-24 10:50:42.923] [polycubed] [info]  loglevel: info
[2020-12-24 10:50:42.923] [polycubed] [info]  daemon: false
[2020-12-24 10:50:42.923] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:50:42.923] [polycubed] [info]  port: 9000
[2020-12-24 10:50:42.923] [polycubed] [info]  addr: localhost
[2020-12-24 10:50:42.923] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:50:42.923] [polycubed] [info] polycubed starting...
[2020-12-24 10:50:42.923] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:50:45.137] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:50:45.138] [polycubed] [info] rest server starting ...
[2020-12-24 10:50:45.185] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:50:45.196] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:50:45.210] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:50:45.220] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:50:45.255] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:50:45.265] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:50:45.309] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:50:45.343] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:50:45.379] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:50:45.423] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:50:45.469] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:50:45.493] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:50:45.504] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:50:45.520] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:50:45.530] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:50:45.539] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:50:45.583] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:50:45.632] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:50:45.632] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:50:50.366] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:50:52.052] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:50:52.592] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: da:01:d2:2d:46:41 - ip: 10.0.1.254/24]
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 8a:b0:fb:c7:1c:c6 - ip: 10.0.2.254/24]
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:01.552] [Nat] [nat1] [info] Dropping packet
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:51:03.436] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:51:03.442] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:03.562] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:03.563] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:03.563] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:05.190] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:51:06.754] [Router] [r1] [info] Destroying Router instance
</failure><system-out>[2020-12-24 10:50:42.923] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:50:42.923] [polycubed] [info] configuration parameters: 
[2020-12-24 10:50:42.923] [polycubed] [info]  loglevel: info
[2020-12-24 10:50:42.923] [polycubed] [info]  daemon: false
[2020-12-24 10:50:42.923] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:50:42.923] [polycubed] [info]  port: 9000
[2020-12-24 10:50:42.923] [polycubed] [info]  addr: localhost
[2020-12-24 10:50:42.923] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:50:42.923] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:50:42.923] [polycubed] [info] polycubed starting...
[2020-12-24 10:50:42.923] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:50:45.137] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:50:45.138] [polycubed] [info] rest server starting ...
[2020-12-24 10:50:45.185] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:50:45.196] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:50:45.210] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:50:45.220] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:50:45.255] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:50:45.265] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:50:45.309] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:50:45.343] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:50:45.379] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:50:45.423] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:50:45.469] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:50:45.493] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:50:45.504] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:50:45.520] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:50:45.530] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:50:45.539] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:50:45.583] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:50:45.632] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:50:45.632] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:50:50.366] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:50:52.052] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:50:52.592] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: da:01:d2:2d:46:41 - ip: 10.0.1.254/24]
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:50:53.748] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 8a:b0:fb:c7:1c:c6 - ip: 10.0.2.254/24]
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:50:55.554] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:01.552] [Nat] [nat1] [info] Dropping packet
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:51:03.436] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule dnat append external-ip=10.0.3.1 internal-ip=10.0.1.1
[2020-12-24 10:51:03.442] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.3.1 -&gt; 10.0.1.1
id: 0

+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:03.562] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:03.563] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:03.563] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:05.190] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:51:06.754] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_udp_masq.sh" time="27.000000" status="Failed"><failure type="failure">[2020-12-24 10:51:10.348] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:51:10.349] [polycubed] [info] configuration parameters: 
[2020-12-24 10:51:10.349] [polycubed] [info]  loglevel: info
[2020-12-24 10:51:10.349] [polycubed] [info]  daemon: false
[2020-12-24 10:51:10.349] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:51:10.349] [polycubed] [info]  port: 9000
[2020-12-24 10:51:10.349] [polycubed] [info]  addr: localhost
[2020-12-24 10:51:10.349] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:51:10.349] [polycubed] [info] polycubed starting...
[2020-12-24 10:51:10.349] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:51:12.556] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:51:12.556] [polycubed] [info] rest server starting ...
[2020-12-24 10:51:12.600] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:51:12.611] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:51:12.625] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:51:12.634] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:51:12.666] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:51:12.676] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:51:12.718] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:51:12.750] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:51:12.785] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:51:12.827] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:51:12.871] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:51:12.894] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:51:12.905] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:51:12.921] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:51:12.930] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:51:12.939] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:51:12.981] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:51:13.029] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:51:13.029] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:51:17.778] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:51:19.449] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:51:19.984] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 1e:50:51:79:cd:38 - ip: 10.0.1.254/24]
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 3a:7e:08:96:3c:6c - ip: 10.0.2.254/24]
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:29.200] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule dnat append external-ip=10.0.2.254 internal-ip=10.0.1.1
[2020-12-24 10:51:30.737] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.2.254 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule masquerade enable
[2020-12-24 10:51:30.743] [Nat] [nat1] [info] Enabled masquerade: 0.0.0.0 -&gt; 10.0.2.254
result: true

+ test_udp
++ sudo ip netns exec ns1 nping --udp -c 1 -p 3000 --source-port 50000 10.0.2.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:30.926] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:30.927] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:30.927] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:32.538] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:51:34.081] [Router] [r1] [info] Destroying Router instance
</failure><system-out>[2020-12-24 10:51:10.348] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:51:10.349] [polycubed] [info] configuration parameters: 
[2020-12-24 10:51:10.349] [polycubed] [info]  loglevel: info
[2020-12-24 10:51:10.349] [polycubed] [info]  daemon: false
[2020-12-24 10:51:10.349] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:51:10.349] [polycubed] [info]  port: 9000
[2020-12-24 10:51:10.349] [polycubed] [info]  addr: localhost
[2020-12-24 10:51:10.349] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:51:10.349] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:51:10.349] [polycubed] [info] polycubed starting...
[2020-12-24 10:51:10.349] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:51:12.556] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:51:12.556] [polycubed] [info] rest server starting ...
[2020-12-24 10:51:12.600] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:51:12.611] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:51:12.625] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:51:12.634] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:51:12.666] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:51:12.676] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:51:12.718] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:51:12.750] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:51:12.785] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:51:12.827] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:51:12.871] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:51:12.894] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:51:12.905] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:51:12.921] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:51:12.930] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:51:12.939] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:51:12.981] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:51:13.029] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:51:13.029] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:51:17.778] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:51:19.449] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:51:19.984] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 1e:50:51:79:cd:38 - ip: 10.0.1.254/24]
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:51:21.135] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 3a:7e:08:96:3c:6c - ip: 10.0.2.254/24]
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:51:22.941] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:29.200] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule dnat append external-ip=10.0.2.254 internal-ip=10.0.1.1
[2020-12-24 10:51:30.737] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.2.254 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule masquerade enable
[2020-12-24 10:51:30.743] [Nat] [nat1] [info] Enabled masquerade: 0.0.0.0 -&gt; 10.0.2.254
result: true

+ test_udp
++ sudo ip netns exec ns1 nping --udp -c 1 -p 3000 --source-port 50000 10.0.2.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:30.926] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:30.927] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:30.927] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:32.538] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:51:34.081] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_udp_pf.sh" time="28.000000" status="Failed"><failure type="failure">[2020-12-24 10:51:37.689] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:51:37.690] [polycubed] [info] configuration parameters: 
[2020-12-24 10:51:37.690] [polycubed] [info]  loglevel: info
[2020-12-24 10:51:37.690] [polycubed] [info]  daemon: false
[2020-12-24 10:51:37.690] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:51:37.690] [polycubed] [info]  port: 9000
[2020-12-24 10:51:37.690] [polycubed] [info]  addr: localhost
[2020-12-24 10:51:37.690] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:51:37.690] [polycubed] [info] polycubed starting...
[2020-12-24 10:51:37.690] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:51:39.899] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:51:39.899] [polycubed] [info] rest server starting ...
[2020-12-24 10:51:39.944] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:51:39.955] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:51:39.970] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:51:39.981] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:51:40.014] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:51:40.025] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:51:40.067] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:51:40.100] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:51:40.135] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:51:40.178] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:51:40.222] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:51:40.245] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:51:40.256] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:51:40.271] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:51:40.281] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:51:40.290] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:51:40.331] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:51:40.379] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:51:40.379] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:51:45.137] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:51:46.812] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:51:47.376] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 6a:8c:b2:0e:d0:08 - ip: 10.0.1.254/24]
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 02:43:cb:5a:4a:4e - ip: 10.0.2.254/24]
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:54.800] [Nat] [nat1] [info] Dropping packet
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:51:58.193] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule port-forwarding append external-ip=10.0.3.1 external-port=3000 internal-ip=10.0.1.1 internal-port=4000
[2020-12-24 10:51:58.199] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:3000 -&gt; 10.0.1.1:4000
id: 0

+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:59.950] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:52:01.494] [Router] [r1] [info] Destroying Router instance
</failure><system-out>[2020-12-24 10:51:37.689] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:51:37.690] [polycubed] [info] configuration parameters: 
[2020-12-24 10:51:37.690] [polycubed] [info]  loglevel: info
[2020-12-24 10:51:37.690] [polycubed] [info]  daemon: false
[2020-12-24 10:51:37.690] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:51:37.690] [polycubed] [info]  port: 9000
[2020-12-24 10:51:37.690] [polycubed] [info]  addr: localhost
[2020-12-24 10:51:37.690] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:51:37.690] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:51:37.690] [polycubed] [info] polycubed starting...
[2020-12-24 10:51:37.690] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:51:39.899] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:51:39.899] [polycubed] [info] rest server starting ...
[2020-12-24 10:51:39.944] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:51:39.955] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:51:39.970] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:51:39.981] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:51:40.014] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:51:40.025] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:51:40.067] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:51:40.100] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:51:40.135] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:51:40.178] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:51:40.222] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:51:40.245] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:51:40.256] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:51:40.271] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:51:40.281] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:51:40.290] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:51:40.331] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:51:40.379] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:51:40.379] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:51:45.137] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:51:46.812] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:51:47.376] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 6a:8c:b2:0e:d0:08 - ip: 10.0.1.254/24]
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:51:48.503] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: 02:43:cb:5a:4a:4e - ip: 10.0.2.254/24]
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:51:50.335] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:51:54.800] [Nat] [nat1] [info] Dropping packet
+ test_fail test_udp
+ set +e
++ test_udp
+++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
++ npingOutput=
++ [[ '' != *\R\c\v\d\:\ \1* ]]
++ exit 1
+ res=
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ polycubectl nat1 rule snat append internal-net=10.0.1.1/32 external-ip=10.0.3.1
[2020-12-24 10:51:58.193] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.1/32 -&gt; 10.0.3.1
id: 0

+ polycubectl nat1 rule port-forwarding append external-ip=10.0.3.1 external-port=3000 internal-ip=10.0.1.1 internal-port=4000
[2020-12-24 10:51:58.199] [Nat] [nat1] [info] Creating RulePortForwardingEntry instance: 10.0.3.1:3000 -&gt; 10.0.1.1:4000
id: 0

+ test_udp
++ sudo ip netns exec ns2 nping --udp -c 1 -p 3000 --source-port 50000 10.0.3.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:51:58.302] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:51:59.950] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:52:01.494] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-nat/test/test_udp_snat.sh" time="27.000000" status="Failed"><failure type="failure">[2020-12-24 10:52:05.095] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:52:05.095] [polycubed] [info] configuration parameters: 
[2020-12-24 10:52:05.095] [polycubed] [info]  loglevel: info
[2020-12-24 10:52:05.095] [polycubed] [info]  daemon: false
[2020-12-24 10:52:05.095] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:52:05.095] [polycubed] [info]  port: 9000
[2020-12-24 10:52:05.095] [polycubed] [info]  addr: localhost
[2020-12-24 10:52:05.095] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:52:05.095] [polycubed] [info] polycubed starting...
[2020-12-24 10:52:05.095] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:52:07.289] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:52:07.289] [polycubed] [info] rest server starting ...
[2020-12-24 10:52:07.332] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:52:07.343] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:52:07.357] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:52:07.366] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:52:07.399] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:52:07.409] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:52:07.451] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:52:07.484] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:52:07.518] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:52:07.561] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:52:07.605] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:52:07.627] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:52:07.638] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:52:07.653] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:52:07.662] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:52:07.671] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:52:07.712] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:52:07.759] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:52:07.759] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:52:12.533] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:52:14.195] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:52:15.024] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 2a:71:ba:77:c1:6f - ip: 10.0.1.254/24]
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: da:0b:54:92:6d:91 - ip: 10.0.2.254/24]
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:52:23.728] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule dnat append external-ip=10.0.2.254 internal-ip=10.0.1.1
[2020-12-24 10:52:25.416] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.2.254 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule snat append internal-net=10.0.1.0/24 external-ip=10.0.2.254
[2020-12-24 10:52:25.421] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.0/24 -&gt; 10.0.2.254
id: 0

+ test_udp
++ sudo ip netns exec ns1 nping --udp -c 1 -p 3000 --source-port 50000 10.0.2.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:52:27.198] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:52:28.733] [Router] [r1] [info] Destroying Router instance
</failure><system-out>[2020-12-24 10:52:05.095] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:52:05.095] [polycubed] [info] configuration parameters: 
[2020-12-24 10:52:05.095] [polycubed] [info]  loglevel: info
[2020-12-24 10:52:05.095] [polycubed] [info]  daemon: false
[2020-12-24 10:52:05.095] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:52:05.095] [polycubed] [info]  port: 9000
[2020-12-24 10:52:05.095] [polycubed] [info]  addr: localhost
[2020-12-24 10:52:05.095] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:52:05.095] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:52:05.095] [polycubed] [info] polycubed starting...
[2020-12-24 10:52:05.095] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:52:07.289] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:52:07.289] [polycubed] [info] rest server starting ...
[2020-12-24 10:52:07.332] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:52:07.343] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:52:07.357] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:52:07.366] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:52:07.399] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:52:07.409] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:52:07.451] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:52:07.484] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:52:07.518] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:52:07.561] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:52:07.605] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:52:07.627] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:52:07.638] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:52:07.653] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:52:07.662] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:52:07.671] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:52:07.712] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:52:07.759] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:52:07.759] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth_net 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ polycubectl nat add nat1
[2020-12-24 10:52:12.533] [Nat] [nat1] [info] Creating Nat instance
+ polycubectl router add r1
[2020-12-24 10:52:14.195] [Router] [r1] [info] Creating Router instance
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24 peer=veth1
[2020-12-24 10:52:15.024] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 2a:71:ba:77:c1:6f - ip: 10.0.1.254/24]
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:52:15.872] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24 peer=veth2
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: da:0b:54:92:6d:91 - ip: 10.0.2.254/24]
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:52:17.682] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ polycubectl attach nat1 r1:to_veth2 position=first
[2020-12-24 10:52:23.728] [Nat] [nat1] [info] Dropping packet
+ polycubectl nat1 rule dnat append external-ip=10.0.2.254 internal-ip=10.0.1.1
[2020-12-24 10:52:25.416] [Nat] [nat1] [info] Creating RuleDnatEntry instance: 10.0.2.254 -&gt; 10.0.1.1
id: 0

+ polycubectl nat1 rule snat append internal-net=10.0.1.0/24 external-ip=10.0.2.254
[2020-12-24 10:52:25.421] [Nat] [nat1] [info] Creating RuleSnatEntry instance: 10.0.1.0/24 -&gt; 10.0.2.254
id: 0

+ test_udp
++ sudo ip netns exec ns1 nping --udp -c 1 -p 3000 --source-port 50000 10.0.2.1
exec of "nping" failed: No such file or directory
+ npingOutput=
+ cleanup
+ set +e
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ polycubectl nat del nat1
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all PortForwarding rules
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all DNAT rules
[2020-12-24 10:52:25.567] [Nat] [nat1] [info] Removed all SNAT rules
[2020-12-24 10:52:27.198] [polycubed] [warning] Unable to get link veth2
+ polycubectl router del r1
[2020-12-24 10:52:28.733] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-packetcapture/test/test_packetcapture.sh" time="18.000000" status="Passed"><system-out>[2020-12-24 10:52:32.324] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:52:32.325] [polycubed] [info] configuration parameters: 
[2020-12-24 10:52:32.325] [polycubed] [info]  loglevel: info
[2020-12-24 10:52:32.325] [polycubed] [info]  daemon: false
[2020-12-24 10:52:32.325] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:52:32.325] [polycubed] [info]  port: 9000
[2020-12-24 10:52:32.325] [polycubed] [info]  addr: localhost
[2020-12-24 10:52:32.325] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:52:32.325] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:52:32.325] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:52:32.325] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:52:32.325] [polycubed] [info] polycubed starting...
[2020-12-24 10:52:32.325] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:52:34.516] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:52:34.516] [polycubed] [info] rest server starting ...
[2020-12-24 10:52:34.560] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:52:34.571] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:52:34.585] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:52:34.595] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:52:34.629] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:52:34.639] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:52:34.682] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:52:34.716] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:52:34.751] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:52:34.795] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:52:34.840] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:52:34.863] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:52:34.874] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:52:34.890] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:52:34.898] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:52:34.907] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:52:34.949] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:52:34.997] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:52:34.997] [polycubed] [info] loading metrics from yang files
+ trap cleanup EXIT
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns del ns1
Cannot remove namespace file "/var/run/netns/ns1": No such file or directory
+ true
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns del ns2
Cannot remove namespace file "/var/run/netns/ns2": No such file or directory
+ true
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl packetcapture add packetcapture_service capture=bidirectional
[2020-12-24 10:52:38.139] [Packetcapture] [packetcapture_service] [info] Creating Packetcapture instance
+ polycubectl simplebridge add br1
[2020-12-24 10:52:40.420] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:52:40.420] [Simplebridge] [br1] [info] Creating Fdb instance
+ polycubectl br1 ports add toveth1
+ polycubectl connect br1:toveth1 veth1
+ polycubectl br1 ports add toveth2 peer=veth2
+ sleep 2
+ polycubectl attach packetcapture_service br1:toveth1
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 1
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.181 ms

--- 10.0.0.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.181/0.181/0.181/0.000 ms
++ polycubectl packetcapture_service show dump
++ cut -d ' ' -f 4-
+ sudo rm -f
+ polycubectl detach packetcapture_service br1:toveth1
+ polycubectl del packetcapture_service
[2020-12-24 10:52:49.010] [Packetcapture] [packetcapture_service] [info] Destroying Packetcapture instance
+ polycubectl del br1
[2020-12-24 10:52:49.016] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ set +x
SUCCESS
</system-out></testcase><testcase name="./../src/services/pcn-pbforwarder/test/test23_30.sh" time="41.000000" status="Passed"><system-out>[2020-12-24 10:52:50.600] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:52:50.600] [polycubed] [info] configuration parameters: 
[2020-12-24 10:52:50.600] [polycubed] [info]  loglevel: info
[2020-12-24 10:52:50.600] [polycubed] [info]  daemon: false
[2020-12-24 10:52:50.600] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:52:50.600] [polycubed] [info]  port: 9000
[2020-12-24 10:52:50.600] [polycubed] [info]  addr: localhost
[2020-12-24 10:52:50.600] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:52:50.600] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:52:50.600] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:52:50.600] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:52:50.600] [polycubed] [info] polycubed starting...
[2020-12-24 10:52:50.600] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:52:52.811] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:52:52.812] [polycubed] [info] rest server starting ...
[2020-12-24 10:52:52.856] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:52:52.867] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:52:52.882] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:52:52.892] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:52:52.926] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:52:52.936] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:52:52.979] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:52:53.012] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:52:53.047] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:52:53.090] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:52:53.135] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:52:53.157] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:52:53.169] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:52:53.185] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:52:53.194] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:52:53.203] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:52:53.245] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:52:53.293] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:52:53.293] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ip netns exec ns1 ip -s neigh flush all
Nothing to flush.
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ sudo ip netns exec ns2 ip -s neigh flush all
Nothing to flush.
+ add_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder add pbf1
[2020-12-24 10:52:55.960] [Pbforwarder] [pbf1] [info] Creating Pbforwarder instance
+ pbforwarder_add_port pbf1 veth1
+ polycubectl pbforwarder pbf1 ports add veth1
[2020-12-24 10:52:55.967] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth1 set peer=veth1
+ pbforwarder_add_port pbf1 veth2
+ polycubectl pbforwarder pbf1 ports add veth2
[2020-12-24 10:52:57.138] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth2 set peer=veth2
+ pbforwarder_add_rules_l2 0 13 pbf1
++ seq 0 13
+ for i in `seq $1 $2`
+ number=0
+ [[ 1 -lt 2 ]]
+ number=000
+ number=00
+ polycubectl pbforwarder pbf1 rules add 0 src_mac=00:00:00:00:11:00 action=DROP
[2020-12-24 10:52:58.422] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=1
+ [[ 1 -lt 2 ]]
+ number=001
+ number=01
+ polycubectl pbforwarder pbf1 rules add 1 src_mac=00:00:00:00:11:01 action=DROP
[2020-12-24 10:52:59.311] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=2
+ [[ 1 -lt 2 ]]
+ number=002
+ number=02
+ polycubectl pbforwarder pbf1 rules add 2 src_mac=00:00:00:00:11:02 action=DROP
[2020-12-24 10:53:00.197] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=3
+ [[ 1 -lt 2 ]]
+ number=003
+ number=03
+ polycubectl pbforwarder pbf1 rules add 3 src_mac=00:00:00:00:11:03 action=DROP
[2020-12-24 10:53:01.085] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=4
+ [[ 1 -lt 2 ]]
+ number=004
+ number=04
+ polycubectl pbforwarder pbf1 rules add 4 src_mac=00:00:00:00:11:04 action=DROP
[2020-12-24 10:53:01.976] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=5
+ [[ 1 -lt 2 ]]
+ number=005
+ number=05
+ polycubectl pbforwarder pbf1 rules add 5 src_mac=00:00:00:00:11:05 action=DROP
[2020-12-24 10:53:02.867] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=6
+ [[ 1 -lt 2 ]]
+ number=006
+ number=06
+ polycubectl pbforwarder pbf1 rules add 6 src_mac=00:00:00:00:11:06 action=DROP
[2020-12-24 10:53:03.768] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=7
+ [[ 1 -lt 2 ]]
+ number=007
+ number=07
+ polycubectl pbforwarder pbf1 rules add 7 src_mac=00:00:00:00:11:07 action=DROP
[2020-12-24 10:53:04.670] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=8
+ [[ 1 -lt 2 ]]
+ number=008
+ number=08
+ polycubectl pbforwarder pbf1 rules add 8 src_mac=00:00:00:00:11:08 action=DROP
[2020-12-24 10:53:05.572] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=9
+ [[ 1 -lt 2 ]]
+ number=009
+ number=09
+ polycubectl pbforwarder pbf1 rules add 9 src_mac=00:00:00:00:11:09 action=DROP
[2020-12-24 10:53:06.482] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=10
+ [[ 2 -lt 2 ]]
+ polycubectl pbforwarder pbf1 rules add 10 src_mac=00:00:00:00:11:10 action=DROP
[2020-12-24 10:53:07.392] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=11
+ [[ 2 -lt 2 ]]
+ polycubectl pbforwarder pbf1 rules add 11 src_mac=00:00:00:00:11:11 action=DROP
[2020-12-24 10:53:08.307] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=12
+ [[ 2 -lt 2 ]]
+ polycubectl pbforwarder pbf1 rules add 12 src_mac=00:00:00:00:11:12 action=DROP
[2020-12-24 10:53:09.227] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=13
+ [[ 2 -lt 2 ]]
+ polycubectl pbforwarder pbf1 rules add 13 src_mac=00:00:00:00:11:13 action=DROP
[2020-12-24 10:53:10.149] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ pbforwarder_add_rules_l3 13 26 pbf1
++ seq 13 26
+ for i in `seq $1 $2`
+ number=13
+ polycubectl pbforwarder pbf1 rules add 13 src_ip=10.9.8.13 action=DROP
[2020-12-24 10:53:11.082] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:11.082] [Pbforwarder] [pbf1] [info] [pbf1] Switching to level 3.
+ for i in `seq $1 $2`
+ number=14
+ polycubectl pbforwarder pbf1 rules add 14 src_ip=10.9.8.14 action=DROP
[2020-12-24 10:53:12.045] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=15
+ polycubectl pbforwarder pbf1 rules add 15 src_ip=10.9.8.15 action=DROP
[2020-12-24 10:53:13.019] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=16
+ polycubectl pbforwarder pbf1 rules add 16 src_ip=10.9.8.16 action=DROP
[2020-12-24 10:53:13.996] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=17
+ polycubectl pbforwarder pbf1 rules add 17 src_ip=10.9.8.17 action=DROP
[2020-12-24 10:53:14.985] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=18
+ polycubectl pbforwarder pbf1 rules add 18 src_ip=10.9.8.18 action=DROP
[2020-12-24 10:53:15.976] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=19
+ polycubectl pbforwarder pbf1 rules add 19 src_ip=10.9.8.19 action=DROP
[2020-12-24 10:53:16.973] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=20
+ polycubectl pbforwarder pbf1 rules add 20 src_ip=10.9.8.20 action=DROP
[2020-12-24 10:53:17.971] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=21
+ polycubectl pbforwarder pbf1 rules add 21 src_ip=10.9.8.21 action=DROP
[2020-12-24 10:53:18.977] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=22
+ polycubectl pbforwarder pbf1 rules add 22 src_ip=10.9.8.22 action=DROP
[2020-12-24 10:53:19.993] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=23
+ polycubectl pbforwarder pbf1 rules add 23 src_ip=10.9.8.23 action=DROP
[2020-12-24 10:53:21.017] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=24
+ polycubectl pbforwarder pbf1 rules add 24 src_ip=10.9.8.24 action=DROP
[2020-12-24 10:53:22.046] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=25
+ polycubectl pbforwarder pbf1 rules add 25 src_ip=10.9.8.25 action=DROP
[2020-12-24 10:53:23.089] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ for i in `seq $1 $2`
+ number=26
+ polycubectl pbforwarder pbf1 rules add 26 src_ip=10.9.8.26 action=DROP
[2020-12-24 10:53:24.125] [Pbforwarder] [pbf1] [info] Creating Rules instance
++ LANG=C
++ sudo ip netns exec ns1 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth1_mac=fe:c6:64:f3:40:6a
++ LANG=C
++ sudo ip netns exec ns2 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth2_mac=ea:26:b8:bf:50:71
+ polycubectl pbforwarder pbf1 rules add 26 src_ip=10.0.0.1 dst_ip=10.0.0.2 action=FORWARD out_port=veth2
[2020-12-24 10:53:25.227] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ polycubectl pbforwarder pbf1 rules add 27 src_ip=10.0.0.2 dst_ip=10.0.0.1 action=FORWARD out_port=veth1
[2020-12-24 10:53:26.272] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ polycubectl pbforwarder pbf1 rules add 28 dst_mac=FF:FF:FF:FF:FF:FF action=FORWARD out_port=veth2
[2020-12-24 10:53:27.325] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ polycubectl pbforwarder pbf1 rules add 29 dst_mac=fe:c6:64:f3:40:6a action=FORWARD out_port=veth1
[2020-12-24 10:53:28.386] [Pbforwarder] [pbf1] [info] Creating Rules instance
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.053 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.059 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1023ms
rtt min/avg/max/mdev = 0.053/0.056/0.059/0.003 ms
+ pbfeanup
+ set +e
+ del_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder del pbf1
+ del_veths 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-pbforwarder/test/test2_10.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 10:53:31.647] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:53:31.647] [polycubed] [info] configuration parameters: 
[2020-12-24 10:53:31.647] [polycubed] [info]  loglevel: info
[2020-12-24 10:53:31.647] [polycubed] [info]  daemon: false
[2020-12-24 10:53:31.647] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:53:31.647] [polycubed] [info]  port: 9000
[2020-12-24 10:53:31.647] [polycubed] [info]  addr: localhost
[2020-12-24 10:53:31.647] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:53:31.647] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:53:31.647] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:53:31.648] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:53:31.648] [polycubed] [info] polycubed starting...
[2020-12-24 10:53:31.648] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:53:33.859] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:53:33.859] [polycubed] [info] rest server starting ...
[2020-12-24 10:53:33.900] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:53:33.911] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:53:33.926] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:53:33.937] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:53:33.971] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:53:33.982] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:53:34.026] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:53:34.060] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:53:34.096] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:53:34.140] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:53:34.186] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:53:34.210] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:53:34.221] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:53:34.237] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:53:34.246] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:53:34.255] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:53:34.298] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:53:34.347] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:53:34.347] [polycubed] [info] loading metrics from yang files
+ set -e
+ TYPE=TC
+ '[' -n '' ']'
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ip netns exec ns1 ip -s neigh flush all
Nothing to flush.
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ sudo ip netns exec ns2 ip -s neigh flush all
Nothing to flush.
+ polycubectl pbforwarder add pbf1 type=TC
[2020-12-24 10:53:37.048] [Pbforwarder] [pbf1] [info] Creating Pbforwarder instance
+ pbforwarder_add_port pbf1 veth1
+ polycubectl pbforwarder pbf1 ports add veth1
[2020-12-24 10:53:37.055] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth1 set peer=veth1
+ pbforwarder_add_port pbf1 veth2
+ polycubectl pbforwarder pbf1 ports add veth2
[2020-12-24 10:53:38.237] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth2 set peer=veth2
+ polycubectl pbforwarder pbf1 set loglevel=TRACE
+ pbforwarder_add_rules_l2 0 6 pbf1
++ seq 0 6
+ for i in `seq $1 $2`
+ number=0
+ [[ 1 -lt 2 ]]
+ number=000
+ number=00
+ polycubectl pbforwarder pbf1 rules add 0 src_mac=00:00:00:00:11:00 action=DROP
[2020-12-24 10:53:40.555] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:41.438] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=1
+ [[ 1 -lt 2 ]]
+ number=001
+ number=01
+ polycubectl pbforwarder pbf1 rules add 1 src_mac=00:00:00:00:11:01 action=DROP
[2020-12-24 10:53:41.444] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:41.552] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:53:41.552] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:41.552] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:53:41.808] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:53:41.808] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:41.808] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:53:42.339] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=2
+ [[ 1 -lt 2 ]]
+ number=002
+ number=02
+ polycubectl pbforwarder pbf1 rules add 2 src_mac=00:00:00:00:11:02 action=DROP
[2020-12-24 10:53:42.344] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:43.232] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=3
+ [[ 1 -lt 2 ]]
+ number=003
+ number=03
+ polycubectl pbforwarder pbf1 rules add 3 src_mac=00:00:00:00:11:03 action=DROP
[2020-12-24 10:53:43.238] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:44.130] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=4
+ [[ 1 -lt 2 ]]
+ number=004
+ number=04
+ polycubectl pbforwarder pbf1 rules add 4 src_mac=00:00:00:00:11:04 action=DROP
[2020-12-24 10:53:44.136] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:45.027] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=5
+ [[ 1 -lt 2 ]]
+ number=005
+ number=05
+ polycubectl pbforwarder pbf1 rules add 5 src_mac=00:00:00:00:11:05 action=DROP
[2020-12-24 10:53:45.034] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:45.933] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=6
+ [[ 1 -lt 2 ]]
+ number=006
+ number=06
+ polycubectl pbforwarder pbf1 rules add 6 src_mac=00:00:00:00:11:06 action=DROP
[2020-12-24 10:53:45.940] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:46.839] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
++ LANG=C
++ sudo ip netns exec ns1 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth1_mac=22:01:06:80:ce:f9
++ LANG=C
++ sudo ip netns exec ns2 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth2_mac=b2:ee:d5:0e:dd:7b
+ polycubectl pbforwarder pbf1 rules add 7 dst_mac=FF:FF:FF:FF:FF:FF action=FORWARD out_port=veth2
[2020-12-24 10:53:46.896] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:47.803] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 8 dst_mac=22:01:06:80:ce:f9 action=FORWARD out_port=veth1
[2020-12-24 10:53:47.809] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:48.723] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 9 dst_mac=b2:ee:d5:0e:dd:7b action=FORWARD out_port=veth2
[2020-12-24 10:53:48.729] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:53:48.976] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:53:48.976] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:48.976] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:53:49.488] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:53:49.488] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:49.488] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:53:49.657] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.128 ms
[2020-12-24 10:53:49.665] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [debug] FORWARD to 0
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:53:49.666] [Pbforwarder] [pbf1] [debug] FORWARD to 0
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.106 ms
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Action module receiving packet

[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1006ms
rtt min/avg/max/mdev = 0.106/0.117/0.128/0.011 ms
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:53:50.672] [Pbforwarder] [pbf1] [debug] FORWARD to 0
+ pbfeanup
+ set +e
+ del_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder del pbf1
+ del_veths 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-pbforwarder/test/test3_10.sh" time="22.000000" status="Passed"><system-out>[2020-12-24 10:53:51.840] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:53:51.840] [polycubed] [info] configuration parameters: 
[2020-12-24 10:53:51.840] [polycubed] [info]  loglevel: info
[2020-12-24 10:53:51.840] [polycubed] [info]  daemon: false
[2020-12-24 10:53:51.840] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:53:51.840] [polycubed] [info]  port: 9000
[2020-12-24 10:53:51.840] [polycubed] [info]  addr: localhost
[2020-12-24 10:53:51.840] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:53:51.840] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:53:51.840] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:53:51.840] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:53:51.840] [polycubed] [info] polycubed starting...
[2020-12-24 10:53:51.840] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:53:54.044] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:53:54.044] [polycubed] [info] rest server starting ...
[2020-12-24 10:53:54.089] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:53:54.100] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:53:54.114] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:53:54.124] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:53:54.157] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:53:54.167] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:53:54.210] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:53:54.243] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:53:54.279] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:53:54.323] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:53:54.368] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:53:54.391] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:53:54.402] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:53:54.418] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:53:54.427] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:53:54.436] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:53:54.478] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:53:54.527] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:53:54.527] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ip netns exec ns1 ip -s neigh flush all
Nothing to flush.
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ sudo ip netns exec ns2 ip -s neigh flush all
Nothing to flush.
+ add_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder add pbf1
[2020-12-24 10:53:57.174] [Pbforwarder] [pbf1] [info] Creating Pbforwarder instance
+ pbforwarder_add_port pbf1 veth1
+ polycubectl pbforwarder pbf1 ports add veth1
[2020-12-24 10:53:57.182] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth1 set peer=veth1
+ pbforwarder_add_port pbf1 veth2
+ polycubectl pbforwarder pbf1 ports add veth2
[2020-12-24 10:53:58.347] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth2 set peer=veth2
+ polycubectl pbforwarder pbf1 set loglevel=DEBUG
+ pbforwarder_add_rules_l3 0 5 pbf1
++ seq 0 5
+ for i in `seq $1 $2`
+ number=0
+ polycubectl pbforwarder pbf1 rules add 0 src_ip=10.9.8.0 action=DROP
[2020-12-24 10:54:00.641] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:00.641] [Pbforwarder] [pbf1] [info] [pbf1] Switching to level 3.
[2020-12-24 10:54:01.008] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:01.518] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=1
+ polycubectl pbforwarder pbf1 rules add 1 src_ip=10.9.8.1 action=DROP
[2020-12-24 10:54:01.524] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:01.776] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:02.417] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=2
+ polycubectl pbforwarder pbf1 rules add 2 src_ip=10.9.8.2 action=DROP
[2020-12-24 10:54:02.423] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:03.319] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=3
+ polycubectl pbforwarder pbf1 rules add 3 src_ip=10.9.8.3 action=DROP
[2020-12-24 10:54:03.326] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:04.229] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=4
+ polycubectl pbforwarder pbf1 rules add 4 src_ip=10.9.8.4 action=DROP
[2020-12-24 10:54:04.234] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:05.141] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ number=5
+ polycubectl pbforwarder pbf1 rules add 5 src_ip=10.9.8.5 action=DROP
[2020-12-24 10:54:05.147] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:06.062] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
++ LANG=C
++ sudo ip netns exec ns1 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth1_mac=c2:d9:ae:fe:fc:b4
++ LANG=C
++ sudo ip netns exec ns2 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth2_mac=ce:0f:7d:98:62:1d
+ polycubectl pbforwarder pbf1 rules add 6 src_ip=10.0.0.1 dst_ip=10.0.0.2 action=FORWARD out_port=veth2
[2020-12-24 10:54:06.123] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:07.042] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 7 src_ip=10.0.0.2 dst_ip=10.0.0.1 action=FORWARD out_port=veth1
[2020-12-24 10:54:07.049] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:07.981] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 8 dst_mac=FF:FF:FF:FF:FF:FF action=FORWARD out_port=veth2
[2020-12-24 10:54:07.987] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:08.432] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:08.924] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 9 dst_mac=c2:d9:ae:fe:fc:b4 action=FORWARD out_port=veth1
[2020-12-24 10:54:08.930] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:09.870] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2
[2020-12-24 10:54:09.879] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:54:09.879] [Pbforwarder] [pbf1] [debug] FORWARD to 0
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.089 ms
[2020-12-24 10:54:09.879] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:54:09.879] [Pbforwarder] [pbf1] [debug] FORWARD to 0
[2020-12-24 10:54:09.968] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.099 ms
[2020-12-24 10:54:10.896] [Pbforwarder] [pbf1] [debug] FORWARD to 1

[2020-12-24 10:54:10.896] [Pbforwarder] [pbf1] [debug] FORWARD to 0
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1017ms
rtt min/avg/max/mdev = 0.089/0.094/0.099/0.005 ms
+ pbfeanup
+ set +e
+ del_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder del pbf1
+ del_veths 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-pbforwarder/test/test4_10.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 10:54:13.077] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:54:13.077] [polycubed] [info] configuration parameters: 
[2020-12-24 10:54:13.077] [polycubed] [info]  loglevel: info
[2020-12-24 10:54:13.077] [polycubed] [info]  daemon: false
[2020-12-24 10:54:13.077] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:54:13.077] [polycubed] [info]  port: 9000
[2020-12-24 10:54:13.077] [polycubed] [info]  addr: localhost
[2020-12-24 10:54:13.077] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:54:13.077] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:54:13.077] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:54:13.077] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:54:13.077] [polycubed] [info] polycubed starting...
[2020-12-24 10:54:13.077] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:54:15.282] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:54:15.282] [polycubed] [info] rest server starting ...
[2020-12-24 10:54:15.329] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:54:15.341] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:54:15.356] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:54:15.366] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:54:15.400] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:54:15.411] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:54:15.456] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:54:15.491] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:54:15.527] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:54:15.573] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:54:15.619] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:54:15.643] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:54:15.654] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:54:15.670] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:54:15.679] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:54:15.689] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:54:15.733] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:54:15.783] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:54:15.783] [polycubed] [info] loading metrics from yang files
+ set -e
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ sudo ip netns exec ns1 ip -s neigh flush all
Nothing to flush.
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ sudo ip netns exec ns2 ip -s neigh flush all
Nothing to flush.
+ add_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder add pbf1
[2020-12-24 10:54:18.469] [Pbforwarder] [pbf1] [info] Creating Pbforwarder instance
+ pbforwarder_add_port pbf1 veth1
+ polycubectl pbforwarder pbf1 ports add veth1
[2020-12-24 10:54:18.475] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth1 set peer=veth1
+ pbforwarder_add_port pbf1 veth2
+ polycubectl pbforwarder pbf1 ports add veth2
[2020-12-24 10:54:19.652] [Pbforwarder] [pbf1] [info] Creating Ports instance
+ polycubectl pbforwarder pbf1 ports veth2 set peer=veth2
+ polycubectl pbforwarder pbf1 set loglevel=TRACE
+ pbforwarder_add_rules_l4 0 6 pbf1
++ seq 0 6
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 0 l4_proto=TCP action=DROP
[2020-12-24 10:54:21.971] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:21.971] [Pbforwarder] [pbf1] [debug] [pbf1] Switching to level 4.
[2020-12-24 10:54:22.867] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 1 l4_proto=TCP action=DROP
[2020-12-24 10:54:22.874] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:23.280] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:54:23.280] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:23.281] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:23.281] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:54:23.281] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:23.281] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:23.781] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 2 l4_proto=TCP action=DROP
[2020-12-24 10:54:23.788] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:24.706] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 3 l4_proto=TCP action=DROP
[2020-12-24 10:54:24.712] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:25.642] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 4 l4_proto=TCP action=DROP
[2020-12-24 10:54:25.649] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:26.590] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 5 l4_proto=TCP action=DROP
[2020-12-24 10:54:26.597] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:27.542] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ for i in `seq $1 $2`
+ polycubectl pbforwarder pbf1 rules add 6 l4_proto=TCP action=DROP
[2020-12-24 10:54:27.547] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:28.511] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
++ LANG=C
++ sudo ip netns exec ns1 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth1_mac=b6:1b:1a:41:0d:9a
++ LANG=C
++ sudo ip netns exec ns2 ifconfig -a
++ grep -Po 'ether \K[a-fA-F0-9:]{17}|[a-fA-F0-9]{12}$'
+ veth2_mac=7e:c6:51:07:e0:48
+ polycubectl pbforwarder pbf1 rules add 6 dst_mac=7e:c6:51:07:e0:48 dst_ip=10.0.0.2 l4_proto=UDP dst_port=53 action=FORWARD out_port=veth2
[2020-12-24 10:54:28.568] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:29.528] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 7 dst_mac=FF:FF:FF:FF:FF:FF action=FORWARD out_port=veth2
[2020-12-24 10:54:29.535] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:30.497] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ polycubectl pbforwarder pbf1 rules add 8 dst_mac=b6:1b:1a:41:0d:9a action=FORWARD out_port=veth1
[2020-12-24 10:54:30.503] [Pbforwarder] [pbf1] [info] Creating Rules instance
[2020-12-24 10:54:30.960] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:54:30.960] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:30.960] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:31.472] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:54:31.472] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:31.472] [Pbforwarder] [pbf1] [debug] No rules. Dropping.
[2020-12-24 10:54:31.479] [Pbforwarder] [pbf1] [debug] [pbf1] Success inserting the rule.
+ sudo ip netns exec ns1 bash -c 'echo '\''EXAMPLE PAYLOAD'\'' | nc -q1 -u 10.0.0.2 53'
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [debug] FORWARD to 0
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 0
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [debug] FORWARD to 1
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Parser receiving packet from port 1
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Matching module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [trace] Action module receiving packet
[2020-12-24 10:54:31.488] [Pbforwarder] [pbf1] [debug] FORWARD to 0
+ pbfeanup
+ set +e
+ del_pbforwarders 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl pbforwarder del pbf1
+ del_veths 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test1_3.sh" time="16.000000" status="Passed"><system-out>[2020-12-24 10:54:33.663] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:54:33.663] [polycubed] [info] configuration parameters: 
[2020-12-24 10:54:33.663] [polycubed] [info]  loglevel: info
[2020-12-24 10:54:33.663] [polycubed] [info]  daemon: false
[2020-12-24 10:54:33.663] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:54:33.663] [polycubed] [info]  port: 9000
[2020-12-24 10:54:33.663] [polycubed] [info]  addr: localhost
[2020-12-24 10:54:33.663] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:54:33.663] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:54:33.663] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:54:33.663] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:54:33.663] [polycubed] [info] polycubed starting...
[2020-12-24 10:54:33.663] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:54:35.855] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:54:35.855] [polycubed] [info] rest server starting ...
[2020-12-24 10:54:35.901] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:54:35.912] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:54:35.927] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:54:35.937] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:54:35.971] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:54:35.982] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:54:36.027] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:54:36.061] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:54:36.097] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:54:36.142] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:54:36.188] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:54:36.211] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:54:36.223] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:54:36.238] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:54:36.247] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:54:36.256] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:54:36.300] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:54:36.349] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:54:36.349] [polycubed] [info] loading metrics from yang files
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ polycubectl router add r1 type=TC
[2020-12-24 10:54:39.663] [Router] [r1] [info] Creating Router instance
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 10:54:39.670] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ee:be:38:48:1e:b9 - ip: 10.0.1.254/24]
[2020-12-24 10:54:39.670] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:54:39.670] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
+ router_add_port_as_gateway r1 veth2 2
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24
[2020-12-24 10:54:41.373] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: ce:e2:42:89:67:e9 - ip: 10.0.2.254/24]
[2020-12-24 10:54:41.373] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:54:41.373] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth2 set peer=veth2'\'''
Executing the command 'polycubectl router r1 ports to_veth2 set peer=veth2'
+ polycubectl router r1 ports to_veth2 set peer=veth2
+ router_add_port_as_gateway r1 veth3 3
+ polycubectl router r1 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 10:54:43.185] [Router] [r1] [info] Added new port: to_veth3 (index: 2) [mac: b6:f0:ba:b5:ac:03 - ip: 10.0.3.254/24]
[2020-12-24 10:54:43.186] [Router] [r1] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:54:43.186] [Router] [r1] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r1 ports to_veth3 set peer=veth3'
+ polycubectl router r1 ports to_veth3 set peer=veth3
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:54:45.052] [Router] [r1] [info] ARP reply '10.0.2.1 is at 6a:41:6b:81:e2:2b'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.462 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.048 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.048/0.255/0.462/0.207 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
[2020-12-24 10:54:45.561] [Router] [r1] [info] ARP reply '10.0.3.1 is at 6e:f2:3b:99:c7:bb'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.281 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.054/0.167/0.281/0.114 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.028 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.028/0.041/0.055/0.014 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.032 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.044/0.056/0.012 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.025 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.057 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.025/0.041/0.057/0.016 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.028 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.028/0.041/0.054/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:54:48.121] [Router] [r1] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test1_3_xdp.sh" time="15.000000" status="Passed"><system-out>[2020-12-24 10:54:49.343] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:54:49.344] [polycubed] [info] configuration parameters: 
[2020-12-24 10:54:49.344] [polycubed] [info]  loglevel: info
[2020-12-24 10:54:49.344] [polycubed] [info]  daemon: false
[2020-12-24 10:54:49.344] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:54:49.344] [polycubed] [info]  port: 9000
[2020-12-24 10:54:49.344] [polycubed] [info]  addr: localhost
[2020-12-24 10:54:49.344] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:54:49.344] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:54:49.344] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:54:49.344] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:54:49.344] [polycubed] [info] polycubed starting...
[2020-12-24 10:54:49.344] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:54:51.557] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:54:51.558] [polycubed] [info] rest server starting ...
[2020-12-24 10:54:51.605] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:54:51.616] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:54:51.631] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:54:51.641] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:54:51.674] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:54:51.685] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:54:51.727] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:54:51.761] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:54:51.795] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:54:51.838] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:54:51.882] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:54:51.905] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:54:51.917] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:54:51.932] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:54:51.942] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:54:51.951] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:54:51.993] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:54:52.041] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:54:52.041] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-router/test/test1_3.sh XDP_SKB
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ polycubectl router add r1 type=XDP_SKB
[2020-12-24 10:54:55.307] [Router] [r1] [info] Creating Router instance
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 10:54:55.314] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: b2:68:88:41:ba:34 - ip: 10.0.1.254/24]
[2020-12-24 10:54:55.314] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:54:55.314] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
+ router_add_port_as_gateway r1 veth2 2
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24
[2020-12-24 10:54:57.004] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: ba:84:f8:73:03:f2 - ip: 10.0.2.254/24]
[2020-12-24 10:54:57.004] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:54:57.004] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth2 set peer=veth2'\'''
Executing the command 'polycubectl router r1 ports to_veth2 set peer=veth2'
+ polycubectl router r1 ports to_veth2 set peer=veth2
+ router_add_port_as_gateway r1 veth3 3
+ polycubectl router r1 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 10:54:58.841] [Router] [r1] [info] Added new port: to_veth3 (index: 2) [mac: 42:2a:a9:b0:8b:d5 - ip: 10.0.3.254/24]
[2020-12-24 10:54:58.841] [Router] [r1] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:54:58.841] [Router] [r1] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r1 ports to_veth3 set peer=veth3'
+ polycubectl router r1 ports to_veth3 set peer=veth3
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:55:00.705] [Router] [r1] [info] ARP reply '10.0.2.1 is at c6:60:29:05:0a:47'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.387 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 527ms
rtt min/avg/max/mdev = 0.056/0.221/0.387/0.166 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
[2020-12-24 10:55:01.241] [Router] [r1] [info] ARP reply '10.0.3.1 is at ea:e4:85:f8:80:d8'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.272 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 507ms
rtt min/avg/max/mdev = 0.055/0.163/0.272/0.109 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.026 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.051 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 529ms
rtt min/avg/max/mdev = 0.026/0.038/0.051/0.013 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.024 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.053 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.024/0.038/0.053/0.015 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.025 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.051 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.025/0.038/0.051/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.031 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.030/0.031/0.001 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:55:03.833] [Router] [r1] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test1_3s.sh" time="36.000000" status="Passed"><system-out>[2020-12-24 10:55:05.003] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:55:05.004] [polycubed] [info] configuration parameters: 
[2020-12-24 10:55:05.004] [polycubed] [info]  loglevel: info
[2020-12-24 10:55:05.004] [polycubed] [info]  daemon: false
[2020-12-24 10:55:05.004] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:55:05.004] [polycubed] [info]  port: 9000
[2020-12-24 10:55:05.004] [polycubed] [info]  addr: localhost
[2020-12-24 10:55:05.004] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:55:05.004] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:55:05.004] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:55:05.004] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:55:05.004] [polycubed] [info] polycubed starting...
[2020-12-24 10:55:05.004] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:55:07.187] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:55:07.188] [polycubed] [info] rest server starting ...
[2020-12-24 10:55:07.229] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:55:07.240] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:55:07.254] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:55:07.265] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:55:07.299] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:55:07.309] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:55:07.353] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:55:07.386] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:55:07.422] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:55:07.466] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:55:07.512] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:55:07.535] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:55:07.546] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:55:07.562] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:55:07.571] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:55:07.579] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:55:07.622] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:55:07.671] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:55:07.671] [polycubed] [info] loading metrics from yang files
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ add_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router add r1 loglevel=DEBUG
[2020-12-24 10:55:11.007] [Router] [r1] [info] Creating Router instance
+ router_add_port r1 to_veth1 10.0.0.120/24
+ polycubectl router r1 ports add to_veth1 ip=10.0.0.120/24
[2020-12-24 10:55:11.013] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: b6:9a:99:33:ed:53 - ip: 10.0.0.120/24]
[2020-12-24 10:55:11.013] [Router] [r1] [info] Added route [network: 10.0.0.120/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:55:11.013] [Router] [r1] [info] Added route [network: 10.0.0.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ router_add_port r1 to_veth2 10.10.20.10/24
+ polycubectl router r1 ports add to_veth2 ip=10.10.20.10/24
[2020-12-24 10:55:11.018] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: ea:75:1d:cb:5f:5a - ip: 10.10.20.10/24]
[2020-12-24 10:55:11.018] [Router] [r1] [info] Added route [network: 10.10.20.10/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:55:11.018] [Router] [r1] [info] Added route [network: 10.10.20.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ router_add_port r1 to_veth3 10.30.10.10/24
+ polycubectl router r1 ports add to_veth3 ip=10.30.10.10/24
[2020-12-24 10:55:11.022] [Router] [r1] [info] Added new port: to_veth3 (index: 2) [mac: 86:96:97:df:77:f1 - ip: 10.30.10.10/24]
[2020-12-24 10:55:11.022] [Router] [r1] [info] Added route [network: 10.30.10.10/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:55:11.022] [Router] [r1] [info] Added route [network: 10.30.10.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ router_add_secondary r1 veth1 10.10.10.1/24
+ polycubectl router r1 ports to_veth1 secondaryip add 10.10.10.1/24
[2020-12-24 10:55:11.026] [Router] [r1] [info] Adding secondary address [port: to_veth1 - ip: 10.10.10.1/24]
[2020-12-24 10:55:11.026] [Router] [r1] [debug] Adding secondary address [ip: 10.10.10.1/24]
[2020-12-24 10:55:11.026] [Router] [r1] [info] Added route [network: 10.10.10.1/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:55:11.026] [Router] [r1] [info] Added route [network: 10.10.10.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ router_add_secondary r1 veth1 10.10.21.2/24
+ polycubectl router r1 ports to_veth1 secondaryip add 10.10.21.2/24
[2020-12-24 10:55:11.031] [Router] [r1] [info] Adding secondary address [port: to_veth1 - ip: 10.10.21.2/24]
[2020-12-24 10:55:11.031] [Router] [r1] [debug] Adding secondary address [ip: 10.10.21.2/24]
[2020-12-24 10:55:11.031] [Router] [r1] [info] Added route [network: 10.10.21.2/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:55:11.031] [Router] [r1] [info] Added route [network: 10.10.21.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ router_add_secondary_as_gateway r1 veth1 1
+ polycubectl router r1 ports to_veth1 secondaryip add 10.0.1.254/24
[2020-12-24 10:55:11.035] [Router] [r1] [info] Adding secondary address [port: to_veth1 - ip: 10.0.1.254/24]
[2020-12-24 10:55:11.035] [Router] [r1] [debug] Adding secondary address [ip: 10.0.1.254/24]
[2020-12-24 10:55:11.035] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:55:11.035] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 ports to_veth1 set peer=veth1
[2020-12-24 10:55:12.737] [Router] [r1] [debug] Align mac of port to_veth1
[2020-12-24 10:55:12.737] [Router] [r1] [debug] Updated mac port: to_veth1 (index: 0) [mac: da:3d:75:f8:73:81 - ip: 10.0.0.120/24]
+ router_add_secondary r1 veth2 10.14.1.1/24
+ polycubectl router r1 ports to_veth2 secondaryip add 10.14.1.1/24
[2020-12-24 10:55:12.743] [Router] [r1] [info] Adding secondary address [port: to_veth2 - ip: 10.14.1.1/24]
[2020-12-24 10:55:12.743] [Router] [r1] [debug] Adding secondary address [ip: 10.14.1.1/24]
[2020-12-24 10:55:12.743] [Router] [r1] [info] Added route [network: 10.14.1.1/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:55:12.743] [Router] [r1] [info] Added route [network: 10.14.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ router_add_secondary r1 veth2 10.1.15.2/24
+ polycubectl router r1 ports to_veth2 secondaryip add 10.1.15.2/24
[2020-12-24 10:55:12.748] [Router] [r1] [info] Adding secondary address [port: to_veth2 - ip: 10.1.15.2/24]
[2020-12-24 10:55:12.748] [Router] [r1] [debug] Adding secondary address [ip: 10.1.15.2/24]
[2020-12-24 10:55:12.748] [Router] [r1] [info] Added route [network: 10.1.15.2/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:55:12.748] [Router] [r1] [info] Added route [network: 10.1.15.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ router_add_secondary_as_gateway r1 veth2 2
+ polycubectl router r1 ports to_veth2 secondaryip add 10.0.2.254/24
[2020-12-24 10:55:12.753] [Router] [r1] [info] Adding secondary address [port: to_veth2 - ip: 10.0.2.254/24]
[2020-12-24 10:55:12.753] [Router] [r1] [debug] Adding secondary address [ip: 10.0.2.254/24]
[2020-12-24 10:55:12.753] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:55:12.753] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 ports to_veth2 set peer=veth2
[2020-12-24 10:55:14.578] [Router] [r1] [debug] Align mac of port to_veth2
[2020-12-24 10:55:14.578] [Router] [r1] [debug] Updated mac port: to_veth2 (index: 1) [mac: 7e:96:30:03:b8:c2 - ip: 10.10.20.10/24]
+ router_add_secondary r1 veth3 11.1.1.1/24
+ polycubectl router r1 ports to_veth3 secondaryip add 11.1.1.1/24
[2020-12-24 10:55:14.583] [Router] [r1] [info] Adding secondary address [port: to_veth3 - ip: 11.1.1.1/24]
[2020-12-24 10:55:14.583] [Router] [r1] [debug] Adding secondary address [ip: 11.1.1.1/24]
[2020-12-24 10:55:14.584] [Router] [r1] [info] Added route [network: 11.1.1.1/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:55:14.584] [Router] [r1] [info] Added route [network: 11.1.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ router_add_secondary r1 veth3 12.1.1.1/24
+ polycubectl router r1 ports to_veth3 secondaryip add 12.1.1.1/24
[2020-12-24 10:55:14.589] [Router] [r1] [info] Adding secondary address [port: to_veth3 - ip: 12.1.1.1/24]
[2020-12-24 10:55:14.589] [Router] [r1] [debug] Adding secondary address [ip: 12.1.1.1/24]
[2020-12-24 10:55:14.589] [Router] [r1] [info] Added route [network: 12.1.1.1/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:55:14.589] [Router] [r1] [info] Added route [network: 12.1.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ router_add_secondary_as_gateway r1 veth3 3
+ polycubectl router r1 ports to_veth3 secondaryip add 10.0.3.254/24
[2020-12-24 10:55:14.593] [Router] [r1] [info] Adding secondary address [port: to_veth3 - ip: 10.0.3.254/24]
[2020-12-24 10:55:14.593] [Router] [r1] [debug] Adding secondary address [ip: 10.0.3.254/24]
[2020-12-24 10:55:14.593] [Router] [r1] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:55:14.593] [Router] [r1] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 ports to_veth3 set peer=veth3
[2020-12-24 10:55:16.404] [Router] [r1] [debug] Align mac of port to_veth3
[2020-12-24 10:55:16.404] [Router] [r1] [debug] Updated mac port: to_veth3 (index: 2) [mac: 76:f5:04:2a:38:c0 - ip: 10.30.10.10/24]
+ sudo ip netns exec ns1 ping 10.0.0.120 -c 2 -i 0.5
[2020-12-24 10:55:16.447] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:55:16.447] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:16.447] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.0.120
PING 10.0.0.120 (10.0.0.120) 56(84) bytes of data.
64 bytes from 10.0.0.120: icmp_seq=1 ttl=64 time=0.320 ms
[2020-12-24 10:55:16.976] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:16.977] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.0.120
64 bytes from 10.0.0.120: icmp_seq=2 ttl=64 time=0.257 ms

--- 10.0.0.120 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 529ms
rtt min/avg/max/mdev = 0.257/0.288/0.320/0.035 ms
+ sudo ip netns exec ns1 ping 10.10.20.10 -c 2 -i 0.5
[2020-12-24 10:55:16.985] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:16.985] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.20.10
PING 10.10.20.10 (10.10.20.10) 56(84) bytes of data.
64 bytes from 10.10.20.10: icmp_seq=1 ttl=64 time=0.161 ms
[2020-12-24 10:55:17.488] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:17.488] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=2 ttl=64 time=0.301 ms

--- 10.10.20.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.161/0.231/0.301/0.070 ms
+ sudo ip netns exec ns1 ping 10.30.10.10 -c 2 -i 0.5
[2020-12-24 10:55:17.497] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:17.497] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.30.10.10
PING 10.30.10.10 (10.30.10.10) 56(84) bytes of data.
64 bytes from 10.30.10.10: icmp_seq=1 ttl=64 time=0.159 ms
[2020-12-24 10:55:18.000] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:18.000] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.30.10.10
64 bytes from 10.30.10.10: icmp_seq=2 ttl=64 time=0.251 ms

--- 10.30.10.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.159/0.205/0.251/0.046 ms
+ sudo ip netns exec ns1 ping 10.10.10.1 -c 2 -i 0.5
[2020-12-24 10:55:18.009] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:18.009] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.10.1
PING 10.10.10.1 (10.10.10.1) 56(84) bytes of data.
64 bytes from 10.10.10.1: icmp_seq=1 ttl=64 time=0.139 ms
[2020-12-24 10:55:18.512] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:18.512] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.10.1
64 bytes from 10.10.10.1: icmp_seq=2 ttl=64 time=0.288 ms

--- 10.10.10.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.139/0.213/0.288/0.075 ms
+ sudo ip netns exec ns1 ping 10.10.21.2 -c 2 -i 0.5
[2020-12-24 10:55:18.521] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:18.521] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.21.2
PING 10.10.21.2 (10.10.21.2) 56(84) bytes of data.
64 bytes from 10.10.21.2: icmp_seq=1 ttl=64 time=0.151 ms
[2020-12-24 10:55:19.024] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:19.024] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.21.2
64 bytes from 10.10.21.2: icmp_seq=2 ttl=64 time=0.295 ms

--- 10.10.21.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.151/0.223/0.295/0.072 ms
+ sudo ip netns exec ns1 ping 10.0.1.254 -c 2 -i 0.5
[2020-12-24 10:55:19.033] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:19.034] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.1.254
PING 10.0.1.254 (10.0.1.254) 56(84) bytes of data.
64 bytes from 10.0.1.254: icmp_seq=1 ttl=64 time=0.172 ms
[2020-12-24 10:55:19.536] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:19.536] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.1.254
64 bytes from 10.0.1.254: icmp_seq=2 ttl=64 time=0.234 ms

--- 10.0.1.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.172/0.203/0.234/0.031 ms
+ sudo ip netns exec ns1 ping 10.14.1.1 -c 2 -i 0.5
[2020-12-24 10:55:19.545] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:19.545] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.14.1.1
PING 10.14.1.1 (10.14.1.1) 56(84) bytes of data.
64 bytes from 10.14.1.1: icmp_seq=1 ttl=64 time=0.163 ms
[2020-12-24 10:55:20.048] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:20.049] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.14.1.1
64 bytes from 10.14.1.1: icmp_seq=2 ttl=64 time=0.327 ms

--- 10.14.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.163/0.245/0.327/0.082 ms
+ sudo ip netns exec ns1 ping 10.1.15.2 -c 2 -i 0.5
[2020-12-24 10:55:20.057] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:20.057] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.15.2
PING 10.1.15.2 (10.1.15.2) 56(84) bytes of data.
64 bytes from 10.1.15.2: icmp_seq=1 ttl=64 time=0.169 ms
[2020-12-24 10:55:20.560] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:20.560] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.15.2
64 bytes from 10.1.15.2: icmp_seq=2 ttl=64 time=0.293 ms

--- 10.1.15.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.169/0.231/0.293/0.062 ms
+ sudo ip netns exec ns1 ping 10.0.2.254 -c 2 -i 0.5
[2020-12-24 10:55:20.570] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:20.570] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.2.254
PING 10.0.2.254 (10.0.2.254) 56(84) bytes of data.
64 bytes from 10.0.2.254: icmp_seq=1 ttl=64 time=0.243 ms
[2020-12-24 10:55:21.072] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:21.072] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.2.254
64 bytes from 10.0.2.254: icmp_seq=2 ttl=64 time=0.243 ms

--- 10.0.2.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.243/0.243/0.243/0.000 ms
+ sudo ip netns exec ns1 ping 11.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:21.082] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:21.082] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 11.1.1.1
PING 11.1.1.1 (11.1.1.1) 56(84) bytes of data.
64 bytes from 11.1.1.1: icmp_seq=1 ttl=64 time=0.233 ms
[2020-12-24 10:55:21.584] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:21.584] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 11.1.1.1
64 bytes from 11.1.1.1: icmp_seq=2 ttl=64 time=0.228 ms

--- 11.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.228/0.230/0.233/0.015 ms
+ sudo ip netns exec ns1 ping 12.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:21.593] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:21.593] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 12.1.1.1
PING 12.1.1.1 (12.1.1.1) 56(84) bytes of data.
64 bytes from 12.1.1.1: icmp_seq=1 ttl=64 time=0.160 ms
[2020-12-24 10:55:22.096] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:22.097] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 12.1.1.1
64 bytes from 12.1.1.1: icmp_seq=2 ttl=64 time=0.301 ms

--- 12.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.160/0.230/0.301/0.072 ms
+ sudo ip netns exec ns1 ping 10.0.3.254 -c 2 -i 0.5
[2020-12-24 10:55:22.105] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:22.105] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.3.254
PING 10.0.3.254 (10.0.3.254) 56(84) bytes of data.
64 bytes from 10.0.3.254: icmp_seq=1 ttl=64 time=0.160 ms
[2020-12-24 10:55:22.608] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:22.608] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.0.3.254
64 bytes from 10.0.3.254: icmp_seq=2 ttl=64 time=0.244 ms

--- 10.0.3.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.160/0.202/0.244/0.042 ms
+ sudo ip netns exec ns2 ping 10.0.0.120 -c 2 -i 0.5
[2020-12-24 10:55:22.617] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:55:22.617] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:22.617] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.0.120
PING 10.0.0.120 (10.0.0.120) 56(84) bytes of data.
64 bytes from 10.0.0.120: icmp_seq=1 ttl=64 time=0.181 ms
[2020-12-24 10:55:23.120] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:23.121] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.0.120
64 bytes from 10.0.0.120: icmp_seq=2 ttl=64 time=0.307 ms

--- 10.0.0.120 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.181/0.244/0.307/0.063 ms
+ sudo ip netns exec ns2 ping 10.10.20.10 -c 2 -i 0.5
[2020-12-24 10:55:23.130] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:23.130] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.20.10
PING 10.10.20.10 (10.10.20.10) 56(84) bytes of data.
64 bytes from 10.10.20.10: icmp_seq=1 ttl=64 time=0.237 ms
[2020-12-24 10:55:23.632] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:23.632] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=2 ttl=64 time=0.293 ms

--- 10.10.20.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.237/0.265/0.293/0.028 ms
+ sudo ip netns exec ns2 ping 10.30.10.10 -c 2 -i 0.5
[2020-12-24 10:55:23.641] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:23.641] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.30.10.10
PING 10.30.10.10 (10.30.10.10) 56(84) bytes of data.
64 bytes from 10.30.10.10: icmp_seq=1 ttl=64 time=0.153 ms
[2020-12-24 10:55:24.144] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:24.145] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.30.10.10
64 bytes from 10.30.10.10: icmp_seq=2 ttl=64 time=0.324 ms

--- 10.30.10.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.153/0.238/0.324/0.086 ms
+ sudo ip netns exec ns2 ping 10.10.10.1 -c 2 -i 0.5
[2020-12-24 10:55:24.154] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:24.154] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.10.1
PING 10.10.10.1 (10.10.10.1) 56(84) bytes of data.
64 bytes from 10.10.10.1: icmp_seq=1 ttl=64 time=0.208 ms
[2020-12-24 10:55:24.656] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:24.657] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.10.1
64 bytes from 10.10.10.1: icmp_seq=2 ttl=64 time=0.312 ms

--- 10.10.10.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.208/0.260/0.312/0.052 ms
+ sudo ip netns exec ns2 ping 10.10.21.2 -c 2 -i 0.5
[2020-12-24 10:55:24.665] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:24.665] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.21.2
PING 10.10.21.2 (10.10.21.2) 56(84) bytes of data.
64 bytes from 10.10.21.2: icmp_seq=1 ttl=64 time=0.153 ms
[2020-12-24 10:55:25.168] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:25.168] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.21.2
64 bytes from 10.10.21.2: icmp_seq=2 ttl=64 time=0.302 ms

--- 10.10.21.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.153/0.227/0.302/0.076 ms
+ sudo ip netns exec ns2 ping 10.0.1.254 -c 2 -i 0.5
[2020-12-24 10:55:25.177] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:25.177] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.1.254
PING 10.0.1.254 (10.0.1.254) 56(84) bytes of data.
64 bytes from 10.0.1.254: icmp_seq=1 ttl=64 time=0.173 ms
[2020-12-24 10:55:25.680] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:25.680] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.1.254
64 bytes from 10.0.1.254: icmp_seq=2 ttl=64 time=0.304 ms

--- 10.0.1.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.173/0.238/0.304/0.067 ms
+ sudo ip netns exec ns2 ping 10.14.1.1 -c 2 -i 0.5
[2020-12-24 10:55:25.689] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:25.690] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.14.1.1
PING 10.14.1.1 (10.14.1.1) 56(84) bytes of data.
64 bytes from 10.14.1.1: icmp_seq=1 ttl=64 time=0.240 ms
[2020-12-24 10:55:26.192] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:26.193] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.14.1.1
64 bytes from 10.14.1.1: icmp_seq=2 ttl=64 time=0.339 ms

--- 10.14.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.240/0.289/0.339/0.052 ms
+ sudo ip netns exec ns2 ping 10.1.15.2 -c 2 -i 0.5
[2020-12-24 10:55:26.202] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:26.202] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.15.2
PING 10.1.15.2 (10.1.15.2) 56(84) bytes of data.
64 bytes from 10.1.15.2: icmp_seq=1 ttl=64 time=0.240 ms
[2020-12-24 10:55:26.704] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:26.704] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.15.2
64 bytes from 10.1.15.2: icmp_seq=2 ttl=64 time=0.235 ms

--- 10.1.15.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.235/0.237/0.240/0.015 ms
+ sudo ip netns exec ns2 ping 10.0.2.254 -c 2 -i 0.5
[2020-12-24 10:55:26.759] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:26.759] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.2.254
PING 10.0.2.254 (10.0.2.254) 56(84) bytes of data.
64 bytes from 10.0.2.254: icmp_seq=1 ttl=64 time=0.269 ms
[2020-12-24 10:55:27.280] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:27.280] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.2.254
64 bytes from 10.0.2.254: icmp_seq=2 ttl=64 time=0.270 ms

--- 10.0.2.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 521ms
rtt min/avg/max/mdev = 0.269/0.269/0.270/0.016 ms
+ sudo ip netns exec ns2 ping 11.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:27.289] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:27.289] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 11.1.1.1
PING 11.1.1.1 (11.1.1.1) 56(84) bytes of data.
64 bytes from 11.1.1.1: icmp_seq=1 ttl=64 time=0.167 ms
[2020-12-24 10:55:27.792] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:27.792] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 11.1.1.1
64 bytes from 11.1.1.1: icmp_seq=2 ttl=64 time=0.240 ms

--- 11.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.167/0.203/0.240/0.039 ms
+ sudo ip netns exec ns2 ping 12.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:27.801] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:27.801] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 12.1.1.1
PING 12.1.1.1 (12.1.1.1) 56(84) bytes of data.
64 bytes from 12.1.1.1: icmp_seq=1 ttl=64 time=0.168 ms
[2020-12-24 10:55:28.304] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:28.304] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 12.1.1.1
64 bytes from 12.1.1.1: icmp_seq=2 ttl=64 time=0.236 ms

--- 12.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.168/0.202/0.236/0.034 ms
+ sudo ip netns exec ns2 ping 10.0.3.254 -c 2 -i 0.5
[2020-12-24 10:55:28.313] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:28.313] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.3.254
PING 10.0.3.254 (10.0.3.254) 56(84) bytes of data.
64 bytes from 10.0.3.254: icmp_seq=1 ttl=64 time=0.167 ms
[2020-12-24 10:55:28.816] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:28.816] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.0.3.254
64 bytes from 10.0.3.254: icmp_seq=2 ttl=64 time=0.229 ms

--- 10.0.3.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.167/0.198/0.229/0.031 ms
+ sudo ip netns exec ns3 ping 10.0.0.120 -c 2 -i 0.5
[2020-12-24 10:55:28.826] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:55:28.826] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:28.826] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.0.120
PING 10.0.0.120 (10.0.0.120) 56(84) bytes of data.
64 bytes from 10.0.0.120: icmp_seq=1 ttl=64 time=0.234 ms
[2020-12-24 10:55:29.328] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:29.328] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.0.120
64 bytes from 10.0.0.120: icmp_seq=2 ttl=64 time=0.234 ms

--- 10.0.0.120 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.234/0.234/0.234/0.000 ms
+ sudo ip netns exec ns3 ping 10.10.20.10 -c 2 -i 0.5
[2020-12-24 10:55:29.337] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:29.337] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
PING 10.10.20.10 (10.10.20.10) 56(84) bytes of data.
64 bytes from 10.10.20.10: icmp_seq=1 ttl=64 time=0.137 ms
[2020-12-24 10:55:29.840] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:29.840] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=2 ttl=64 time=0.215 ms

--- 10.10.20.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.137/0.176/0.215/0.039 ms
+ sudo ip netns exec ns3 ping 10.30.10.10 -c 2 -i 0.5
[2020-12-24 10:55:29.850] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:29.850] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.30.10.10
PING 10.30.10.10 (10.30.10.10) 56(84) bytes of data.
64 bytes from 10.30.10.10: icmp_seq=1 ttl=64 time=0.239 ms
[2020-12-24 10:55:30.352] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:30.353] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.30.10.10
64 bytes from 10.30.10.10: icmp_seq=2 ttl=64 time=0.238 ms

--- 10.30.10.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.238/0.238/0.239/0.015 ms
+ sudo ip netns exec ns3 ping 10.10.10.1 -c 2 -i 0.5
[2020-12-24 10:55:30.362] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:30.362] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.1
PING 10.10.10.1 (10.10.10.1) 56(84) bytes of data.
64 bytes from 10.10.10.1: icmp_seq=1 ttl=64 time=0.229 ms
[2020-12-24 10:55:30.864] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:30.864] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.1
64 bytes from 10.10.10.1: icmp_seq=2 ttl=64 time=0.242 ms

--- 10.10.10.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.229/0.235/0.242/0.016 ms
+ sudo ip netns exec ns3 ping 10.10.21.2 -c 2 -i 0.5
[2020-12-24 10:55:30.873] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:30.873] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.21.2
PING 10.10.21.2 (10.10.21.2) 56(84) bytes of data.
64 bytes from 10.10.21.2: icmp_seq=1 ttl=64 time=0.176 ms
[2020-12-24 10:55:31.376] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:31.376] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.21.2
64 bytes from 10.10.21.2: icmp_seq=2 ttl=64 time=0.302 ms

--- 10.10.21.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.176/0.239/0.302/0.063 ms
+ sudo ip netns exec ns3 ping 10.0.1.254 -c 2 -i 0.5
[2020-12-24 10:55:31.386] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:31.386] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.1.254
PING 10.0.1.254 (10.0.1.254) 56(84) bytes of data.
64 bytes from 10.0.1.254: icmp_seq=1 ttl=64 time=0.228 ms
[2020-12-24 10:55:31.888] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:31.888] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.1.254
64 bytes from 10.0.1.254: icmp_seq=2 ttl=64 time=0.289 ms

--- 10.0.1.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.228/0.258/0.289/0.034 ms
+ sudo ip netns exec ns3 ping 10.14.1.1 -c 2 -i 0.5
[2020-12-24 10:55:31.897] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:31.897] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.14.1.1
PING 10.14.1.1 (10.14.1.1) 56(84) bytes of data.
64 bytes from 10.14.1.1: icmp_seq=1 ttl=64 time=0.234 ms
[2020-12-24 10:55:32.400] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:32.400] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.14.1.1
64 bytes from 10.14.1.1: icmp_seq=2 ttl=64 time=0.294 ms

--- 10.14.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.234/0.264/0.294/0.030 ms
+ sudo ip netns exec ns3 ping 10.1.15.2 -c 2 -i 0.5
[2020-12-24 10:55:32.409] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:32.409] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.1.15.2
PING 10.1.15.2 (10.1.15.2) 56(84) bytes of data.
64 bytes from 10.1.15.2: icmp_seq=1 ttl=64 time=0.141 ms
[2020-12-24 10:55:32.912] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:32.912] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.1.15.2
64 bytes from 10.1.15.2: icmp_seq=2 ttl=64 time=0.237 ms

--- 10.1.15.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.141/0.189/0.237/0.048 ms
+ sudo ip netns exec ns3 ping 10.0.2.254 -c 2 -i 0.5
[2020-12-24 10:55:32.921] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:32.921] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.2.254
PING 10.0.2.254 (10.0.2.254) 56(84) bytes of data.
64 bytes from 10.0.2.254: icmp_seq=1 ttl=64 time=0.150 ms
[2020-12-24 10:55:33.424] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:33.424] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.2.254
64 bytes from 10.0.2.254: icmp_seq=2 ttl=64 time=0.302 ms

--- 10.0.2.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.150/0.226/0.302/0.076 ms
+ sudo ip netns exec ns3 ping 11.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:33.433] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:33.433] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 11.1.1.1
PING 11.1.1.1 (11.1.1.1) 56(84) bytes of data.
64 bytes from 11.1.1.1: icmp_seq=1 ttl=64 time=0.255 ms
[2020-12-24 10:55:33.936] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:33.936] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 11.1.1.1
64 bytes from 11.1.1.1: icmp_seq=2 ttl=64 time=0.270 ms

--- 11.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.255/0.262/0.270/0.017 ms
+ sudo ip netns exec ns3 ping 12.1.1.1 -c 2 -i 0.5
[2020-12-24 10:55:33.945] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:33.945] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 12.1.1.1
PING 12.1.1.1 (12.1.1.1) 56(84) bytes of data.
64 bytes from 12.1.1.1: icmp_seq=1 ttl=64 time=0.167 ms
[2020-12-24 10:55:34.448] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:34.448] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 12.1.1.1
64 bytes from 12.1.1.1: icmp_seq=2 ttl=64 time=0.237 ms

--- 12.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.167/0.202/0.237/0.035 ms
+ sudo ip netns exec ns3 ping 10.0.3.254 -c 2 -i 0.5
[2020-12-24 10:55:34.457] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:34.457] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.3.254
PING 10.0.3.254 (10.0.3.254) 56(84) bytes of data.
64 bytes from 10.0.3.254: icmp_seq=1 ttl=64 time=0.148 ms
[2020-12-24 10:55:34.960] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:34.960] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.0.3.254
64 bytes from 10.0.3.254: icmp_seq=2 ttl=64 time=0.291 ms

--- 10.0.3.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.148/0.219/0.291/0.073 ms
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.037 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.037/0.046/0.055/0.009 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.027 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.041/0.056/0.015 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.025 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.060 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.025/0.042/0.060/0.018 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.067 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.048/0.067/0.019 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.033 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.033/0.044/0.056/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.025 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.025/0.040/0.056/0.016 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:55:38.072] [Router] [r1] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test1_5.sh" time="27.000000" status="Passed"><system-out>[2020-12-24 10:55:40.282] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:55:40.282] [polycubed] [info] configuration parameters: 
[2020-12-24 10:55:40.282] [polycubed] [info]  loglevel: info
[2020-12-24 10:55:40.282] [polycubed] [info]  daemon: false
[2020-12-24 10:55:40.282] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:55:40.282] [polycubed] [info]  port: 9000
[2020-12-24 10:55:40.282] [polycubed] [info]  addr: localhost
[2020-12-24 10:55:40.282] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:55:40.282] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:55:40.282] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:55:40.282] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:55:40.282] [polycubed] [info] polycubed starting...
[2020-12-24 10:55:40.282] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:55:42.482] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:55:42.483] [polycubed] [info] rest server starting ...
[2020-12-24 10:55:42.529] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:55:42.540] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:55:42.555] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:55:42.566] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:55:42.599] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:55:42.610] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:55:42.652] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:55:42.685] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:55:42.720] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:55:42.763] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:55:42.808] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:55:42.830] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:55:42.841] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:55:42.857] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:55:42.866] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:55:42.875] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:55:42.917] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:55:42.965] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:55:42.965] [polycubed] [info] loading metrics from yang files
+ create_veth_net 5
++ seq 1 5
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.4.1/24
+ sudo ip netns exec ns4 route add default gw 10.0.4.254 veth4_
+ for i in `seq 1 $1`
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.5.1/24
+ sudo ip netns exec ns5 route add default gw 10.0.5.254 veth5_
+ set -e
+ add_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router add r1 loglevel=DEBUG
[2020-12-24 10:55:46.466] [Router] [r1] [info] Creating Router instance
++ seq 1 5
+ for i in `seq 1 $N`
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 10:55:46.473] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 92:ff:a6:3c:3e:c2 - ip: 10.0.1.254/24]
[2020-12-24 10:55:46.473] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:55:46.473] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
[2020-12-24 10:55:48.190] [Router] [r1] [debug] Align mac of port to_veth1
[2020-12-24 10:55:48.190] [Router] [r1] [debug] Updated mac port: to_veth1 (index: 0) [mac: 8e:6e:08:7b:19:dd - ip: 10.0.1.254/24]
+ for i in `seq 1 $N`
+ router_add_port_as_gateway r1 veth2 2
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24
[2020-12-24 10:55:48.197] [Router] [r1] [info] Added new port: to_veth2 (index: 1) [mac: de:3a:b3:e1:e3:39 - ip: 10.0.2.254/24]
[2020-12-24 10:55:48.197] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:55:48.197] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth2 set peer=veth2'\'''
Executing the command 'polycubectl router r1 ports to_veth2 set peer=veth2'
+ polycubectl router r1 ports to_veth2 set peer=veth2
[2020-12-24 10:55:50.016] [Router] [r1] [debug] Align mac of port to_veth2
[2020-12-24 10:55:50.016] [Router] [r1] [debug] Updated mac port: to_veth2 (index: 1) [mac: 66:71:ea:54:c6:0d - ip: 10.0.2.254/24]
+ for i in `seq 1 $N`
+ router_add_port_as_gateway r1 veth3 3
+ polycubectl router r1 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 10:55:50.023] [Router] [r1] [info] Added new port: to_veth3 (index: 2) [mac: 86:25:4f:ab:ef:f1 - ip: 10.0.3.254/24]
[2020-12-24 10:55:50.023] [Router] [r1] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:55:50.023] [Router] [r1] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r1 ports to_veth3 set peer=veth3'
+ polycubectl router r1 ports to_veth3 set peer=veth3
[2020-12-24 10:55:51.844] [Router] [r1] [debug] Align mac of port to_veth3
[2020-12-24 10:55:51.844] [Router] [r1] [debug] Updated mac port: to_veth3 (index: 2) [mac: 3a:d9:97:41:03:86 - ip: 10.0.3.254/24]
+ for i in `seq 1 $N`
+ router_add_port_as_gateway r1 veth4 4
+ polycubectl router r1 ports add to_veth4 ip=10.0.4.254/24
[2020-12-24 10:55:51.851] [Router] [r1] [info] Added new port: to_veth4 (index: 3) [mac: 2e:7e:4e:ef:87:66 - ip: 10.0.4.254/24]
[2020-12-24 10:55:51.851] [Router] [r1] [info] Added route [network: 10.0.4.254/32 - nexthop: 0.0.0.0 - interface: to_veth4]
[2020-12-24 10:55:51.851] [Router] [r1] [info] Added route [network: 10.0.4.0/24 - nexthop: 0.0.0.0 - interface: to_veth4]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth4 set peer=veth4'\'''
Executing the command 'polycubectl router r1 ports to_veth4 set peer=veth4'
+ polycubectl router r1 ports to_veth4 set peer=veth4
[2020-12-24 10:55:53.668] [Router] [r1] [debug] Align mac of port to_veth4
[2020-12-24 10:55:53.668] [Router] [r1] [debug] Updated mac port: to_veth4 (index: 3) [mac: 36:38:8b:67:08:e6 - ip: 10.0.4.254/24]
+ for i in `seq 1 $N`
+ router_add_port_as_gateway r1 veth5 5
+ polycubectl router r1 ports add to_veth5 ip=10.0.5.254/24
[2020-12-24 10:55:53.675] [Router] [r1] [info] Added new port: to_veth5 (index: 4) [mac: f2:27:e5:c0:67:57 - ip: 10.0.5.254/24]
[2020-12-24 10:55:53.675] [Router] [r1] [info] Added route [network: 10.0.5.254/32 - nexthop: 0.0.0.0 - interface: to_veth5]
[2020-12-24 10:55:53.675] [Router] [r1] [info] Added route [network: 10.0.5.0/24 - nexthop: 0.0.0.0 - interface: to_veth5]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth5 set peer=veth5'\'''
Executing the command 'polycubectl router r1 ports to_veth5 set peer=veth5'
+ polycubectl router r1 ports to_veth5 set peer=veth5
[2020-12-24 10:55:55.505] [Router] [r1] [debug] Align mac of port to_veth5
[2020-12-24 10:55:55.505] [Router] [r1] [debug] Updated mac port: to_veth5 (index: 4) [mac: 92:fe:18:16:f4:d8 - ip: 10.0.5.254/24]
+ ping_cycle 5
++ seq 1 5
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:55:55.545] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:55:55.545] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 10:55:55.545] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:55.545] [Router] [r1] [debug] sending ARP request on port to_veth2 'who has 10.0.2.1 tell MAC to 10.0.2.254
[2020-12-24 10:55:55.545] [Router] [r1] [debug] packet is arp reply
[2020-12-24 10:55:55.545] [Router] [r1] [debug] Packet received from port to_veth2
[2020-12-24 10:55:55.545] [Router] [r1] [info] ARP reply '10.0.2.1 is at 6e:02:89:e9:9b:2e'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.485 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.056/0.270/0.485/0.215 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
[2020-12-24 10:55:56.057] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:56.057] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 10:55:56.058] [Router] [r1] [debug] sending ARP request on port to_veth3 'who has 10.0.3.1 tell MAC to 10.0.3.254
[2020-12-24 10:55:56.058] [Router] [r1] [debug] packet is arp reply
[2020-12-24 10:55:56.058] [Router] [r1] [debug] Packet received from port to_veth3
[2020-12-24 10:55:56.058] [Router] [r1] [info] ARP reply '10.0.3.1 is at 2e:27:7a:af:e7:55'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.369 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.056/0.212/0.369/0.157 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.4.1 -c 2 -i 0.5
[2020-12-24 10:55:56.569] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:56.569] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 10:55:56.569] [Router] [r1] [debug] sending ARP request on port to_veth4 'who has 10.0.4.1 tell MAC to 10.0.4.254
[2020-12-24 10:55:56.570] [Router] [r1] [debug] packet is arp reply
[2020-12-24 10:55:56.570] [Router] [r1] [debug] Packet received from port to_veth4
[2020-12-24 10:55:56.570] [Router] [r1] [info] ARP reply '10.0.4.1 is at 26:a9:08:2f:af:33'
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.383 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.059 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.059/0.221/0.383/0.162 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 5 ']'
+ sudo ip netns exec ns1 ping 10.0.5.1 -c 2 -i 0.5
[2020-12-24 10:55:57.081] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 10:55:57.081] [Router] [r1] [debug] Packet received from port to_veth1
[2020-12-24 10:55:57.081] [Router] [r1] [debug] sending ARP request on port to_veth5 'who has 10.0.5.1 tell MAC to 10.0.5.254
[2020-12-24 10:55:57.081] [Router] [r1] [debug] packet is arp reply
[2020-12-24 10:55:57.081] [Router] [r1] [debug] Packet received from port to_veth5
[2020-12-24 10:55:57.081] [Router] [r1] [info] ARP reply '10.0.5.1 is at ee:f3:23:a4:c4:06'
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.330 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.056/0.193/0.330/0.137 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.036 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.057 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.036/0.046/0.057/0.012 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.027 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.041/0.056/0.015 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.027 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.053 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.040/0.053/0.013 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 5 ']'
+ sudo ip netns exec ns2 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.027 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.042/0.058/0.016 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.029/0.043/0.058/0.015 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.027 ms
[2020-12-24 10:56:00.560] [Router] [r1] [debug] somebody is asking for my address
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.057 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.042/0.057/0.015 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.030 ms
[2020-12-24 10:56:01.072] [Router] [r1] [debug] somebody is asking for my address
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.052 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.030/0.041/0.052/0.011 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 5 ']'
+ sudo ip netns exec ns3 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.032 ms
[2020-12-24 10:56:01.584] [Router] [r1] [debug] somebody is asking for my address
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.032/0.044/0.056/0.012 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.026 ms
[2020-12-24 10:56:02.096] [Router] [r1] [debug] somebody is asking for my address
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.026/0.041/0.056/0.015 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.027 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.060 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.043/0.060/0.017 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.030 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.030/0.042/0.055/0.014 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ for j in `seq 1 $1`
+ '[' 4 -ne 5 ']'
+ sudo ip netns exec ns4 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.043/0.058/0.015 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 5 -ne 1 ']'
+ sudo ip netns exec ns5 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.033 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.033/0.043/0.054/0.012 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 2 ']'
+ sudo ip netns exec ns5 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.028 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.028/0.041/0.054/0.013 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 3 ']'
+ sudo ip netns exec ns5 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.026 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.026/0.040/0.055/0.015 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 4 ']'
+ sudo ip netns exec ns5 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.026 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.026/0.042/0.058/0.016 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 5 ']'
+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:56:05.785] [Router] [r1] [info] Destroying Router instance
+ delete_veth 5
++ seq 1 5
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test3_3s.sh" time="50.000000" status="Passed"><system-out>[2020-12-24 10:56:07.137] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:56:07.138] [polycubed] [info] configuration parameters: 
[2020-12-24 10:56:07.138] [polycubed] [info]  loglevel: info
[2020-12-24 10:56:07.138] [polycubed] [info]  daemon: false
[2020-12-24 10:56:07.138] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:56:07.138] [polycubed] [info]  port: 9000
[2020-12-24 10:56:07.138] [polycubed] [info]  addr: localhost
[2020-12-24 10:56:07.138] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:56:07.138] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:56:07.138] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:56:07.138] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:56:07.138] [polycubed] [info] polycubed starting...
[2020-12-24 10:56:07.138] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:56:09.362] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:56:09.363] [polycubed] [info] rest server starting ...
[2020-12-24 10:56:09.408] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:56:09.419] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:56:09.434] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:56:09.444] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:56:09.477] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:56:09.488] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:56:09.530] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:56:09.563] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:56:09.597] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:56:09.641] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:56:09.685] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:56:09.708] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:56:09.719] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:56:09.735] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:56:09.744] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:56:09.753] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:56:09.795] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:56:09.843] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:56:09.843] [polycubed] [info] loading metrics from yang files
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ TYPE=TC
+ '[' -n '' ']'
+ polycubectl router add r1 type=TC
[2020-12-24 10:56:13.127] [Router] [r1] [info] Creating Router instance
+ polycubectl router add r2 type=TC
[2020-12-24 10:56:14.796] [Router] [r2] [info] Creating Router instance
+ polycubectl router add r3 type=TC
[2020-12-24 10:56:16.484] [Router] [r3] [info] Creating Router instance
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 10:56:16.490] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: ea:14:59:e3:f7:77 - ip: 10.0.1.254/24]
[2020-12-24 10:56:16.490] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:56:16.490] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
+ router_add_port r1 to_r2 10.10.10.10/24
+ polycubectl router r1 ports add to_r2 ip=10.10.10.10/24
[2020-12-24 10:56:18.180] [Router] [r1] [info] Added new port: to_r2 (index: 1) [mac: aa:c8:55:82:1d:42 - ip: 10.10.10.10/24]
[2020-12-24 10:56:18.180] [Router] [r1] [info] Added route [network: 10.10.10.10/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:56:18.180] [Router] [r1] [info] Added route [network: 10.10.10.0/24 - nexthop: 0.0.0.0 - interface: to_r2]
+ router_add_port r2 to_r1 10.10.20.10/24
+ polycubectl router r2 ports add to_r1 ip=10.10.20.10/24
[2020-12-24 10:56:18.185] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: 0a:1d:d8:6a:eb:58 - ip: 10.10.20.10/24]
[2020-12-24 10:56:18.185] [Router] [r2] [info] Added route [network: 10.10.20.10/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:56:18.185] [Router] [r2] [info] Added route [network: 10.10.20.0/24 - nexthop: 0.0.0.0 - interface: to_r1]
+ connect_router_secondary_p_to_p r1 r2 1
+ polycubectl router r1 ports to_r2 secondaryip add 10.1.0.1/30
[2020-12-24 10:56:18.191] [Router] [r1] [info] Adding secondary address [port: to_r2 - ip: 10.1.0.1/30]
[2020-12-24 10:56:18.191] [Router] [r1] [info] Added route [network: 10.1.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:56:18.191] [Router] [r1] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports to_r1 secondaryip add 10.1.0.2/30
[2020-12-24 10:56:18.195] [Router] [r2] [info] Adding secondary address [port: to_r1 - ip: 10.1.0.2/30]
[2020-12-24 10:56:18.195] [Router] [r2] [info] Added route [network: 10.1.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:56:18.195] [Router] [r2] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ router_add_port r2 to_veth2 12.10.1.1/24
+ polycubectl router r2 ports add to_veth2 ip=12.10.1.1/24
[2020-12-24 10:56:24.408] [Router] [r2] [info] Added new port: to_veth2 (index: 1) [mac: 4e:1d:17:88:6e:b7 - ip: 12.10.1.1/24]
[2020-12-24 10:56:24.408] [Router] [r2] [info] Added route [network: 12.10.1.1/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:56:24.408] [Router] [r2] [info] Added route [network: 12.10.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ router_add_secondary_as_gateway r2 veth2 2
+ polycubectl router r2 ports to_veth2 secondaryip add 10.0.2.254/24
[2020-12-24 10:56:24.414] [Router] [r2] [info] Adding secondary address [port: to_veth2 - ip: 10.0.2.254/24]
[2020-12-24 10:56:24.414] [Router] [r2] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:56:24.414] [Router] [r2] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 ports to_veth2 set peer=veth2
+ connect_router_p_to_p r1 r3 2
+ polycubectl router r1 ports add to_r3 ip=10.2.0.1/30
[2020-12-24 10:56:26.236] [Router] [r1] [info] Added new port: to_r3 (index: 2) [mac: 0a:4a:65:28:86:82 - ip: 10.2.0.1/30]
[2020-12-24 10:56:26.236] [Router] [r1] [info] Added route [network: 10.2.0.1/32 - nexthop: 0.0.0.0 - interface: to_r3]
[2020-12-24 10:56:26.236] [Router] [r1] [info] Added route [network: 10.2.0.0/30 - nexthop: 0.0.0.0 - interface: to_r3]
+ polycubectl router r3 ports add to_r1 ip=10.2.0.2/30
[2020-12-24 10:56:26.241] [Router] [r3] [info] Added new port: to_r1 (index: 0) [mac: 8a:e3:a9:d6:f7:78 - ip: 10.2.0.2/30]
[2020-12-24 10:56:26.241] [Router] [r3] [info] Added route [network: 10.2.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:56:26.241] [Router] [r3] [info] Added route [network: 10.2.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r3 r3:to_r1
+ connect_router_p_to_p r2 r3 3
+ polycubectl router r2 ports add to_r3 ip=10.3.0.1/30
[2020-12-24 10:56:32.455] [Router] [r2] [info] Added new port: to_r3 (index: 2) [mac: b6:d3:d7:8a:e4:d8 - ip: 10.3.0.1/30]
[2020-12-24 10:56:32.455] [Router] [r2] [info] Added route [network: 10.3.0.1/32 - nexthop: 0.0.0.0 - interface: to_r3]
[2020-12-24 10:56:32.455] [Router] [r2] [info] Added route [network: 10.3.0.0/30 - nexthop: 0.0.0.0 - interface: to_r3]
+ polycubectl router r3 ports add to_r2 ip=10.3.0.2/30
[2020-12-24 10:56:32.461] [Router] [r3] [info] Added new port: to_r2 (index: 1) [mac: 22:45:2d:8e:22:1c - ip: 10.3.0.2/30]
[2020-12-24 10:56:32.461] [Router] [r3] [info] Added route [network: 10.3.0.2/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:56:32.461] [Router] [r3] [info] Added route [network: 10.3.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl connect r2:to_r3 r3:to_r2
+ router_add_port_as_gateway r3 veth3 3
+ polycubectl router r3 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 10:56:38.658] [Router] [r3] [info] Added new port: to_veth3 (index: 2) [mac: e2:ad:6c:d7:bd:b5 - ip: 10.0.3.254/24]
[2020-12-24 10:56:38.658] [Router] [r3] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:56:38.658] [Router] [r3] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r3 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r3 ports to_veth3 set peer=veth3'
+ polycubectl router r3 ports to_veth3 set peer=veth3
+ router_add_route r1 0.0.0.0/0 10.1.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 route add 0.0.0.0/0 10.1.0.2
[2020-12-24 10:56:40.473] [Router] [r1] [info] Creating Route instance
[2020-12-24 10:56:40.473] [Router] [r1] [info] Adding route [network: 0.0.0.0/0 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 1]
+ router_add_route r2 10.0.1.0/24 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.1.0.1
[2020-12-24 10:56:40.479] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:56:40.479] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r2 10.0.3.0/24 10.3.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.3.0/24 10.3.0.2
[2020-12-24 10:56:40.483] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:56:40.483] [Router] [r2] [info] Adding route [network: 10.0.3.0/24 - nexthop: 10.3.0.2 - interface: to_r3 - path cost: 1]
+ router_add_route r3 10.0.1.0/24 10.2.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.0.1.0/24 10.2.0.1
[2020-12-24 10:56:40.487] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:56:40.487] [Router] [r3] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.2.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r3 10.0.2.0/24 10.3.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.0.2.0/24 10.3.0.1
[2020-12-24 10:56:40.491] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:56:40.491] [Router] [r3] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.3.0.1 - interface: to_r2 - path cost: 1]
+ router_add_route r3 10.10.10.10/32 10.2.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.10.10.10/32 10.2.0.1
[2020-12-24 10:56:40.495] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:56:40.495] [Router] [r3] [info] Adding route [network: 10.10.10.10/32 - nexthop: 10.2.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r3 10.10.20.10/32 10.3.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.10.20.10/32 10.3.0.1
[2020-12-24 10:56:40.500] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:56:40.500] [Router] [r3] [info] Adding route [network: 10.10.20.10/32 - nexthop: 10.3.0.1 - interface: to_r2 - path cost: 1]
+ router_routingtable_show r1
+ polycubectl router r1 route show
Size of the terminal is too small, output could be missaligned.interface  network        nexthop   pathcost
to_r2      0.0.0.0/0      10.1.0.2  1
to_veth1   10.0.1.0/24    local     0
to_r2      10.1.0.0/30    local     0
to_r2      10.10.10.0/24  local     0
to_r3      10.2.0.0/30    local     0

+ router_routingtable_show r2
+ polycubectl router r2 route show
Size of the terminal is too small, output could be missaligned.interface  network        nexthop   pathcost
to_r1      10.0.1.0/24    10.1.0.1  1
to_veth2   10.0.2.0/24    local     0
to_r3      10.0.3.0/24    10.3.0.2  1
to_r1      10.1.0.0/30    local     0
to_r1      10.10.20.0/24  local     0
to_r3      10.3.0.0/30    local     0
to_veth2   12.10.1.0/24   local     0

+ router_routingtable_show r3
+ polycubectl router r3 route show
Size of the terminal is too small, output could be missaligned.interface  network         nexthop   pathcost
to_r1      10.0.1.0/24     10.2.0.1  1
to_r2      10.0.2.0/24     10.3.0.1  1
to_veth3   10.0.3.0/24     local     0
to_r1      10.10.10.10/32  10.2.0.1  1
to_r2      10.10.20.10/32  10.3.0.1  1
to_r1      10.2.0.0/30     local     0
to_r2      10.3.0.0/30     local     0

+ sudo ip netns exec ns3 ping 10.10.10.10 -c 2 -i 0.5 -t 10
[2020-12-24 10:56:40.559] [Router] [r3] [info] ARP reply '10.2.0.1 is at 0a:4a:65:28:86:82'
[2020-12-24 10:56:40.559] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.10
PING 10.10.10.10 (10.10.10.10) 56(84) bytes of data.
64 bytes from 10.10.10.10: icmp_seq=1 ttl=63 time=0.539 ms
[2020-12-24 10:56:41.072] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.10
64 bytes from 10.10.10.10: icmp_seq=2 ttl=63 time=0.241 ms

--- 10.10.10.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 513ms
rtt min/avg/max/mdev = 0.241/0.390/0.539/0.149 ms
+ sudo ip netns exec ns3 ping 10.10.20.10 -c 8 -t 10
[2020-12-24 10:56:41.082] [Router] [r3] [info] ARP reply '10.3.0.1 is at b6:d3:d7:8a:e4:d8'
[2020-12-24 10:56:41.082] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
PING 10.10.20.10 (10.10.20.10) 56(84) bytes of data.
64 bytes from 10.10.20.10: icmp_seq=1 ttl=63 time=0.355 ms
[2020-12-24 10:56:42.096] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=2 ttl=63 time=0.244 ms
[2020-12-24 10:56:43.120] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=3 ttl=63 time=0.313 ms
[2020-12-24 10:56:44.144] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=4 ttl=63 time=0.258 ms
[2020-12-24 10:56:45.168] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=5 ttl=63 time=0.312 ms
[2020-12-24 10:56:46.192] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=6 ttl=63 time=0.322 ms
[2020-12-24 10:56:47.216] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=7 ttl=63 time=0.246 ms
[2020-12-24 10:56:48.240] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=8 ttl=63 time=0.249 ms

--- 10.10.20.10 ping statistics ---
8 packets transmitted, 8 received, 0% packet loss, time 7158ms
rtt min/avg/max/mdev = 0.244/0.287/0.355/0.042 ms
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:56:48.251] [Router] [r1] [info] ARP reply '10.1.0.2 is at 0a:1d:d8:6a:eb:58'
[2020-12-24 10:56:48.251] [Router] [r2] [info] ARP reply '10.0.2.1 is at aa:ea:49:67:21:4a'
[2020-12-24 10:56:48.252] [Router] [r2] [info] ARP reply '10.1.0.1 is at aa:c8:55:82:1d:42'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.497 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.058/0.277/0.497/0.220 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.033 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.059 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.033/0.046/0.059/0.013 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.028 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.028/0.043/0.058/0.015 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.035 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.066 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.035/0.050/0.066/0.017 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=61 time=0.035 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=61 time=0.062 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.035/0.048/0.062/0.015 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.029 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.029/0.044/0.060/0.016 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ test_fail sudo ip netns exec ns1 ping 10.0.2.2 -b -t1 -c 2 -i 0.5
+ set +e
++ sudo ip netns exec ns1 ping 10.0.2.2 -b -t1 -c 2 -i 0.5
[2020-12-24 10:56:51.356] [Router] [r1] [info] send ICMP packet TIME_EXCEDEED code to host 10.0.1.1
[2020-12-24 10:56:51.888] [Router] [r1] [info] send ICMP packet TIME_EXCEDEED code to host 10.0.1.1
+ res='PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
From 10.0.1.254 icmp_seq=1 Time to live exceeded
From 10.0.1.254 icmp_seq=2 Time to live exceeded

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 532ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_routers 3
++ seq 1 3
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:56:51.897] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 10:56:55.010] [Router] [r2] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r3
[2020-12-24 10:56:56.587] [Router] [r3] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test3_3s_xdp.sh" time="51.000000" status="Passed"><system-out>[2020-12-24 10:56:57.780] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:56:57.780] [polycubed] [info] configuration parameters: 
[2020-12-24 10:56:57.781] [polycubed] [info]  loglevel: info
[2020-12-24 10:56:57.781] [polycubed] [info]  daemon: false
[2020-12-24 10:56:57.781] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:56:57.781] [polycubed] [info]  port: 9000
[2020-12-24 10:56:57.781] [polycubed] [info]  addr: localhost
[2020-12-24 10:56:57.781] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:56:57.781] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:56:57.781] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:56:57.781] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:56:57.781] [polycubed] [info] polycubed starting...
[2020-12-24 10:56:57.781] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:56:59.992] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:56:59.993] [polycubed] [info] rest server starting ...
[2020-12-24 10:57:00.036] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:57:00.048] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:57:00.062] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:57:00.073] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:57:00.106] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:57:00.117] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:57:00.159] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:57:00.191] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:57:00.226] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:57:00.269] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:57:00.313] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:57:00.335] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:57:00.347] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:57:00.362] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:57:00.372] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:57:00.381] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:57:00.423] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:57:00.470] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:57:00.470] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-router/test/test3_3s.sh XDP_SKB
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ TYPE=TC
+ '[' -n XDP_SKB ']'
+ TYPE=XDP_SKB
+ polycubectl router add r1 type=XDP_SKB
[2020-12-24 10:57:03.776] [Router] [r1] [info] Creating Router instance
+ polycubectl router add r2 type=XDP_SKB
[2020-12-24 10:57:05.457] [Router] [r2] [info] Creating Router instance
+ polycubectl router add r3 type=XDP_SKB
[2020-12-24 10:57:07.135] [Router] [r3] [info] Creating Router instance
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 10:57:07.142] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 16:b8:09:63:82:b4 - ip: 10.0.1.254/24]
[2020-12-24 10:57:07.142] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 10:57:07.142] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
+ router_add_port r1 to_r2 10.10.10.10/24
+ polycubectl router r1 ports add to_r2 ip=10.10.10.10/24
[2020-12-24 10:57:08.846] [Router] [r1] [info] Added new port: to_r2 (index: 1) [mac: 5a:8b:70:f1:0c:82 - ip: 10.10.10.10/24]
[2020-12-24 10:57:08.846] [Router] [r1] [info] Added route [network: 10.10.10.10/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:57:08.846] [Router] [r1] [info] Added route [network: 10.10.10.0/24 - nexthop: 0.0.0.0 - interface: to_r2]
+ router_add_port r2 to_r1 10.10.20.10/24
+ polycubectl router r2 ports add to_r1 ip=10.10.20.10/24
[2020-12-24 10:57:08.851] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: 3e:8b:d0:82:63:f0 - ip: 10.10.20.10/24]
[2020-12-24 10:57:08.851] [Router] [r2] [info] Added route [network: 10.10.20.10/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:57:08.852] [Router] [r2] [info] Added route [network: 10.10.20.0/24 - nexthop: 0.0.0.0 - interface: to_r1]
+ connect_router_secondary_p_to_p r1 r2 1
+ polycubectl router r1 ports to_r2 secondaryip add 10.1.0.1/30
[2020-12-24 10:57:08.856] [Router] [r1] [info] Adding secondary address [port: to_r2 - ip: 10.1.0.1/30]
[2020-12-24 10:57:08.856] [Router] [r1] [info] Added route [network: 10.1.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:57:08.856] [Router] [r1] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports to_r1 secondaryip add 10.1.0.2/30
[2020-12-24 10:57:08.861] [Router] [r2] [info] Adding secondary address [port: to_r1 - ip: 10.1.0.2/30]
[2020-12-24 10:57:08.861] [Router] [r2] [info] Added route [network: 10.1.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:57:08.861] [Router] [r2] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ router_add_port r2 to_veth2 12.10.1.1/24
+ polycubectl router r2 ports add to_veth2 ip=12.10.1.1/24
[2020-12-24 10:57:15.066] [Router] [r2] [info] Added new port: to_veth2 (index: 1) [mac: 7a:3a:b4:18:6b:1f - ip: 12.10.1.1/24]
[2020-12-24 10:57:15.066] [Router] [r2] [info] Added route [network: 12.10.1.1/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:57:15.066] [Router] [r2] [info] Added route [network: 12.10.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ router_add_secondary_as_gateway r2 veth2 2
+ polycubectl router r2 ports to_veth2 secondaryip add 10.0.2.254/24
[2020-12-24 10:57:15.071] [Router] [r2] [info] Adding secondary address [port: to_veth2 - ip: 10.0.2.254/24]
[2020-12-24 10:57:15.071] [Router] [r2] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 10:57:15.071] [Router] [r2] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 ports to_veth2 set peer=veth2
+ connect_router_p_to_p r1 r3 2
+ polycubectl router r1 ports add to_r3 ip=10.2.0.1/30
[2020-12-24 10:57:16.916] [Router] [r1] [info] Added new port: to_r3 (index: 2) [mac: fa:74:46:85:a0:54 - ip: 10.2.0.1/30]
[2020-12-24 10:57:16.916] [Router] [r1] [info] Added route [network: 10.2.0.1/32 - nexthop: 0.0.0.0 - interface: to_r3]
[2020-12-24 10:57:16.916] [Router] [r1] [info] Added route [network: 10.2.0.0/30 - nexthop: 0.0.0.0 - interface: to_r3]
+ polycubectl router r3 ports add to_r1 ip=10.2.0.2/30
[2020-12-24 10:57:16.921] [Router] [r3] [info] Added new port: to_r1 (index: 0) [mac: 96:b4:2a:2d:49:cf - ip: 10.2.0.2/30]
[2020-12-24 10:57:16.921] [Router] [r3] [info] Added route [network: 10.2.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:57:16.921] [Router] [r3] [info] Added route [network: 10.2.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r3 r3:to_r1
+ connect_router_p_to_p r2 r3 3
+ polycubectl router r2 ports add to_r3 ip=10.3.0.1/30
[2020-12-24 10:57:23.167] [Router] [r2] [info] Added new port: to_r3 (index: 2) [mac: 7a:d7:27:db:ed:64 - ip: 10.3.0.1/30]
[2020-12-24 10:57:23.167] [Router] [r2] [info] Added route [network: 10.3.0.1/32 - nexthop: 0.0.0.0 - interface: to_r3]
[2020-12-24 10:57:23.167] [Router] [r2] [info] Added route [network: 10.3.0.0/30 - nexthop: 0.0.0.0 - interface: to_r3]
+ polycubectl router r3 ports add to_r2 ip=10.3.0.2/30
[2020-12-24 10:57:23.172] [Router] [r3] [info] Added new port: to_r2 (index: 1) [mac: 1a:c1:40:db:4b:e9 - ip: 10.3.0.2/30]
[2020-12-24 10:57:23.172] [Router] [r3] [info] Added route [network: 10.3.0.2/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:57:23.172] [Router] [r3] [info] Added route [network: 10.3.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl connect r2:to_r3 r3:to_r2
+ router_add_port_as_gateway r3 veth3 3
+ polycubectl router r3 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 10:57:29.374] [Router] [r3] [info] Added new port: to_veth3 (index: 2) [mac: 02:25:e6:e3:15:1a - ip: 10.0.3.254/24]
[2020-12-24 10:57:29.374] [Router] [r3] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 10:57:29.374] [Router] [r3] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r3 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r3 ports to_veth3 set peer=veth3'
+ polycubectl router r3 ports to_veth3 set peer=veth3
+ router_add_route r1 0.0.0.0/0 10.1.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 route add 0.0.0.0/0 10.1.0.2
[2020-12-24 10:57:31.214] [Router] [r1] [info] Creating Route instance
[2020-12-24 10:57:31.214] [Router] [r1] [info] Adding route [network: 0.0.0.0/0 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 1]
+ router_add_route r2 10.0.1.0/24 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.1.0.1
[2020-12-24 10:57:31.218] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:57:31.219] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r2 10.0.3.0/24 10.3.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.3.0/24 10.3.0.2
[2020-12-24 10:57:31.223] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:57:31.223] [Router] [r2] [info] Adding route [network: 10.0.3.0/24 - nexthop: 10.3.0.2 - interface: to_r3 - path cost: 1]
+ router_add_route r3 10.0.1.0/24 10.2.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.0.1.0/24 10.2.0.1
[2020-12-24 10:57:31.227] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:57:31.227] [Router] [r3] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.2.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r3 10.0.2.0/24 10.3.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.0.2.0/24 10.3.0.1
[2020-12-24 10:57:31.231] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:57:31.231] [Router] [r3] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.3.0.1 - interface: to_r2 - path cost: 1]
+ router_add_route r3 10.10.10.10/32 10.2.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.10.10.10/32 10.2.0.1
[2020-12-24 10:57:31.236] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:57:31.236] [Router] [r3] [info] Adding route [network: 10.10.10.10/32 - nexthop: 10.2.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r3 10.10.20.10/32 10.3.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r3 route add 10.10.20.10/32 10.3.0.1
[2020-12-24 10:57:31.240] [Router] [r3] [info] Creating Route instance
[2020-12-24 10:57:31.240] [Router] [r3] [info] Adding route [network: 10.10.20.10/32 - nexthop: 10.3.0.1 - interface: to_r2 - path cost: 1]
+ router_routingtable_show r1
+ polycubectl router r1 route show
Size of the terminal is too small, output could be missaligned.interface  network        nexthop   pathcost
to_r2      0.0.0.0/0      10.1.0.2  1
to_veth1   10.0.1.0/24    local     0
to_r2      10.1.0.0/30    local     0
to_r2      10.10.10.0/24  local     0
to_r3      10.2.0.0/30    local     0

+ router_routingtable_show r2
+ polycubectl router r2 route show
Size of the terminal is too small, output could be missaligned.interface  network        nexthop   pathcost
to_r1      10.0.1.0/24    10.1.0.1  1
to_veth2   10.0.2.0/24    local     0
to_r3      10.0.3.0/24    10.3.0.2  1
to_r1      10.1.0.0/30    local     0
to_r1      10.10.20.0/24  local     0
to_r3      10.3.0.0/30    local     0
to_veth2   12.10.1.0/24   local     0

+ router_routingtable_show r3
+ polycubectl router r3 route show
Size of the terminal is too small, output could be missaligned.interface  network         nexthop   pathcost
to_r1      10.0.1.0/24     10.2.0.1  1
to_r2      10.0.2.0/24     10.3.0.1  1
to_veth3   10.0.3.0/24     local     0
to_r1      10.10.10.10/32  10.2.0.1  1
to_r2      10.10.20.10/32  10.3.0.1  1
to_r1      10.2.0.0/30     local     0
to_r2      10.3.0.0/30     local     0

+ sudo ip netns exec ns3 ping 10.10.10.10 -c 2 -i 0.5 -t 10
[2020-12-24 10:57:31.297] [Router] [r3] [info] ARP reply '10.2.0.1 is at fa:74:46:85:a0:54'
[2020-12-24 10:57:31.297] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.10
PING 10.10.10.10 (10.10.10.10) 56(84) bytes of data.
64 bytes from 10.10.10.10: icmp_seq=1 ttl=63 time=0.448 ms
[2020-12-24 10:57:31.824] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.10.10
64 bytes from 10.10.10.10: icmp_seq=2 ttl=63 time=0.295 ms

--- 10.10.10.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 527ms
rtt min/avg/max/mdev = 0.295/0.371/0.448/0.078 ms
+ sudo ip netns exec ns3 ping 10.10.20.10 -c 8 -t 10
[2020-12-24 10:57:31.834] [Router] [r3] [info] ARP reply '10.3.0.1 is at 7a:d7:27:db:ed:64'
[2020-12-24 10:57:31.834] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
PING 10.10.20.10 (10.10.20.10) 56(84) bytes of data.
64 bytes from 10.10.20.10: icmp_seq=1 ttl=63 time=0.354 ms
[2020-12-24 10:57:32.848] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=2 ttl=63 time=0.242 ms
[2020-12-24 10:57:33.872] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=3 ttl=63 time=0.265 ms
[2020-12-24 10:57:34.896] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=4 ttl=63 time=0.264 ms
[2020-12-24 10:57:35.920] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=5 ttl=63 time=0.306 ms
[2020-12-24 10:57:36.944] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=6 ttl=63 time=0.249 ms
[2020-12-24 10:57:37.968] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=7 ttl=63 time=0.264 ms
[2020-12-24 10:57:38.992] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.20.10
64 bytes from 10.10.20.10: icmp_seq=8 ttl=63 time=0.309 ms

--- 10.10.20.10 ping statistics ---
8 packets transmitted, 8 received, 0% packet loss, time 7158ms
rtt min/avg/max/mdev = 0.242/0.281/0.354/0.040 ms
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:57:39.004] [Router] [r1] [info] ARP reply '10.1.0.2 is at 3e:8b:d0:82:63:f0'
[2020-12-24 10:57:39.004] [Router] [r2] [info] ARP reply '10.0.2.1 is at d6:93:16:45:cf:aa'
[2020-12-24 10:57:39.004] [Router] [r2] [info] ARP reply '10.1.0.1 is at 5a:8b:70:f1:0c:82'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.501 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.057 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 500ms
rtt min/avg/max/mdev = 0.057/0.279/0.501/0.222 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.029 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.046/0.064/0.018 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.030 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.030/0.044/0.058/0.014 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.027 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.027/0.042/0.058/0.016 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=61 time=0.036 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=61 time=0.062 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.036/0.049/0.062/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.029 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.055 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.029/0.042/0.055/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ test_fail sudo ip netns exec ns1 ping 10.0.2.2 -b -t1 -c 2 -i 0.5
+ set +e
++ sudo ip netns exec ns1 ping 10.0.2.2 -b -t1 -c 2 -i 0.5
[2020-12-24 10:57:42.106] [Router] [r1] [info] send ICMP packet TIME_EXCEDEED code to host 10.0.1.1
[2020-12-24 10:57:42.608] [Router] [r1] [info] send ICMP packet TIME_EXCEDEED code to host 10.0.1.1
+ res='PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
From 10.0.1.254 icmp_seq=1 Time to live exceeded
From 10.0.1.254 icmp_seq=2 Time to live exceeded

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 502ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ cleanup
+ set +e
+ del_routers 3
++ seq 1 3
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:57:42.616] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 10:57:45.722] [Router] [r2] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r3
[2020-12-24 10:57:47.299] [Router] [r3] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/bridge/test2_2_4.sh" time="49.000000" status="Passed"><system-out>[2020-12-24 10:57:48.480] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:57:48.481] [polycubed] [info] configuration parameters: 
[2020-12-24 10:57:48.481] [polycubed] [info]  loglevel: info
[2020-12-24 10:57:48.481] [polycubed] [info]  daemon: false
[2020-12-24 10:57:48.481] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:57:48.481] [polycubed] [info]  port: 9000
[2020-12-24 10:57:48.481] [polycubed] [info]  addr: localhost
[2020-12-24 10:57:48.481] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:57:48.481] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:57:48.481] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:57:48.481] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:57:48.481] [polycubed] [info] polycubed starting...
[2020-12-24 10:57:48.481] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:57:50.707] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:57:50.708] [polycubed] [info] rest server starting ...
[2020-12-24 10:57:50.752] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:57:50.763] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:57:50.778] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:57:50.788] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:57:50.821] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:57:50.832] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:57:50.874] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:57:50.907] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:57:50.942] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:57:50.985] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:57:51.029] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:57:51.052] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:57:51.063] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:57:51.079] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:57:51.089] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:57:51.098] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:57:51.140] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:57:51.188] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:57:51.188] [polycubed] [info] loading metrics from yang files
+ create_veth_subnet 4 2
+ count=1
+ net=1
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.1.2/24
+ sudo ip netns exec ns2 route add default gw 10.0.1.254 veth2_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.2.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.2.254 veth3_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.2.2/24
+ sudo ip netns exec ns4 route add default gw 10.0.2.254 veth4_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ set -e
+ TYPE=TC
+ '[' -n '' ']'
+ polycubectl router add r1 type=TC
[2020-12-24 10:57:54.601] [Router] [r1] [info] Creating Router instance
+ polycubectl router add r2 type=TC
[2020-12-24 10:57:56.264] [Router] [r2] [info] Creating Router instance
+ polycubectl simplebridge add br1 type=TC
[2020-12-24 10:57:57.135] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:57:57.135] [Simplebridge] [br1] [info] Creating Fdb instance
+ polycubectl simplebridge add br2 type=TC
[2020-12-24 10:57:57.999] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:57:57.999] [Simplebridge] [br2] [info] Creating Fdb instance
+ router_add_port r1 to_br1 10.10.2.1/24
+ polycubectl router r1 ports add to_br1 ip=10.10.2.1/24
[2020-12-24 10:57:58.006] [Router] [r1] [info] Added new port: to_br1 (index: 0) [mac: 02:5e:8f:c1:02:38 - ip: 10.10.2.1/24]
[2020-12-24 10:57:58.006] [Router] [r1] [info] Added route [network: 10.10.2.1/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:57:58.006] [Router] [r1] [info] Added route [network: 10.10.2.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ bridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ router_add_secondary_as_gateway r1 br1 1 br1
+ polycubectl router r1 ports to_br1 secondaryip add 10.0.1.254/24
[2020-12-24 10:57:59.924] [Router] [r1] [info] Adding secondary address [port: to_br1 - ip: 10.0.1.254/24]
[2020-12-24 10:57:59.924] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:57:59.924] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br1 ports add to_r1
+ polycubectl connect br1:to_r1 r1:to_br1
+ connect_router_p_to_p r1 r2 1
+ polycubectl router r1 ports add to_r2 ip=10.1.0.1/30
[2020-12-24 10:58:04.507] [Router] [r1] [info] Added new port: to_r2 (index: 1) [mac: a6:f0:1d:d8:5c:66 - ip: 10.1.0.1/30]
[2020-12-24 10:58:04.507] [Router] [r1] [info] Added route [network: 10.1.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:58:04.507] [Router] [r1] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports add to_r1 ip=10.1.0.2/30
[2020-12-24 10:58:04.513] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: 2a:5a:d3:9c:b3:4a - ip: 10.1.0.2/30]
[2020-12-24 10:58:04.513] [Router] [r2] [info] Added route [network: 10.1.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:58:04.513] [Router] [r2] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ bridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ bridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ router_add_port_as_gateway r2 br2 2 br2
+ polycubectl router r2 ports add to_br2 ip=10.0.2.254/24
[2020-12-24 10:58:12.657] [Router] [r2] [info] Added new port: to_br2 (index: 1) [mac: 9a:59:b5:4d:9a:ca - ip: 10.0.2.254/24]
[2020-12-24 10:58:12.657] [Router] [r2] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 10:58:12.657] [Router] [r2] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br2 ports add to_r2
+ polycubectl connect br2:to_r2 r2:to_br2
+ router_add_route r1 10.0.2.0/24 10.1.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 route add 10.0.2.0/24 10.1.0.2
[2020-12-24 10:58:17.267] [Router] [r1] [info] Creating Route instance
[2020-12-24 10:58:17.267] [Router] [r1] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 1]
+ router_add_route r2 10.0.1.0/24 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.1.0.1
[2020-12-24 10:58:17.272] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:58:17.272] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r2 10.10.2.1/32 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.10.2.1/32 10.1.0.1
[2020-12-24 10:58:17.278] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:58:17.278] [Router] [r2] [info] Adding route [network: 10.10.2.1/32 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ ping_cycle_subnet 4 2
++ seq 1 4
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=64 time=0.255 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 518ms
rtt min/avg/max/mdev = 0.056/0.155/0.255/0.100 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:58:17.849] [Router] [r1] [info] ARP reply '10.1.0.2 is at 2a:5a:d3:9c:b3:4a'
[2020-12-24 10:58:17.849] [Router] [r2] [info] ARP reply '10.0.2.1 is at ea:16:6a:aa:09:54'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.544 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.066 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.066/0.305/0.544/0.239 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.2.2 -c 2 -i 0.5
[2020-12-24 10:58:18.362] [Router] [r2] [info] ARP reply '10.0.2.2 is at 06:13:75:1e:3f:22'
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=62 time=0.483 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=62 time=0.067 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.067/0.275/0.483/0.208 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=64 time=0.028 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.028/0.040/0.053/0.014 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.177 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.064/0.120/0.177/0.057 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=62 time=0.040 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.040/0.050/0.061/0.012 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.034 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.034/0.047/0.060/0.013 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.032 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.046/0.061/0.016 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=64 time=0.184 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=64 time=0.058 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.058/0.121/0.184/0.063 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.039 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.039/0.048/0.058/0.011 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.030 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.030/0.045/0.061/0.016 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.026 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=64 time=0.031 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 507ms
rtt min/avg/max/mdev = 0.026/0.028/0.031/0.005 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ ping_special 4 10.10.2.1 10.1.0.1 10.1.0.2
++ seq 1 4
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:58:23.486] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=64 time=0.199 ms
[2020-12-24 10:58:24.016] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=64 time=0.240 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 529ms
rtt min/avg/max/mdev = 0.199/0.219/0.240/0.025 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:58:24.025] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=64 time=0.152 ms
[2020-12-24 10:58:24.528] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=64 time=0.281 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.152/0.216/0.281/0.066 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:58:24.537] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=63 time=0.156 ms
[2020-12-24 10:58:25.040] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=63 time=0.256 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.156/0.206/0.256/0.050 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:58:25.049] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=64 time=0.153 ms
[2020-12-24 10:58:25.552] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=64 time=0.230 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.153/0.191/0.230/0.040 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:58:25.561] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=64 time=0.159 ms
[2020-12-24 10:58:26.064] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=64 time=0.320 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.159/0.239/0.320/0.081 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:58:26.073] [Router] [r2] [info] new echo request arrived from 10.0.1.2 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=63 time=0.185 ms
[2020-12-24 10:58:26.576] [Router] [r2] [info] new echo request arrived from 10.0.1.2 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=63 time=0.224 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.185/0.204/0.224/0.024 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:58:26.585] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=63 time=0.147 ms
[2020-12-24 10:58:27.088] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=63 time=0.249 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.147/0.198/0.249/0.051 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:58:27.098] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=63 time=0.214 ms
[2020-12-24 10:58:27.600] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=63 time=0.321 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.214/0.267/0.321/0.055 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:58:27.648] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=64 time=0.248 ms
[2020-12-24 10:58:28.176] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=64 time=0.324 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 528ms
rtt min/avg/max/mdev = 0.248/0.286/0.324/0.038 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:58:28.186] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=63 time=0.248 ms
[2020-12-24 10:58:28.688] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=63 time=0.229 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.229/0.238/0.248/0.018 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:58:28.697] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=63 time=0.151 ms
[2020-12-24 10:58:29.200] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=63 time=0.232 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.151/0.191/0.232/0.042 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:58:29.209] [Router] [r2] [info] new echo request arrived from 10.0.2.2 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=64 time=0.140 ms
[2020-12-24 10:58:29.712] [Router] [r2] [info] new echo request arrived from 10.0.2.2 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=64 time=0.235 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.140/0.187/0.235/0.049 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ cleanup
+ set +e
+ del_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:58:29.721] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:58:31.732] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ del_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:58:33.593] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 10:58:35.139] [Router] [r2] [info] Destroying Router instance
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-router/test/bridge/test2_2_4_special.sh" time="40.000000" status="Passed"><system-out>[2020-12-24 10:58:37.337] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:58:37.338] [polycubed] [info] configuration parameters: 
[2020-12-24 10:58:37.338] [polycubed] [info]  loglevel: info
[2020-12-24 10:58:37.338] [polycubed] [info]  daemon: false
[2020-12-24 10:58:37.338] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:58:37.338] [polycubed] [info]  port: 9000
[2020-12-24 10:58:37.338] [polycubed] [info]  addr: localhost
[2020-12-24 10:58:37.338] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:58:37.338] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:58:37.338] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:58:37.338] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:58:37.338] [polycubed] [info] polycubed starting...
[2020-12-24 10:58:37.338] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:58:39.538] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:58:39.539] [polycubed] [info] rest server starting ...
[2020-12-24 10:58:39.584] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:58:39.595] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:58:39.610] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:58:39.621] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:58:39.654] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:58:39.665] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:58:39.708] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:58:39.742] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:58:39.777] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:58:39.821] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:58:39.866] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:58:39.889] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:58:39.901] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:58:39.917] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:58:39.926] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:58:39.936] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:58:39.979] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:58:40.028] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:58:40.028] [polycubed] [info] loading metrics from yang files
+ create_veth_subnet 4 2
+ count=1
+ net=1
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.1.2/24
+ sudo ip netns exec ns2 route add default gw 10.0.1.254 veth2_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.2.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.2.254 veth3_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.2.2/24
+ sudo ip netns exec ns4 route add default gw 10.0.2.254 veth4_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ set -e
+ add_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router add r1 loglevel=DEBUG
[2020-12-24 10:58:43.471] [Router] [r1] [info] Creating Router instance
+ for i in `seq 1 $1`
+ polycubectl router add r2 loglevel=DEBUG
[2020-12-24 10:58:45.156] [Router] [r2] [info] Creating Router instance
+ add_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 10:58:46.043] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:58:46.043] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 10:58:46.913] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:58:46.913] [Simplebridge] [br2] [info] Creating Fdb instance
+ router_add_port_as_gateway r1 br1 1 br1
+ polycubectl router r1 ports add to_br1 ip=10.0.1.254/24
[2020-12-24 10:58:46.920] [Router] [r1] [info] Added new port: to_br1 (index: 0) [mac: 62:6e:96:1e:17:e8 - ip: 10.0.1.254/24]
[2020-12-24 10:58:46.920] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:58:46.920] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br1 ports add to_r1
+ polycubectl connect br1:to_r1 r1:to_br1
+ bridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ polycubectl simplebridge br1 ports add to_r2
+ router_add_port_as_gateway r2 br2 2 br2
+ polycubectl router r2 ports add to_br2 ip=10.0.2.254/24
[2020-12-24 10:58:53.581] [Router] [r2] [info] Added new port: to_br2 (index: 0) [mac: 4a:f5:22:a7:5a:32 - ip: 10.0.2.254/24]
[2020-12-24 10:58:53.581] [Router] [r2] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 10:58:53.581] [Router] [r2] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br2 ports add to_r2
+ polycubectl connect br2:to_r2 r2:to_br2
[2020-12-24 10:58:55.665] [polycubed] [warning] packetout: port br1:to_r2 is down
[2020-12-24 10:58:55.665] [polycubed] [warning] packetout: port br1:to_r2 is down
+ router_add_port r2 to_br1 10.0.1.253/24
+ polycubectl router r2 ports add to_br1 ip=10.0.1.253/24
[2020-12-24 10:58:58.174] [Router] [r2] [info] Added new port: to_br1 (index: 1) [mac: 52:37:59:f7:05:3f - ip: 10.0.1.253/24]
[2020-12-24 10:58:58.174] [Router] [r2] [info] Added route [network: 10.0.1.253/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:58:58.174] [Router] [r2] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ bridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ bridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ polycubectl connect br1:to_r2 r2:to_br1
+ router_add_route r1 10.0.2.0/24 10.0.1.253
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 route add 10.0.2.0/24 10.0.1.253
[2020-12-24 10:59:04.797] [Router] [r1] [debug] Trying to add route [network: 10.0.2.0/24 - nexthop: 10.0.1.253]
[2020-12-24 10:59:04.797] [Router] [r1] [info] Creating Route instance
[2020-12-24 10:59:04.797] [Router] [r1] [debug] Adding route [network: 10.0.2.0/24 - nexthop: 10.0.1.253 - path cost: 1]
[2020-12-24 10:59:04.797] [Router] [r1] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.0.1.253 - interface: to_br1 - path cost: 1]
[2020-12-24 10:59:04.797] [Router] [r1] [debug] The new path cost '1' is better than the previous '2147483647'
+ router_add_route r2 10.0.1.0/24 10.0.1.254
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.0.1.254
[2020-12-24 10:59:04.802] [Router] [r2] [debug] Trying to add route [network: 10.0.1.0/24 - nexthop: 10.0.1.254]
[2020-12-24 10:59:04.802] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:59:04.802] [Router] [r2] [debug] Adding route [network: 10.0.1.0/24 - nexthop: 10.0.1.254 - path cost: 1]
[2020-12-24 10:59:04.802] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.0.1.254 - interface: to_br1 - path cost: 1]
[2020-12-24 10:59:04.802] [Router] [r2] [debug] There is a local entry. Route do not added to the datapath
+ sudo ip netns exec ns1 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=64 time=0.179 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 515ms
rtt min/avg/max/mdev = 0.054/0.116/0.179/0.063 ms
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:59:05.337] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:59:05.337] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 10:59:05.337] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 10:59:05.337] [Router] [r1] [debug] sending ARP request on port to_br1 'who has 10.0.1.253 tell MAC to 10.0.1.254
[2020-12-24 10:59:05.337] [Router] [r2] [debug] somebody is asking for my address
[2020-12-24 10:59:05.337] [Router] [r1] [debug] packet is arp reply
[2020-12-24 10:59:05.337] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 10:59:05.337] [Router] [r1] [info] ARP reply '10.0.1.253 is at 52:37:59:f7:05:3f'
[2020-12-24 10:59:05.337] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 10:59:05.337] [Router] [r2] [debug] Packet received from port to_br1
[2020-12-24 10:59:05.337] [Router] [r2] [debug] sending ARP request on port to_br2 'who has 10.0.2.1 tell MAC to 10.0.2.254
[2020-12-24 10:59:05.337] [Router] [r2] [debug] packet is arp reply
[2020-12-24 10:59:05.337] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 10:59:05.337] [Router] [r2] [info] ARP reply '10.0.2.1 is at 9e:12:93:63:eb:1c'
[2020-12-24 10:59:05.337] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 10:59:05.337] [Router] [r2] [debug] sending ARP request on port to_br1 'who has 10.0.1.1 tell MAC to 10.0.1.253
[2020-12-24 10:59:05.338] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 10:59:05.338] [Router] [r2] [debug] Packet received from port to_br1
[2020-12-24 10:59:05.338] [Router] [r2] [debug] packet is arp reply
[2020-12-24 10:59:05.338] [Router] [r2] [info] ARP reply '10.0.1.1 is at f2:71:dc:5f:f2:44'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.844 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.052 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.052/0.448/0.844/0.396 ms
+ sudo ip netns exec ns1 ping 10.0.2.2 -c 2 -i 0.5
[2020-12-24 10:59:05.849] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 10:59:05.849] [Router] [r2] [debug] Packet received from port to_br1
[2020-12-24 10:59:05.849] [Router] [r2] [debug] sending ARP request on port to_br2 'who has 10.0.2.2 tell MAC to 10.0.2.254
[2020-12-24 10:59:05.849] [Router] [r2] [debug] packet is arp reply
[2020-12-24 10:59:05.849] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 10:59:05.849] [Router] [r2] [info] ARP reply '10.0.2.2 is at ba:d2:ef:21:3f:df'
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=63 time=0.438 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.058/0.248/0.438/0.190 ms
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=64 time=0.050 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.024/0.037/0.050/0.013 ms
+ sudo ip netns exec ns2 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:59:06.873] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 10:59:06.873] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 10:59:06.873] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 10:59:06.873] [Router] [r2] [debug] sending ARP request on port to_br1 'who has 10.0.1.2 tell MAC to 10.0.1.253
[2020-12-24 10:59:06.873] [Router] [r2] [debug] packet is arp reply
[2020-12-24 10:59:06.873] [Router] [r2] [debug] Packet received from port to_br1
[2020-12-24 10:59:06.874] [Router] [r2] [info] ARP reply '10.0.1.2 is at 96:e5:90:50:e6:f6'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.485 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.055 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.055/0.270/0.485/0.215 ms
+ sudo ip netns exec ns2 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=63 time=0.032 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=63 time=0.061 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.046/0.061/0.016 ms
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.033 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.063 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.033/0.048/0.063/0.015 ms
+ sudo ip netns exec ns3 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.028 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.028/0.046/0.064/0.018 ms
+ sudo ip netns exec ns3 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=64 time=0.175 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.054/0.114/0.175/0.061 ms
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.029 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.045/0.061/0.016 ms
+ sudo ip netns exec ns4 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.031 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.031/0.045/0.060/0.016 ms
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.023 ms
[2020-12-24 10:59:10.512] [Router] [r2] [debug] somebody is asking for my address
64 bytes from 10.0.2.1: icmp_seq=2 ttl=64 time=0.052 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.023/0.037/0.052/0.015 ms
+ cleanup
+ set +e
+ del_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 10:59:10.968] [Router] [r1] [info] Destroying Router instance
[2020-12-24 10:59:11.024] [Router] [r2] [debug] somebody is asking for my address
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 10:59:11.709] [Router] [r2] [info] Destroying Router instance
+ del_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:59:13.196] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 10:59:14.083] [Simplebridge] [br2] [info] Destroying Simplebridge instance
[2020-12-24 10:59:14.096] [polycubed] [warning] packetout: port br2:to_r2 is down
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-router/test/bridge/test2_2_4_xdp.sh" time="48.000000" status="Passed"><system-out>[2020-12-24 10:59:17.177] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 10:59:17.178] [polycubed] [info] configuration parameters: 
[2020-12-24 10:59:17.178] [polycubed] [info]  loglevel: info
[2020-12-24 10:59:17.178] [polycubed] [info]  daemon: false
[2020-12-24 10:59:17.178] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 10:59:17.178] [polycubed] [info]  port: 9000
[2020-12-24 10:59:17.178] [polycubed] [info]  addr: localhost
[2020-12-24 10:59:17.178] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 10:59:17.178] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 10:59:17.178] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 10:59:17.178] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 10:59:17.178] [polycubed] [info] polycubed starting...
[2020-12-24 10:59:17.178] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 10:59:19.405] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 10:59:19.406] [polycubed] [info] rest server starting ...
[2020-12-24 10:59:19.449] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 10:59:19.460] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 10:59:19.475] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 10:59:19.486] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 10:59:19.520] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 10:59:19.531] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 10:59:19.575] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 10:59:19.610] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 10:59:19.646] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 10:59:19.691] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 10:59:19.737] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 10:59:19.760] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 10:59:19.771] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 10:59:19.788] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 10:59:19.797] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 10:59:19.807] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 10:59:19.851] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 10:59:19.901] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 10:59:19.901] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-router/test/bridge/test2_2_4.sh XDP_SKB
+ create_veth_subnet 4 2
+ count=1
+ net=1
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.1.2/24
+ sudo ip netns exec ns2 route add default gw 10.0.1.254 veth2_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.2.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.2.254 veth3_
+ '[' 1 -ge 2 ']'
+ (( count++ ))
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.2.2/24
+ sudo ip netns exec ns4 route add default gw 10.0.2.254 veth4_
+ '[' 2 -ge 2 ']'
+ (( net++ ))
+ count=0
+ (( count++ ))
+ set -e
+ TYPE=TC
+ '[' -n XDP_SKB ']'
+ TYPE=XDP_SKB
+ polycubectl router add r1 type=XDP_SKB
[2020-12-24 10:59:23.305] [Router] [r1] [info] Creating Router instance
+ polycubectl router add r2 type=XDP_SKB
[2020-12-24 10:59:25.013] [Router] [r2] [info] Creating Router instance
+ polycubectl simplebridge add br1 type=XDP_SKB
[2020-12-24 10:59:25.885] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 10:59:25.885] [Simplebridge] [br1] [info] Creating Fdb instance
+ polycubectl simplebridge add br2 type=XDP_SKB
[2020-12-24 10:59:26.757] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 10:59:26.757] [Simplebridge] [br2] [info] Creating Fdb instance
+ router_add_port r1 to_br1 10.10.2.1/24
+ polycubectl router r1 ports add to_br1 ip=10.10.2.1/24
[2020-12-24 10:59:26.763] [Router] [r1] [info] Added new port: to_br1 (index: 0) [mac: 1a:05:f6:34:e8:04 - ip: 10.10.2.1/24]
[2020-12-24 10:59:26.763] [Router] [r1] [info] Added route [network: 10.10.2.1/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:59:26.763] [Router] [r1] [info] Added route [network: 10.10.2.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ bridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ router_add_secondary_as_gateway r1 br1 1 br1
+ polycubectl router r1 ports to_br1 secondaryip add 10.0.1.254/24
[2020-12-24 10:59:28.726] [Router] [r1] [info] Adding secondary address [port: to_br1 - ip: 10.0.1.254/24]
[2020-12-24 10:59:28.726] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 10:59:28.726] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br1 ports add to_r1
+ polycubectl connect br1:to_r1 r1:to_br1
+ connect_router_p_to_p r1 r2 1
+ polycubectl router r1 ports add to_r2 ip=10.1.0.1/30
[2020-12-24 10:59:33.391] [Router] [r1] [info] Added new port: to_r2 (index: 1) [mac: 92:54:9a:af:fd:57 - ip: 10.1.0.1/30]
[2020-12-24 10:59:33.391] [Router] [r1] [info] Added route [network: 10.1.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 10:59:33.391] [Router] [r1] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports add to_r1 ip=10.1.0.2/30
[2020-12-24 10:59:33.396] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: 82:e4:0f:03:16:ec - ip: 10.1.0.2/30]
[2020-12-24 10:59:33.396] [Router] [r2] [info] Added route [network: 10.1.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 10:59:33.396] [Router] [r2] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ bridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ bridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ router_add_port_as_gateway r2 br2 2 br2
+ polycubectl router r2 ports add to_br2 ip=10.0.2.254/24
[2020-12-24 10:59:41.564] [Router] [r2] [info] Added new port: to_br2 (index: 1) [mac: 0e:14:f3:84:44:32 - ip: 10.0.2.254/24]
[2020-12-24 10:59:41.564] [Router] [r2] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 10:59:41.564] [Router] [r2] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br2 ports add to_r2
+ polycubectl connect br2:to_r2 r2:to_br2
+ router_add_route r1 10.0.2.0/24 10.1.0.2
+ [[ 3 -eq 4 ]]
+ polycubectl router r1 route add 10.0.2.0/24 10.1.0.2
[2020-12-24 10:59:46.203] [Router] [r1] [info] Creating Route instance
[2020-12-24 10:59:46.203] [Router] [r1] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 1]
+ router_add_route r2 10.0.1.0/24 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.1.0.1
[2020-12-24 10:59:46.209] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:59:46.209] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ router_add_route r2 10.10.2.1/32 10.1.0.1
+ [[ 3 -eq 4 ]]
+ polycubectl router r2 route add 10.10.2.1/32 10.1.0.1
[2020-12-24 10:59:46.214] [Router] [r2] [info] Creating Route instance
[2020-12-24 10:59:46.214] [Router] [r2] [info] Adding route [network: 10.10.2.1/32 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 1]
+ ping_cycle_subnet 4 2
++ seq 1 4
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=64 time=0.269 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 504ms
rtt min/avg/max/mdev = 0.056/0.162/0.269/0.107 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 10:59:46.778] [Router] [r1] [info] ARP reply '10.1.0.2 is at 82:e4:0f:03:16:ec'
[2020-12-24 10:59:46.778] [Router] [r2] [info] ARP reply '10.0.2.1 is at d6:45:4d:43:a4:45'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.550 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.060/0.305/0.550/0.245 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.2.2 -c 2 -i 0.5
[2020-12-24 10:59:47.289] [Router] [r2] [info] ARP reply '10.0.2.2 is at f2:5b:e1:6d:08:03'
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=62 time=0.357 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.061/0.209/0.357/0.148 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=64 time=0.031 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.031/0.043/0.056/0.014 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.168 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.062/0.115/0.168/0.053 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=62 time=0.031 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.031/0.045/0.060/0.016 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.034 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.034/0.048/0.062/0.014 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.037 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.060 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.037/0.048/0.060/0.013 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.2.2 -c 2 -i 0.5
PING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.
64 bytes from 10.0.2.2: icmp_seq=1 ttl=64 time=0.280 ms
64 bytes from 10.0.2.2: icmp_seq=2 ttl=64 time=0.054 ms

--- 10.0.2.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.054/0.167/0.280/0.113 ms
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ for i in `seq 1 $1`
+ count=1
+ net=1
++ seq 1 4
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.035 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.035/0.048/0.062/0.015 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.1.2 -c 2 -i 0.5
PING 10.0.1.2 (10.0.1.2) 56(84) bytes of data.
64 bytes from 10.0.1.2: icmp_seq=1 ttl=62 time=0.030 ms
64 bytes from 10.0.1.2: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.1.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.030/0.044/0.058/0.014 ms
+ '[' 2 -ge 2 ']'
+ net=2
+ count=0
+ count=1
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.029 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=64 time=0.055 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.029/0.042/0.055/0.013 ms
+ '[' 1 -ge 2 ']'
+ count=2
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ '[' 2 -ge 2 ']'
+ net=3
+ count=0
+ count=1
+ ping_special 4 10.10.2.1 10.1.0.1 10.1.0.2
++ seq 1 4
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:59:52.410] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=64 time=0.267 ms
[2020-12-24 10:59:52.912] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=64 time=0.222 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.222/0.244/0.267/0.027 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:59:52.921] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=64 time=0.156 ms
[2020-12-24 10:59:53.424] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=64 time=0.314 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.156/0.235/0.314/0.079 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns1 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:59:53.434] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=63 time=0.221 ms
[2020-12-24 10:59:53.936] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=63 time=0.282 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.221/0.251/0.282/0.034 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:59:53.945] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=64 time=0.204 ms
[2020-12-24 10:59:54.448] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=64 time=0.227 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.204/0.215/0.227/0.018 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:59:54.457] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=64 time=0.132 ms
[2020-12-24 10:59:54.960] [Router] [r1] [info] new echo request arrived from 10.0.1.2 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=64 time=0.287 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.132/0.209/0.287/0.078 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns2 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:59:54.969] [Router] [r2] [info] new echo request arrived from 10.0.1.2 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=63 time=0.152 ms
[2020-12-24 10:59:55.472] [Router] [r2] [info] new echo request arrived from 10.0.1.2 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=63 time=0.279 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.152/0.215/0.279/0.065 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:59:55.481] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=63 time=0.172 ms
[2020-12-24 10:59:55.984] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=63 time=0.226 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.172/0.199/0.226/0.027 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:59:55.993] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=63 time=0.155 ms
[2020-12-24 10:59:56.496] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=63 time=0.237 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.155/0.196/0.237/0.041 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns3 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:59:56.535] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=64 time=0.241 ms
[2020-12-24 10:59:57.040] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=64 time=0.245 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 505ms
rtt min/avg/max/mdev = 0.241/0.243/0.245/0.002 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.10.2.1 -c 2 -i 0.5
[2020-12-24 10:59:57.052] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.10.2.1
PING 10.10.2.1 (10.10.2.1) 56(84) bytes of data.
64 bytes from 10.10.2.1: icmp_seq=1 ttl=63 time=0.171 ms
[2020-12-24 10:59:57.584] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.10.2.1
64 bytes from 10.10.2.1: icmp_seq=2 ttl=63 time=0.322 ms

--- 10.10.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.171/0.246/0.322/0.077 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.1.0.1 -c 2 -i 0.5
[2020-12-24 10:59:57.593] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.1.0.1
PING 10.1.0.1 (10.1.0.1) 56(84) bytes of data.
64 bytes from 10.1.0.1: icmp_seq=1 ttl=63 time=0.155 ms
[2020-12-24 10:59:58.096] [Router] [r1] [info] new echo request arrived from 10.0.2.2 to 10.1.0.1
64 bytes from 10.1.0.1: icmp_seq=2 ttl=63 time=0.245 ms

--- 10.1.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.155/0.200/0.245/0.045 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ sudo ip netns exec ns4 ping 10.1.0.2 -c 2 -i 0.5
[2020-12-24 10:59:58.105] [Router] [r2] [info] new echo request arrived from 10.0.2.2 to 10.1.0.2
PING 10.1.0.2 (10.1.0.2) 56(84) bytes of data.
64 bytes from 10.1.0.2: icmp_seq=1 ttl=64 time=0.158 ms
[2020-12-24 10:59:58.608] [Router] [r2] [info] new echo request arrived from 10.0.2.2 to 10.1.0.2
64 bytes from 10.1.0.2: icmp_seq=2 ttl=64 time=0.215 ms

--- 10.1.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.158/0.186/0.215/0.031 ms
+ (( j++ ))
+ (( j &lt;= 4 ))
+ cleanup
+ set +e
+ del_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 10:59:58.616] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 11:00:00.462] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ del_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:00:02.345] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 11:00:03.924] [Router] [r2] [info] Destroying Router instance
+ delete_veth 4
++ seq 1 4
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-router/test/bridge/test2_2_5.sh" time="68.000000" status="Passed"><system-out>[2020-12-24 11:00:05.108] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:00:05.109] [polycubed] [info] configuration parameters: 
[2020-12-24 11:00:05.109] [polycubed] [info]  loglevel: info
[2020-12-24 11:00:05.109] [polycubed] [info]  daemon: false
[2020-12-24 11:00:05.109] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:00:05.109] [polycubed] [info]  port: 9000
[2020-12-24 11:00:05.109] [polycubed] [info]  addr: localhost
[2020-12-24 11:00:05.109] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:00:05.109] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:00:05.109] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:00:05.109] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:00:05.109] [polycubed] [info] polycubed starting...
[2020-12-24 11:00:05.109] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:00:07.330] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:00:07.331] [polycubed] [info] rest server starting ...
[2020-12-24 11:00:07.373] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:00:07.384] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:00:07.399] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:00:07.409] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:00:07.443] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:00:07.454] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:00:07.496] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:00:07.530] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:00:07.565] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:00:07.608] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:00:07.652] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:00:07.675] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:00:07.687] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:00:07.703] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:00:07.713] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:00:07.722] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:00:07.765] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:00:07.813] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:00:07.813] [polycubed] [info] loading metrics from yang files
+ create_veth_net 5
++ seq 1 5
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ for i in `seq 1 $1`
+ sudo ip netns add ns4
+ sudo ip link add veth4_ type veth peer name veth4
+ sudo ip link set veth4_ netns ns4
+ sudo ip netns exec ns4 ip link set dev veth4_ up
+ sudo ip link set dev veth4 up
+ sudo ip netns exec ns4 ifconfig veth4_ 10.0.4.1/24
+ sudo ip netns exec ns4 route add default gw 10.0.4.254 veth4_
+ for i in `seq 1 $1`
+ sudo ip netns add ns5
+ sudo ip link add veth5_ type veth peer name veth5
+ sudo ip link set veth5_ netns ns5
+ sudo ip netns exec ns5 ip link set dev veth5_ up
+ sudo ip link set dev veth5 up
+ sudo ip netns exec ns5 ifconfig veth5_ 10.0.5.1/24
+ sudo ip netns exec ns5 route add default gw 10.0.5.254 veth5_
+ set -e
+ add_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router add r1 loglevel=DEBUG
[2020-12-24 11:00:11.291] [Router] [r1] [info] Creating Router instance
+ for i in `seq 1 $1`
+ polycubectl router add r2 loglevel=DEBUG
[2020-12-24 11:00:12.970] [Router] [r2] [info] Creating Router instance
+ add_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br1
[2020-12-24 11:00:13.844] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 11:00:13.844] [Simplebridge] [br1] [info] Creating Fdb instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge add br2
[2020-12-24 11:00:14.699] [Simplebridge] [br2] [info] Creating Simplebridge instance
[2020-12-24 11:00:14.699] [Simplebridge] [br2] [info] Creating Fdb instance
+ router_add_port_as_gateway r1 br1 1 br1
+ polycubectl router r1 ports add to_br1 ip=10.0.1.254/24
[2020-12-24 11:00:14.705] [Router] [r1] [info] Added new port: to_br1 (index: 0) [mac: 52:6b:07:4e:47:ce - ip: 10.0.1.254/24]
[2020-12-24 11:00:14.705] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 11:00:14.705] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br1 ports add to_r1
+ polycubectl connect br1:to_r1 r1:to_br1
+ router_add_secondary r1 br1 10.0.2.254/24
+ polycubectl router r1 ports to_br1 secondaryip add 10.0.2.254/24
[2020-12-24 11:00:19.304] [Router] [r1] [info] Adding secondary address [port: to_br1 - ip: 10.0.2.254/24]
[2020-12-24 11:00:19.304] [Router] [r1] [debug] Adding secondary address [ip: 10.0.2.254/24]
[2020-12-24 11:00:19.304] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_br1]
[2020-12-24 11:00:19.304] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_br1]
+ connect_router_p_to_p r1 r2 1
+ polycubectl router r1 ports add to_r2 ip=10.1.0.1/30
[2020-12-24 11:00:19.309] [Router] [r1] [info] Added new port: to_r2 (index: 1) [mac: 2a:89:d8:f4:f6:b2 - ip: 10.1.0.1/30]
[2020-12-24 11:00:19.309] [Router] [r1] [info] Added route [network: 10.1.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 11:00:19.309] [Router] [r1] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports add to_r1 ip=10.1.0.2/30
[2020-12-24 11:00:19.315] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: 16:73:dd:52:9e:df - ip: 10.1.0.2/30]
[2020-12-24 11:00:19.315] [Router] [r2] [info] Added route [network: 10.1.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 11:00:19.315] [Router] [r2] [info] Added route [network: 10.1.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ router_add_secondary r1 r2 10.10.0.1/30
+ polycubectl router r1 ports to_r2 secondaryip add 10.10.0.1/30
[2020-12-24 11:00:25.485] [Router] [r1] [info] Adding secondary address [port: to_r2 - ip: 10.10.0.1/30]
[2020-12-24 11:00:25.485] [Router] [r1] [debug] Adding secondary address [ip: 10.10.0.1/30]
[2020-12-24 11:00:25.485] [Router] [r1] [info] Added route [network: 10.10.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 11:00:25.485] [Router] [r1] [info] Added route [network: 10.10.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ router_add_secondary r2 r1 10.10.0.2/30
+ polycubectl router r2 ports to_r1 secondaryip add 10.10.0.2/30
[2020-12-24 11:00:25.490] [Router] [r2] [info] Adding secondary address [port: to_r1 - ip: 10.10.0.2/30]
[2020-12-24 11:00:25.490] [Router] [r2] [debug] Adding secondary address [ip: 10.10.0.2/30]
[2020-12-24 11:00:25.490] [Router] [r2] [info] Added route [network: 10.10.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 11:00:25.490] [Router] [r2] [info] Added route [network: 10.10.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ bridge_add_port br1 veth1
+ polycubectl simplebridge br1 ports add veth1
+ polycubectl simplebridge br1 ports veth1 set peer=veth1
+ bridge_add_port br1 veth2
+ polycubectl simplebridge br1 ports add veth2
+ polycubectl simplebridge br1 ports veth2 set peer=veth2
+ router_add_port_as_gateway r2 br2 3 br2
+ polycubectl router r2 ports add to_br2 ip=10.0.3.254/24
[2020-12-24 11:00:27.501] [Router] [r2] [info] Added new port: to_br2 (index: 1) [mac: 3a:35:d4:b8:cf:dd - ip: 10.0.3.254/24]
[2020-12-24 11:00:27.501] [Router] [r2] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 11:00:27.501] [Router] [r2] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ [[ 4 -eq 4 ]]
+ polycubectl simplebridge br2 ports add to_r2
+ polycubectl connect br2:to_r2 r2:to_br2
+ router_add_secondary r2 br2 10.0.4.254/24
+ polycubectl router r2 ports to_br2 secondaryip add 10.0.4.254/24
[2020-12-24 11:00:32.105] [Router] [r2] [info] Adding secondary address [port: to_br2 - ip: 10.0.4.254/24]
[2020-12-24 11:00:32.105] [Router] [r2] [debug] Adding secondary address [ip: 10.0.4.254/24]
[2020-12-24 11:00:32.105] [Router] [r2] [info] Added route [network: 10.0.4.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 11:00:32.105] [Router] [r2] [info] Added route [network: 10.0.4.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ router_add_secondary r2 br2 10.0.5.254/24
+ polycubectl router r2 ports to_br2 secondaryip add 10.0.5.254/24
[2020-12-24 11:00:32.110] [Router] [r2] [info] Adding secondary address [port: to_br2 - ip: 10.0.5.254/24]
[2020-12-24 11:00:32.110] [Router] [r2] [debug] Adding secondary address [ip: 10.0.5.254/24]
[2020-12-24 11:00:32.110] [Router] [r2] [info] Added route [network: 10.0.5.254/32 - nexthop: 0.0.0.0 - interface: to_br2]
[2020-12-24 11:00:32.111] [Router] [r2] [info] Added route [network: 10.0.5.0/24 - nexthop: 0.0.0.0 - interface: to_br2]
+ bridge_add_port br2 veth3
+ polycubectl simplebridge br2 ports add veth3
+ polycubectl simplebridge br2 ports veth3 set peer=veth3
+ bridge_add_port br2 veth4
+ polycubectl simplebridge br2 ports add veth4
+ polycubectl simplebridge br2 ports veth4 set peer=veth4
+ bridge_add_port br2 veth5
+ polycubectl simplebridge br2 ports add veth5
+ polycubectl simplebridge br2 ports veth5 set peer=veth5
+ router_add_route r1 10.0.3.0/24 10.1.0.2 5
+ [[ 4 -eq 4 ]]
+ polycubectl router r1 route add 10.0.3.0/24 10.1.0.2 pathcost=5
[2020-12-24 11:00:35.163] [Router] [r1] [debug] Trying to add route [network: 10.0.3.0/24 - nexthop: 10.1.0.2]
[2020-12-24 11:00:35.163] [Router] [r1] [info] Creating Route instance
[2020-12-24 11:00:35.163] [Router] [r1] [debug] Adding route [network: 10.0.3.0/24 - nexthop: 10.1.0.2 - path cost: 5]
[2020-12-24 11:00:35.163] [Router] [r1] [info] Adding route [network: 10.0.3.0/24 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 5]
[2020-12-24 11:00:35.163] [Router] [r1] [debug] The new path cost '5' is better than the previous '2147483647'
+ router_add_route r1 10.0.4.0/24 10.1.0.2 5
+ [[ 4 -eq 4 ]]
+ polycubectl router r1 route add 10.0.4.0/24 10.1.0.2 pathcost=5
[2020-12-24 11:00:35.168] [Router] [r1] [debug] Trying to add route [network: 10.0.4.0/24 - nexthop: 10.1.0.2]
[2020-12-24 11:00:35.168] [Router] [r1] [info] Creating Route instance
[2020-12-24 11:00:35.168] [Router] [r1] [debug] Adding route [network: 10.0.4.0/24 - nexthop: 10.1.0.2 - path cost: 5]
[2020-12-24 11:00:35.168] [Router] [r1] [info] Adding route [network: 10.0.4.0/24 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 5]
[2020-12-24 11:00:35.168] [Router] [r1] [debug] The new path cost '5' is better than the previous '2147483647'
+ router_add_route r1 10.0.5.0/24 10.1.0.2 5
+ [[ 4 -eq 4 ]]
+ polycubectl router r1 route add 10.0.5.0/24 10.1.0.2 pathcost=5
[2020-12-24 11:00:35.173] [Router] [r1] [debug] Trying to add route [network: 10.0.5.0/24 - nexthop: 10.1.0.2]
[2020-12-24 11:00:35.173] [Router] [r1] [info] Creating Route instance
[2020-12-24 11:00:35.173] [Router] [r1] [debug] Adding route [network: 10.0.5.0/24 - nexthop: 10.1.0.2 - path cost: 5]
[2020-12-24 11:00:35.173] [Router] [r1] [info] Adding route [network: 10.0.5.0/24 - nexthop: 10.1.0.2 - interface: to_r2 - path cost: 5]
[2020-12-24 11:00:35.173] [Router] [r1] [debug] The new path cost '5' is better than the previous '2147483647'
+ router_add_route r2 10.0.1.0/24 10.1.0.1 5
+ [[ 4 -eq 4 ]]
+ polycubectl router r2 route add 10.0.1.0/24 10.1.0.1 pathcost=5
[2020-12-24 11:00:35.179] [Router] [r2] [debug] Trying to add route [network: 10.0.1.0/24 - nexthop: 10.1.0.1]
[2020-12-24 11:00:35.179] [Router] [r2] [info] Creating Route instance
[2020-12-24 11:00:35.179] [Router] [r2] [debug] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - path cost: 5]
[2020-12-24 11:00:35.179] [Router] [r2] [info] Adding route [network: 10.0.1.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 5]
[2020-12-24 11:00:35.179] [Router] [r2] [debug] The new path cost '5' is better than the previous '2147483647'
+ router_add_route r2 10.0.2.0/24 10.1.0.1 5
+ [[ 4 -eq 4 ]]
+ polycubectl router r2 route add 10.0.2.0/24 10.1.0.1 pathcost=5
[2020-12-24 11:00:35.184] [Router] [r2] [debug] Trying to add route [network: 10.0.2.0/24 - nexthop: 10.1.0.1]
[2020-12-24 11:00:35.184] [Router] [r2] [info] Creating Route instance
[2020-12-24 11:00:35.184] [Router] [r2] [debug] Adding route [network: 10.0.2.0/24 - nexthop: 10.1.0.1 - path cost: 5]
[2020-12-24 11:00:35.184] [Router] [r2] [info] Adding route [network: 10.0.2.0/24 - nexthop: 10.1.0.1 - interface: to_r1 - path cost: 5]
[2020-12-24 11:00:35.184] [Router] [r2] [debug] The new path cost '5' is better than the previous '2147483647'
+ router_add_route r1 10.0.3.0/24 10.10.0.2 2
+ [[ 4 -eq 4 ]]
+ polycubectl router r1 route add 10.0.3.0/24 10.10.0.2 pathcost=2
[2020-12-24 11:00:35.189] [Router] [r1] [debug] Trying to add route [network: 10.0.3.0/24 - nexthop: 10.10.0.2]
[2020-12-24 11:00:35.189] [Router] [r1] [info] Creating Route instance
[2020-12-24 11:00:35.189] [Router] [r1] [debug] Adding route [network: 10.0.3.0/24 - nexthop: 10.10.0.2 - path cost: 2]
[2020-12-24 11:00:35.189] [Router] [r1] [info] Adding route [network: 10.0.3.0/24 - nexthop: 10.10.0.2 - interface: to_r2 - path cost: 2]
[2020-12-24 11:00:35.189] [Router] [r1] [debug] The new path cost '2' is better than the previous '5'
+ ping_cycle 5
++ seq 1 5
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 11:00:35.237] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 11:00:35.237] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:35.237] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:35.237] [Router] [r1] [debug] sending ARP request on port to_br1 'who has 10.0.2.1 tell MAC to 10.0.1.254
[2020-12-24 11:00:35.237] [Router] [r1] [debug] packet is arp reply
[2020-12-24 11:00:35.237] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:35.237] [Router] [r1] [info] ARP reply '10.0.2.1 is at 4e:30:b3:3c:f2:2d'
[2020-12-24 11:00:35.237] [Router] [r1] [debug] somebody is asking for my address
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.677 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.061 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 523ms
rtt min/avg/max/mdev = 0.061/0.369/0.677/0.308 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
[2020-12-24 11:00:35.769] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:35.769] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:35.769] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.2 tell MAC to 10.1.0.1
[2020-12-24 11:00:35.769] [Router] [r2] [debug] somebody is asking for my address
[2020-12-24 11:00:35.769] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:35.769] [Router] [r1] [debug] packet is arp reply
[2020-12-24 11:00:35.769] [Router] [r1] [info] ARP reply '10.10.0.2 is at 16:73:dd:52:9e:df'
[2020-12-24 11:00:35.769] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:35.769] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:35.769] [Router] [r2] [debug] sending ARP request on port to_br2 'who has 10.0.3.1 tell MAC to 10.0.3.254
[2020-12-24 11:00:35.770] [Router] [r2] [debug] packet is arp reply
[2020-12-24 11:00:35.770] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:35.770] [Router] [r2] [info] ARP reply '10.0.3.1 is at 1e:33:da:dc:02:64'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.552 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.066 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.066/0.309/0.552/0.243 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.4.1 -c 2 -i 0.5
[2020-12-24 11:00:36.281] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:36.281] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:36.281] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.1.0.2 tell MAC to 10.1.0.1
[2020-12-24 11:00:36.281] [Router] [r2] [debug] somebody is asking for my address
[2020-12-24 11:00:36.281] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:36.281] [Router] [r1] [debug] packet is arp reply
[2020-12-24 11:00:36.281] [Router] [r1] [info] ARP reply '10.1.0.2 is at 16:73:dd:52:9e:df'
[2020-12-24 11:00:36.281] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:36.281] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:36.281] [Router] [r2] [debug] sending ARP request on port to_br2 'who has 10.0.4.1 tell MAC to 10.0.3.254
[2020-12-24 11:00:36.281] [Router] [r2] [debug] packet is arp reply
[2020-12-24 11:00:36.281] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:36.282] [Router] [r2] [info] ARP reply '10.0.4.1 is at e6:1b:b3:0d:1d:60'
[2020-12-24 11:00:36.282] [Router] [r2] [debug] somebody is asking for my address
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=62 time=0.570 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.062/0.316/0.570/0.254 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 5 ']'
+ sudo ip netns exec ns1 ping 10.0.5.1 -c 2 -i 0.5
[2020-12-24 11:00:36.793] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:36.793] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:36.793] [Router] [r2] [debug] sending ARP request on port to_br2 'who has 10.0.5.1 tell MAC to 10.0.3.254
[2020-12-24 11:00:36.793] [Router] [r2] [debug] packet is arp reply
[2020-12-24 11:00:36.793] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:36.793] [Router] [r2] [info] ARP reply '10.0.5.1 is at 72:f9:49:79:7c:d9'
[2020-12-24 11:00:36.793] [Router] [r2] [debug] somebody is asking for my address
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=62 time=0.438 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.062/0.250/0.438/0.188 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.030 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.051 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.030/0.040/0.051/0.012 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.038 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.049 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.038/0.043/0.049/0.008 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=62 time=0.037 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=62 time=0.053 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.037/0.045/0.053/0.008 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 5 ']'
+ sudo ip netns exec ns2 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=62 time=0.039 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.039/0.050/0.062/0.013 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.038 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.063 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.038/0.050/0.063/0.014 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.037 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.037/0.050/0.064/0.015 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.028 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.028/0.041/0.054/0.013 ms
[2020-12-24 11:00:40.880] [Router] [r2] [debug] somebody is asking for my address
+ for j in `seq 1 $1`
+ '[' 3 -ne 5 ']'
+ sudo ip netns exec ns3 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.031 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.059 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.031/0.045/0.059/0.014 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.036 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.065 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.036/0.050/0.065/0.016 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.038 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.038/0.050/0.062/0.012 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.033 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.033/0.045/0.058/0.014 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ for j in `seq 1 $1`
+ '[' 4 -ne 5 ']'
+ sudo ip netns exec ns4 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.030 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.060 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.030/0.045/0.060/0.015 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 5 -ne 1 ']'
+ sudo ip netns exec ns5 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.039 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.039/0.051/0.064/0.014 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 2 ']'
+ sudo ip netns exec ns5 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.032 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.058 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.045/0.058/0.013 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 3 ']'
+ sudo ip netns exec ns5 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.033 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.066 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.033/0.049/0.066/0.017 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 4 ']'
+ sudo ip netns exec ns5 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.032 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.065 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.032/0.048/0.065/0.017 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 5 ']'
+ ping_special 5 10.10.0.1 10.10.0.2
++ seq 1 5
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns1 ping 10.10.0.1 -c 2 -i 0.5
[2020-12-24 11:00:45.544] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:45.544] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: icmp_seq=1 ttl=64 time=0.209 ms
[2020-12-24 11:00:46.064] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:46.064] [Router] [r1] [info] new echo request arrived from 10.0.1.1 to 10.10.0.1
64 bytes from 10.10.0.1: icmp_seq=2 ttl=64 time=0.320 ms

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 520ms
rtt min/avg/max/mdev = 0.209/0.264/0.320/0.057 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns1 ping 10.10.0.2 -c 2 -i 0.5
[2020-12-24 11:00:46.074] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:46.074] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.10.0.2
PING 10.10.0.2 (10.10.0.2) 56(84) bytes of data.
64 bytes from 10.10.0.2: icmp_seq=1 ttl=63 time=0.244 ms
[2020-12-24 11:00:46.576] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:46.577] [Router] [r2] [info] new echo request arrived from 10.0.1.1 to 10.10.0.2
64 bytes from 10.10.0.2: icmp_seq=2 ttl=63 time=0.313 ms

--- 10.10.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.244/0.278/0.313/0.038 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns2 ping 10.10.0.1 -c 2 -i 0.5
[2020-12-24 11:00:46.586] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:46.586] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: icmp_seq=1 ttl=64 time=0.230 ms
[2020-12-24 11:00:47.088] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:00:47.088] [Router] [r1] [info] new echo request arrived from 10.0.2.1 to 10.10.0.1
64 bytes from 10.10.0.1: icmp_seq=2 ttl=64 time=0.426 ms

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.230/0.328/0.426/0.098 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns2 ping 10.10.0.2 -c 2 -i 0.5
[2020-12-24 11:00:47.097] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:47.097] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.10.0.2
PING 10.10.0.2 (10.10.0.2) 56(84) bytes of data.
64 bytes from 10.10.0.2: icmp_seq=1 ttl=63 time=0.162 ms
[2020-12-24 11:00:47.600] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:47.600] [Router] [r2] [info] new echo request arrived from 10.0.2.1 to 10.10.0.2
64 bytes from 10.10.0.2: icmp_seq=2 ttl=63 time=0.315 ms

--- 10.10.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.162/0.238/0.315/0.078 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns3 ping 10.10.0.1 -c 2 -i 0.5
[2020-12-24 11:00:47.609] [Router] [r2] [debug] arp lookup failed. Send to controller
[2020-12-24 11:00:47.609] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:47.609] [Router] [r2] [debug] sending ARP request on port to_r1 'who has 10.10.0.1 tell MAC to 10.1.0.2
[2020-12-24 11:00:47.609] [Router] [r1] [debug] somebody is asking for my address
[2020-12-24 11:00:47.609] [Router] [r2] [debug] packet is arp reply
[2020-12-24 11:00:47.609] [Router] [r2] [debug] Packet received from port to_r1
[2020-12-24 11:00:47.609] [Router] [r2] [info] ARP reply '10.10.0.1 is at 2a:89:d8:f4:f6:b2'
[2020-12-24 11:00:47.609] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:47.609] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: icmp_seq=1 ttl=63 time=0.368 ms
[2020-12-24 11:00:48.112] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:48.112] [Router] [r1] [info] new echo request arrived from 10.0.3.1 to 10.10.0.1
64 bytes from 10.10.0.1: icmp_seq=2 ttl=63 time=0.303 ms

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.303/0.335/0.368/0.037 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns3 ping 10.10.0.2 -c 2 -i 0.5
[2020-12-24 11:00:48.121] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:48.121] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.0.2
PING 10.10.0.2 (10.10.0.2) 56(84) bytes of data.
64 bytes from 10.10.0.2: icmp_seq=1 ttl=64 time=0.184 ms
[2020-12-24 11:00:48.624] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:48.624] [Router] [r2] [info] new echo request arrived from 10.0.3.1 to 10.10.0.2
64 bytes from 10.10.0.2: icmp_seq=2 ttl=64 time=0.237 ms

--- 10.10.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.184/0.210/0.237/0.030 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns4 ping 10.10.0.1 -c 2 -i 0.5
[2020-12-24 11:00:48.633] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:48.633] [Router] [r1] [info] new echo request arrived from 10.0.4.1 to 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: icmp_seq=1 ttl=63 time=0.197 ms
[2020-12-24 11:00:49.136] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:49.136] [Router] [r1] [info] new echo request arrived from 10.0.4.1 to 10.10.0.1
64 bytes from 10.10.0.1: icmp_seq=2 ttl=63 time=0.311 ms

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.197/0.254/0.311/0.057 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns4 ping 10.10.0.2 -c 2 -i 0.5
[2020-12-24 11:00:49.145] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:49.145] [Router] [r2] [info] new echo request arrived from 10.0.4.1 to 10.10.0.2
PING 10.10.0.2 (10.10.0.2) 56(84) bytes of data.
64 bytes from 10.10.0.2: icmp_seq=1 ttl=64 time=0.171 ms
[2020-12-24 11:00:49.648] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:49.649] [Router] [r2] [info] new echo request arrived from 10.0.4.1 to 10.10.0.2
64 bytes from 10.10.0.2: icmp_seq=2 ttl=64 time=0.313 ms

--- 10.10.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.171/0.242/0.313/0.071 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns5 ping 10.10.0.1 -c 2 -i 0.5
[2020-12-24 11:00:49.658] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:49.658] [Router] [r1] [info] new echo request arrived from 10.0.5.1 to 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: icmp_seq=1 ttl=63 time=0.258 ms
[2020-12-24 11:00:50.160] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:00:50.160] [Router] [r1] [info] new echo request arrived from 10.0.5.1 to 10.10.0.1
64 bytes from 10.10.0.1: icmp_seq=2 ttl=63 time=0.319 ms

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.258/0.288/0.319/0.034 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ sudo ip netns exec ns5 ping 10.10.0.2 -c 2 -i 0.5
[2020-12-24 11:00:50.170] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:50.170] [Router] [r2] [info] new echo request arrived from 10.0.5.1 to 10.10.0.2
PING 10.10.0.2 (10.10.0.2) 56(84) bytes of data.
64 bytes from 10.10.0.2: icmp_seq=1 ttl=64 time=0.301 ms
[2020-12-24 11:00:50.672] [Router] [r2] [debug] Packet received from port to_br2
[2020-12-24 11:00:50.672] [Router] [r2] [info] new echo request arrived from 10.0.5.1 to 10.10.0.2
64 bytes from 10.10.0.2: icmp_seq=2 ttl=64 time=0.295 ms

--- 10.10.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.295/0.298/0.301/0.003 ms
+ (( j++ ))
+ (( j &lt;= 3 ))
+ polycubectl router r1 ports to_r2 secondaryip del 10.10.0.1/30
[2020-12-24 11:00:50.679] [Router] [r1] [debug] Getting secondary ip [port: to_r2 - ip: 10.10.0.1/30]
[2020-12-24 11:00:50.679] [Router] [r1] [debug] Removing routes involving the port to_r2 and the network 10.10.0.0
[2020-12-24 11:00:50.680] [Router] [r1] [debug] Removed local route from the control plane [network: 10.10.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 11:00:50.680] [Router] [r1] [debug] Route not found in the data path
[2020-12-24 11:00:50.680] [Router] [r1] [debug] Looking for other routes involving the port to be removed
[2020-12-24 11:00:50.680] [Router] [r1] [debug] Removed local route from the control plane [network: 10.0.3.0/24 - nexthop: 10.10.0.2 - interface: to_r2]
[2020-12-24 11:00:50.680] [Router] [r1] [debug] Route not found in the data path
+ ping_cycle 5
++ seq 1 5
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.032 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 526ms
rtt min/avg/max/mdev = 0.032/0.044/0.056/0.012 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.038 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.070 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.038/0.054/0.070/0.016 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 4 ']'
+ sudo ip netns exec ns1 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=62 time=0.039 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=62 time=0.065 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.039/0.052/0.065/0.013 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 5 ']'
+ sudo ip netns exec ns1 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=62 time=0.043 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=62 time=0.063 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.043/0.053/0.063/0.010 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.072 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.060 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.060/0.066/0.072/0.006 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=62 time=0.041 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=62 time=0.067 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.041/0.054/0.067/0.013 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 4 ']'
+ sudo ip netns exec ns2 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=62 time=0.036 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=62 time=0.068 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.036/0.052/0.068/0.016 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 5 ']'
+ sudo ip netns exec ns2 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=62 time=0.037 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.037/0.049/0.062/0.014 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.035 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.066 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.035/0.050/0.066/0.017 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.045 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.068 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.045/0.056/0.068/0.013 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ for j in `seq 1 $1`
+ '[' 3 -ne 4 ']'
+ sudo ip netns exec ns3 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.041 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.059 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 530ms
rtt min/avg/max/mdev = 0.041/0.050/0.059/0.009 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 5 ']'
+ sudo ip netns exec ns3 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.041 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.062 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.041/0.051/0.062/0.012 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 4 -ne 1 ']'
+ sudo ip netns exec ns4 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.043 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.066 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 531ms
rtt min/avg/max/mdev = 0.043/0.054/0.066/0.013 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 2 ']'
+ sudo ip netns exec ns4 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.039 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.064 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.039/0.051/0.064/0.014 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 3 ']'
+ sudo ip netns exec ns4 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.038 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.069 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.038/0.053/0.069/0.017 ms
+ for j in `seq 1 $1`
+ '[' 4 -ne 4 ']'
+ for j in `seq 1 $1`
+ '[' 4 -ne 5 ']'
+ sudo ip netns exec ns4 ping 10.0.5.1 -c 2 -i 0.5
PING 10.0.5.1 (10.0.5.1) 56(84) bytes of data.
64 bytes from 10.0.5.1: icmp_seq=1 ttl=63 time=0.038 ms
64 bytes from 10.0.5.1: icmp_seq=2 ttl=63 time=0.057 ms

--- 10.0.5.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.038/0.047/0.057/0.011 ms
+ for i in `seq 1 $1`
++ seq 1 5
+ for j in `seq 1 $1`
+ '[' 5 -ne 1 ']'
+ sudo ip netns exec ns5 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=62 time=0.036 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=62 time=0.062 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.036/0.049/0.062/0.013 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 2 ']'
+ sudo ip netns exec ns5 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=62 time=0.042 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=62 time=0.061 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.042/0.051/0.061/0.011 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 3 ']'
+ sudo ip netns exec ns5 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.037 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.062 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.037/0.049/0.062/0.014 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 4 ']'
+ sudo ip netns exec ns5 ping 10.0.4.1 -c 2 -i 0.5
PING 10.0.4.1 (10.0.4.1) 56(84) bytes of data.
64 bytes from 10.0.4.1: icmp_seq=1 ttl=63 time=0.032 ms
64 bytes from 10.0.4.1: icmp_seq=2 ttl=63 time=0.059 ms

--- 10.0.4.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.032/0.045/0.059/0.015 ms
+ for j in `seq 1 $1`
+ '[' 5 -ne 5 ']'
+ ping_special_fail 5 10.10.0.1
++ seq 1 5
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 2 ))
+ test_fail sudo ip netns exec ns1 ping 10.10.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns1 ping 10.10.0.1 -c 2 -i 0.5 -w 1
[2020-12-24 11:01:01.051] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:01:01.051] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:01.051] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
[2020-12-24 11:01:01.552] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:01.552] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:01:01.552] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
+ res='PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 501ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ (( j++ ))
+ (( j &lt;= 2 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 2 ))
+ test_fail sudo ip netns exec ns2 ping 10.10.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns2 ping 10.10.0.1 -c 2 -i 0.5 -w 1
[2020-12-24 11:01:02.060] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:01:02.060] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:02.060] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
[2020-12-24 11:01:02.576] [Router] [r1] [debug] Packet received from port to_br1
[2020-12-24 11:01:02.576] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:02.577] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
+ res='PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 516ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ (( j++ ))
+ (( j &lt;= 2 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 2 ))
+ test_fail sudo ip netns exec ns3 ping 10.10.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns3 ping 10.10.0.1 -c 2 -i 0.5 -w 1
[2020-12-24 11:01:03.069] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:03.069] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:03.069] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
[2020-12-24 11:01:03.600] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:03.600] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:03.601] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
+ res='PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 531ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ (( j++ ))
+ (( j &lt;= 2 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 2 ))
+ test_fail sudo ip netns exec ns4 ping 10.10.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns4 ping 10.10.0.1 -c 2 -i 0.5 -w 1
[2020-12-24 11:01:04.078] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:04.078] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:04.078] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
[2020-12-24 11:01:04.592] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:04.592] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:04.592] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
+ res='PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 514ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ (( j++ ))
+ (( j &lt;= 2 ))
+ for i in `seq 1 $1`
+ (( j = 2 ))
+ (( j &lt;= 2 ))
+ test_fail sudo ip netns exec ns5 ping 10.10.0.1 -c 2 -i 0.5 -w 1
+ set +e
++ sudo ip netns exec ns5 ping 10.10.0.1 -c 2 -i 0.5 -w 1
[2020-12-24 11:01:05.088] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:05.088] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:05.088] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
[2020-12-24 11:01:05.616] [Router] [r1] [debug] arp lookup failed. Send to controller
[2020-12-24 11:01:05.616] [Router] [r1] [debug] Packet received from port to_r2
[2020-12-24 11:01:05.616] [Router] [r1] [debug] sending ARP request on port to_r2 'who has 10.10.0.1 tell MAC to 10.1.0.1
+ res='PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.

--- 10.10.0.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 528ms'
+ local status=1
+ set -e
+ '[' 1 -ne 0 ']'
+ return 0
+ (( j++ ))
+ (( j &lt;= 2 ))
+ cleanup
+ set +e
+ del_bridges 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br1
[2020-12-24 11:01:06.096] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ for i in `seq 1 $1`
+ polycubectl simplebridge del br2
[2020-12-24 11:01:08.460] [Simplebridge] [br2] [info] Destroying Simplebridge instance
+ del_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:01:10.337] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 11:01:11.901] [Router] [r2] [info] Destroying Router instance
+ delete_veth 5
++ seq 1 5
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
+ for i in `seq 1 $1`
+ sudo ip link del veth4
+ sudo ip netns del ns4
+ for i in `seq 1 $1`
+ sudo ip link del veth5
+ sudo ip netns del ns5
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test_shadow/test1.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 11:01:13.194] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:01:13.195] [polycubed] [info] configuration parameters: 
[2020-12-24 11:01:13.195] [polycubed] [info]  loglevel: info
[2020-12-24 11:01:13.195] [polycubed] [info]  daemon: false
[2020-12-24 11:01:13.195] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:01:13.195] [polycubed] [info]  port: 9000
[2020-12-24 11:01:13.195] [polycubed] [info]  addr: localhost
[2020-12-24 11:01:13.195] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:01:13.195] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:01:13.195] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:01:13.195] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:01:13.195] [polycubed] [info] polycubed starting...
[2020-12-24 11:01:13.195] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:01:15.407] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:01:15.408] [polycubed] [info] rest server starting ...
[2020-12-24 11:01:15.453] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:01:15.464] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:01:15.479] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:01:15.489] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:01:15.522] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:01:15.533] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:01:15.575] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:01:15.608] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:01:15.643] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:01:15.686] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:01:15.730] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:01:15.753] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:01:15.764] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:01:15.780] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:01:15.789] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:01:15.799] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:01:15.841] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:01:15.889] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:01:15.889] [polycubed] [info] loading metrics from yang files
+ set -e
+ polycubectl router add r1 shadow=true
[2020-12-24 11:01:18.950] [Router] [r1] [info] Creating Router instance
+ sudo ip netns ls
pcn-r1 (id: 1)
+ router_add_port r1 p1 10.0.0.1/24
+ polycubectl router r1 ports add p1 ip=10.0.0.1/24
[2020-12-24 11:01:19.204] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:19.856] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:20.779] [Router] [r1] [info] Added new port: p1 (index: 0) [mac: 12:0e:4c:6d:68:59 - ip: 10.0.0.1/24]
[2020-12-24 11:01:20.779] [Router] [r1] [info] Added route [network: 10.0.0.1/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:01:20.779] [Router] [r1] [info] Added route [network: 10.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ sudo ip netns exec pcn-r1 ip -c a
1: [36mlo[0m: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state [31mDOWN [0mgroup default qlen 1000
    link/loopback [33m00:00:00:00:00:00[0m brd [33m00:00:00:00:00:00[0m
897: [36mp1[0m@if896: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state [32mUP [0mgroup default qlen 1000
    link/ether [33m12:0e:4c:6d:68:59[0m brd [33mff:ff:ff:ff:ff:ff[0m link-netnsid 0
    inet [35m10.0.0.1[0m/24 scope global p1
       valid_lft forever preferred_lft forever
    inet6 [34mfe80::9454:4ff:feda:f73f[0m/64 scope link tentative 
       valid_lft forever preferred_lft forever
+ sudo ip netns exec pcn-r1 ifconfig p1 10.0.0.2/24
[2020-12-24 11:01:20.794] [Router] [r1] [info] Added route [network: 10.0.0.2/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:01:20.794] [Router] [r1] [info] Added route [network: 10.0.0.0/8 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:01:20.795] [Router] [r1] [info] Added route [network: 10.0.0.2/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:01:20.795] [Router] [r1] [info] Added route [network: 10.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 ports p1 show
name: p1
uuid: 044572a7-6e67-4b38-b43f-265df44b5520
status: DOWN
peer: 
ip: 10.0.0.2/24
mac: 12:0e:4c:6d:68:59

+ sudo ip netns exec pcn-r1 ip route add 30.0.0.0/24 dev p1
[2020-12-24 11:01:20.808] [Router] [r1] [info] Added Linux route [network: 30.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 route show
Size of the terminal is too small, output could be missaligned.interface  network      nexthop  pathcost
p1         10.0.0.0/24  local    0
p1         30.0.0.0/24  0.0.0.0  1

+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:01:20.819] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test_shadow/test2.sh" time="20.000000" status="Passed"><system-out>[2020-12-24 11:01:22.928] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:01:22.928] [polycubed] [info] configuration parameters: 
[2020-12-24 11:01:22.928] [polycubed] [info]  loglevel: info
[2020-12-24 11:01:22.928] [polycubed] [info]  daemon: false
[2020-12-24 11:01:22.928] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:01:22.928] [polycubed] [info]  port: 9000
[2020-12-24 11:01:22.928] [polycubed] [info]  addr: localhost
[2020-12-24 11:01:22.928] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:01:22.928] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:01:22.929] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:01:22.929] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:01:22.929] [polycubed] [info] polycubed starting...
[2020-12-24 11:01:22.929] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:01:25.149] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:01:25.149] [polycubed] [info] rest server starting ...
[2020-12-24 11:01:25.193] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:01:25.204] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:01:25.219] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:01:25.229] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:01:25.264] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:01:25.274] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:01:25.318] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:01:25.353] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:01:25.389] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:01:25.434] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:01:25.480] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:01:25.503] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:01:25.515] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:01:25.531] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:01:25.540] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:01:25.550] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:01:25.594] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:01:25.644] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:01:25.644] [polycubed] [info] loading metrics from yang files
+ set -e
+ polycubectl router add r1 shadow=true
[2020-12-24 11:01:28.662] [Router] [r1] [info] Creating Router instance
+ polycubectl router add r2
[2020-12-24 11:01:30.345] [Router] [r2] [info] Creating Router instance
+ connect_router_p_to_p r1 r2 0
+ polycubectl router r1 ports add to_r2 ip=10.0.0.1/30
[2020-12-24 11:01:30.960] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:31.984] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:31.984] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:32.156] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:32.194] [Router] [r1] [info] Added new port: to_r2 (index: 0) [mac: 3e:70:ab:9d:55:8d - ip: 10.0.0.1/30]
[2020-12-24 11:01:32.194] [Router] [r1] [info] Added route [network: 10.0.0.1/32 - nexthop: 0.0.0.0 - interface: to_r2]
[2020-12-24 11:01:32.194] [Router] [r1] [info] Added route [network: 10.0.0.0/30 - nexthop: 0.0.0.0 - interface: to_r2]
+ polycubectl router r2 ports add to_r1 ip=10.0.0.2/30
[2020-12-24 11:01:32.200] [Router] [r2] [info] Added new port: to_r1 (index: 0) [mac: fe:5a:e5:67:ac:16 - ip: 10.0.0.2/30]
[2020-12-24 11:01:32.200] [Router] [r2] [info] Added route [network: 10.0.0.2/32 - nexthop: 0.0.0.0 - interface: to_r1]
[2020-12-24 11:01:32.200] [Router] [r2] [info] Added route [network: 10.0.0.0/30 - nexthop: 0.0.0.0 - interface: to_r1]
+ polycubectl connect r1:to_r2 r2:to_r1
+ sudo ip netns exec pcn-r1 ping 10.0.0.2 -c 3 -i 0.5
[2020-12-24 11:01:38.403] [Router] [r1] [info] ARP reply '10.0.0.2 is at fe:5a:e5:67:ac:16'
[2020-12-24 11:01:38.403] [Router] [r2] [info] new echo request arrived from 10.0.0.1 to 10.0.0.2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.403 ms
[2020-12-24 11:01:38.928] [Router] [r2] [info] new echo request arrived from 10.0.0.1 to 10.0.0.2
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.295 ms
[2020-12-24 11:01:39.440] [Router] [r2] [info] new echo request arrived from 10.0.0.1 to 10.0.0.2
64 bytes from 10.0.0.2: icmp_seq=3 ttl=64 time=0.248 ms

--- 10.0.0.2 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 1037ms
rtt min/avg/max/mdev = 0.248/0.315/0.403/0.066 ms
+ cleanup
+ set +e
+ del_routers 2
++ seq 1 2
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:01:39.449] [Router] [r1] [info] Destroying Router instance
+ for i in `seq 1 $1`
+ polycubectl router del r2
[2020-12-24 11:01:41.014] [Router] [r2] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test_shadow/test3.sh" time="41.000000" status="Passed"><system-out>[2020-12-24 11:01:42.070] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:01:42.071] [polycubed] [info] configuration parameters: 
[2020-12-24 11:01:42.071] [polycubed] [info]  loglevel: info
[2020-12-24 11:01:42.071] [polycubed] [info]  daemon: false
[2020-12-24 11:01:42.071] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:01:42.071] [polycubed] [info]  port: 9000
[2020-12-24 11:01:42.071] [polycubed] [info]  addr: localhost
[2020-12-24 11:01:42.071] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:01:42.071] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:01:42.071] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:01:42.071] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:01:42.071] [polycubed] [info] polycubed starting...
[2020-12-24 11:01:42.071] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:01:44.278] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:01:44.278] [polycubed] [info] rest server starting ...
[2020-12-24 11:01:44.325] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:01:44.336] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:01:44.351] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:01:44.361] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:01:44.396] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:01:44.407] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:01:44.451] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:01:44.485] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:01:44.521] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:01:44.566] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:01:44.612] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:01:44.635] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:01:44.647] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:01:44.662] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:01:44.672] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:01:44.681] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:01:44.725] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:01:44.774] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:01:44.774] [polycubed] [info] loading metrics from yang files
+ create_veth_net 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.1.1/24
+ sudo ip netns exec ns1 route add default gw 10.0.1.254 veth1_
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.2.1/24
+ sudo ip netns exec ns2 route add default gw 10.0.2.254 veth2_
+ for i in `seq 1 $1`
+ sudo ip netns add ns3
+ sudo ip link add veth3_ type veth peer name veth3
+ sudo ip link set veth3_ netns ns3
+ sudo ip netns exec ns3 ip link set dev veth3_ up
+ sudo ip link set dev veth3 up
+ sudo ip netns exec ns3 ifconfig veth3_ 10.0.3.1/24
+ sudo ip netns exec ns3 route add default gw 10.0.3.254 veth3_
+ set -e
+ polycubectl router add r1 shadow=true
[2020-12-24 11:01:48.061] [Router] [r1] [info] Creating Router instance
+ router_add_port_as_gateway r1 veth1 1
+ polycubectl router r1 ports add to_veth1 ip=10.0.1.254/24
[2020-12-24 11:01:48.336] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:49.360] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:49.360] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:49.712] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:01:49.893] [Router] [r1] [info] Added new port: to_veth1 (index: 0) [mac: 6e:58:6d:ab:45:5c - ip: 10.0.1.254/24]
[2020-12-24 11:01:49.893] [Router] [r1] [info] Added route [network: 10.0.1.254/32 - nexthop: 0.0.0.0 - interface: to_veth1]
[2020-12-24 11:01:49.893] [Router] [r1] [info] Added route [network: 10.0.1.0/24 - nexthop: 0.0.0.0 - interface: to_veth1]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth1 set peer=veth1'\'''
Executing the command 'polycubectl router r1 ports to_veth1 set peer=veth1'
+ polycubectl router r1 ports to_veth1 set peer=veth1
+ router_add_port_as_gateway r1 veth2 2
+ polycubectl router r1 ports add to_veth2 ip=10.0.2.254/24
[2020-12-24 11:01:53.401] [Router] [r1] [info] Added new port: to_veth2 (index: 2) [mac: 86:87:8e:dc:a8:b5 - ip: 10.0.2.254/24]
[2020-12-24 11:01:53.401] [Router] [r1] [info] Added route [network: 10.0.2.254/32 - nexthop: 0.0.0.0 - interface: to_veth2]
[2020-12-24 11:01:53.401] [Router] [r1] [info] Added route [network: 10.0.2.0/24 - nexthop: 0.0.0.0 - interface: to_veth2]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth2 set peer=veth2'\'''
Executing the command 'polycubectl router r1 ports to_veth2 set peer=veth2'
+ polycubectl router r1 ports to_veth2 set peer=veth2
+ router_add_port_as_gateway r1 veth3 3
+ polycubectl router r1 ports add to_veth3 ip=10.0.3.254/24
[2020-12-24 11:01:57.029] [Router] [r1] [info] Added new port: to_veth3 (index: 4) [mac: 8e:1e:a4:a6:45:fc - ip: 10.0.3.254/24]
[2020-12-24 11:01:57.029] [Router] [r1] [info] Added route [network: 10.0.3.254/32 - nexthop: 0.0.0.0 - interface: to_veth3]
[2020-12-24 11:01:57.029] [Router] [r1] [info] Added route [network: 10.0.3.0/24 - nexthop: 0.0.0.0 - interface: to_veth3]
+ [[ 3 -eq 4 ]]
+ echo 'Executing the command '\''polycubectl router r1 ports to_veth3 set peer=veth3'\'''
Executing the command 'polycubectl router r1 ports to_veth3 set peer=veth3'
+ polycubectl router r1 ports to_veth3 set peer=veth3
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
[2020-12-24 11:01:58.839] [Router] [r1] [info] ARP reply '10.0.2.1 is at be:44:2a:9c:3e:63'
[2020-12-24 11:01:58.839] [Router] [r1] [info] ARP reply '10.0.1.1 is at a6:66:7d:2d:a9:71'
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=64 time=0.473 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.060 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 505ms
rtt min/avg/max/mdev = 0.060/0.266/0.473/0.207 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
[2020-12-24 11:01:59.353] [Router] [r1] [info] ARP reply '10.0.3.1 is at ce:25:f8:7e:0f:aa'
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.284 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.058 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.058/0.171/0.284/0.113 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.030 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.056 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.030/0.043/0.056/0.013 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.030 ms
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.030/0.042/0.054/0.012 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.053 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.029/0.041/0.053/0.012 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.029 ms
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.054 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.029/0.041/0.054/0.014 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ polycubectl router r1 set span=true
+ echo 'enable Wireshark or Tcpdump'
enable Wireshark or Tcpdump
+ sleep 15
+ ping_cycle 3
++ seq 1 3
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 1 -ne 1 ']'
+ for j in `seq 1 $1`
+ '[' 1 -ne 2 ']'
+ sudo ip netns exec ns1 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.072 ms
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.198 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.247 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.275 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.091 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 520ms
rtt min/avg/max/mdev = 0.072/0.176/0.275/0.082 ms
+ for j in `seq 1 $1`
+ '[' 1 -ne 3 ']'
+ sudo ip netns exec ns1 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.056 ms
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.115 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.148 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.173 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.092 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.056/0.116/0.173/0.043 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 2 -ne 1 ']'
+ sudo ip netns exec ns2 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.060 ms
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.178 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.218 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.243 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.093 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.060/0.158/0.243/0.071 ms
+ for j in `seq 1 $1`
+ '[' 2 -ne 2 ']'
+ for j in `seq 1 $1`
+ '[' 2 -ne 3 ']'
+ sudo ip netns exec ns2 ping 10.0.3.1 -c 2 -i 0.5
PING 10.0.3.1 (10.0.3.1) 56(84) bytes of data.
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.061 ms
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.194 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.236 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=1 ttl=63 time=0.262 ms (DUP!)
64 bytes from 10.0.3.1: icmp_seq=2 ttl=63 time=0.086 ms

--- 10.0.3.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 502ms
rtt min/avg/max/mdev = 0.061/0.167/0.262/0.082 ms
+ for i in `seq 1 $1`
++ seq 1 3
+ for j in `seq 1 $1`
+ '[' 3 -ne 1 ']'
+ sudo ip netns exec ns3 ping 10.0.1.1 -c 2 -i 0.5
PING 10.0.1.1 (10.0.1.1) 56(84) bytes of data.
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.066 ms
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.190 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.233 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=1 ttl=63 time=0.258 ms (DUP!)
64 bytes from 10.0.1.1: icmp_seq=2 ttl=63 time=0.083 ms

--- 10.0.1.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 501ms
rtt min/avg/max/mdev = 0.066/0.166/0.258/0.078 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 2 ']'
+ sudo ip netns exec ns3 ping 10.0.2.1 -c 2 -i 0.5
PING 10.0.2.1 (10.0.2.1) 56(84) bytes of data.
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.055 ms
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.108 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.141 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=1 ttl=63 time=0.163 ms (DUP!)
64 bytes from 10.0.2.1: icmp_seq=2 ttl=63 time=0.090 ms

--- 10.0.2.1 ping statistics ---
2 packets transmitted, 2 received, +3 duplicates, 0% packet loss, time 503ms
rtt min/avg/max/mdev = 0.055/0.111/0.163/0.039 ms
+ for j in `seq 1 $1`
+ '[' 3 -ne 3 ']'
+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:02:21.592] [Router] [r1] [info] Destroying Router instance
+ delete_veth 3
++ seq 1 3
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
+ for i in `seq 1 $1`
+ sudo ip link del veth3
+ sudo ip netns del ns3
</system-out></testcase><testcase name="./../src/services/pcn-router/test/test_shadow/test4.sh" time="9.000000" status="Passed"><system-out>[2020-12-24 11:02:23.357] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:02:23.358] [polycubed] [info] configuration parameters: 
[2020-12-24 11:02:23.358] [polycubed] [info]  loglevel: info
[2020-12-24 11:02:23.358] [polycubed] [info]  daemon: false
[2020-12-24 11:02:23.358] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:02:23.358] [polycubed] [info]  port: 9000
[2020-12-24 11:02:23.358] [polycubed] [info]  addr: localhost
[2020-12-24 11:02:23.358] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:02:23.358] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:02:23.358] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:02:23.358] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:02:23.358] [polycubed] [info] polycubed starting...
[2020-12-24 11:02:23.358] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:02:25.571] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:02:25.571] [polycubed] [info] rest server starting ...
[2020-12-24 11:02:25.616] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:02:25.627] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:02:25.642] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:02:25.652] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:02:25.686] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:02:25.696] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:02:25.739] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:02:25.772] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:02:25.808] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:02:25.851] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:02:25.896] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:02:25.919] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:02:25.930] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:02:25.946] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:02:25.956] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:02:25.966] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:02:26.008] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:02:26.057] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:02:26.057] [polycubed] [info] loading metrics from yang files
+ set -e
+ polycubectl router add r1 shadow=true
[2020-12-24 11:02:29.093] [Router] [r1] [info] Creating Router instance
+ router_add_port r1 p1 10.0.0.1/24
+ polycubectl router r1 ports add p1 ip=10.0.0.1/24
[2020-12-24 11:02:29.616] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:02:29.680] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:02:30.704] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:02:30.704] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:02:30.788] [Router] [r1] [error] received packet from non valid port: 0
[2020-12-24 11:02:30.906] [Router] [r1] [info] Added new port: p1 (index: 0) [mac: 36:da:13:af:2b:27 - ip: 10.0.0.1/24]
[2020-12-24 11:02:30.906] [Router] [r1] [info] Added route [network: 10.0.0.1/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:02:30.906] [Router] [r1] [info] Added route [network: 10.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: r1
uuid: 9255a3f9-7a4b-426d-961b-d4d9c087f411
service-name: router
type: TC
loglevel: INFO
shadow: true
span: false

ports:
 name  uuid                                  status  peer  ip           mac
 p1    b82f4d1c-10cd-45f7-bb5a-c53017c2bee3  DOWN          10.0.0.1/24  36:da:13:af:2b:27

route:
 network      nexthop  interface  pathcost
 10.0.0.0/24  local    p1         0

+ sudo ip netns exec pcn-r1 ifconfig p1 192.168.0.1/24
[2020-12-24 11:02:30.953] [Router] [r1] [info] Added route [network: 192.168.0.1/32 - nexthop: 0.0.0.0 - interface: p1]
[2020-12-24 11:02:30.953] [Router] [r1] [info] Added route [network: 192.168.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: r1
uuid: 9255a3f9-7a4b-426d-961b-d4d9c087f411
service-name: router
type: TC
loglevel: INFO
shadow: true
span: false

ports:
 name  uuid                                  status  peer  ip              mac
 p1    b82f4d1c-10cd-45f7-bb5a-c53017c2bee3  DOWN          192.168.0.1/24  36:da:13:af:2b:27

route:
 network         nexthop  interface  pathcost
 192.168.0.0/24  local    p1         0

+ sudo ip netns exec pcn-r1 ip route add 30.0.0.0/24 dev p1
[2020-12-24 11:02:30.968] [Router] [r1] [info] Added Linux route [network: 30.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: r1
uuid: 9255a3f9-7a4b-426d-961b-d4d9c087f411
service-name: router
type: TC
loglevel: INFO
shadow: true
span: false

ports:
 name  uuid                                  status  peer  ip              mac
 p1    b82f4d1c-10cd-45f7-bb5a-c53017c2bee3  DOWN          192.168.0.1/24  36:da:13:af:2b:27

route:
 network         nexthop  interface  pathcost
 192.168.0.0/24  local    p1         0
 30.0.0.0/24     0.0.0.0  p1         1

+ sudo ip netns exec pcn-r1 ip route del 30.0.0.0/24 dev p1
[2020-12-24 11:02:30.982] [Router] [r1] [info] Removed Linux route [network: 30.0.0.0/24 - nexthop: 0.0.0.0 - interface: p1]
+ polycubectl router r1 show
Size of the terminal is too small, output could be missaligned.Size of the terminal is too small, output could be missaligned.name: r1
uuid: 9255a3f9-7a4b-426d-961b-d4d9c087f411
service-name: router
type: TC
loglevel: INFO
shadow: true
span: false

ports:
 name  uuid                                  status  peer  ip              mac
 p1    b82f4d1c-10cd-45f7-bb5a-c53017c2bee3  DOWN          192.168.0.1/24  36:da:13:af:2b:27

route:
 network         nexthop  interface  pathcost
 192.168.0.0/24  local    p1         0

+ cleanup
+ set +e
+ del_routers 1
++ seq 1 1
+ for i in `seq 1 $1`
+ polycubectl router del r1
[2020-12-24 11:02:30.995] [Router] [r1] [info] Destroying Router instance
</system-out></testcase><testcase name="./../src/services/pcn-simplebridge/test/test1.sh" time="14.000000" status="Passed"><system-out>[2020-12-24 11:02:32.072] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:02:32.073] [polycubed] [info] configuration parameters: 
[2020-12-24 11:02:32.073] [polycubed] [info]  loglevel: info
[2020-12-24 11:02:32.073] [polycubed] [info]  daemon: false
[2020-12-24 11:02:32.073] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:02:32.073] [polycubed] [info]  port: 9000
[2020-12-24 11:02:32.073] [polycubed] [info]  addr: localhost
[2020-12-24 11:02:32.073] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:02:32.073] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:02:32.073] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:02:32.073] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:02:32.073] [polycubed] [info] polycubed starting...
[2020-12-24 11:02:32.073] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:02:34.271] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:02:34.272] [polycubed] [info] rest server starting ...
[2020-12-24 11:02:34.317] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:02:34.328] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:02:34.342] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:02:34.352] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:02:34.387] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:02:34.397] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:02:34.441] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:02:34.475] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:02:34.511] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:02:34.555] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:02:34.601] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:02:34.624] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:02:34.636] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:02:34.651] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:02:34.660] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:02:34.670] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:02:34.713] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:02:34.762] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:02:34.762] [polycubed] [info] loading metrics from yang files
+ set -e
+ TYPE=TC
+ '[' -n '' ']'
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl simplebridge add br1 type=TC
[2020-12-24 11:02:37.146] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 11:02:37.146] [Simplebridge] [br1] [info] Creating Fdb instance
+ polycubectl simplebridge br1 ports add port1
+ polycubectl simplebridge br1 ports add port2
+ polycubectl connect br1:port1 veth1
[2020-12-24 11:02:37.649] [polycubed] [warning] packetout: port br1:port2 is down
[2020-12-24 11:02:37.649] [polycubed] [warning] packetout: port br1:port2 is down
+ polycubectl connect br1:port2 veth2
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.177 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1021ms
rtt min/avg/max/mdev = 0.053/0.115/0.177/0.062 ms
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.022 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.052 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1015ms
rtt min/avg/max/mdev = 0.022/0.037/0.052/0.015 ms
+ sleep 3
+ cleanup
+ set +e
+ polycubectl simplebridge del br1
[2020-12-24 11:02:44.112] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-simplebridge/test/test1_xdp.sh" time="13.000000" status="Passed"><system-out>[2020-12-24 11:02:46.321] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:02:46.321] [polycubed] [info] configuration parameters: 
[2020-12-24 11:02:46.321] [polycubed] [info]  loglevel: info
[2020-12-24 11:02:46.321] [polycubed] [info]  daemon: false
[2020-12-24 11:02:46.321] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:02:46.321] [polycubed] [info]  port: 9000
[2020-12-24 11:02:46.321] [polycubed] [info]  addr: localhost
[2020-12-24 11:02:46.321] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:02:46.321] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:02:46.321] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:02:46.321] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:02:46.321] [polycubed] [info] polycubed starting...
[2020-12-24 11:02:46.321] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:02:48.523] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:02:48.524] [polycubed] [info] rest server starting ...
[2020-12-24 11:02:48.568] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:02:48.579] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:02:48.594] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:02:48.605] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:02:48.638] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:02:48.649] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:02:48.691] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:02:48.725] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:02:48.760] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:02:48.803] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:02:48.847] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:02:48.870] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:02:48.881] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:02:48.897] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:02:48.907] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:02:48.916] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:02:48.958] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:02:49.006] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:02:49.006] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-simplebridge/test/test1.sh XDP_SKB
+ set -e
+ TYPE=TC
+ '[' -n XDP_SKB ']'
+ TYPE=XDP_SKB
+ create_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip netns add ns1
+ sudo ip link add veth1_ type veth peer name veth1
+ sudo ip link set veth1_ netns ns1
+ sudo ip netns exec ns1 ip link set dev veth1_ up
+ sudo ip link set dev veth1 up
+ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
+ for i in `seq 1 $1`
+ sudo ip netns add ns2
+ sudo ip link add veth2_ type veth peer name veth2
+ sudo ip link set veth2_ netns ns2
+ sudo ip netns exec ns2 ip link set dev veth2_ up
+ sudo ip link set dev veth2 up
+ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
+ polycubectl simplebridge add br1 type=XDP_SKB
[2020-12-24 11:02:51.401] [Simplebridge] [br1] [info] Creating Simplebridge instance
[2020-12-24 11:02:51.401] [Simplebridge] [br1] [info] Creating Fdb instance
+ polycubectl simplebridge br1 ports add port1
+ polycubectl simplebridge br1 ports add port2
+ polycubectl connect br1:port1 veth1
[2020-12-24 11:02:52.208] [polycubed] [warning] packetout: port br1:port2 is down
[2020-12-24 11:02:52.208] [polycubed] [warning] packetout: port br1:port2 is down
+ polycubectl connect br1:port2 veth2
+ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.159 ms
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.056 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1005ms
rtt min/avg/max/mdev = 0.056/0.107/0.159/0.052 ms
+ sudo ip netns exec ns2 ping 10.0.0.1 -c 2 -w 2
PING 10.0.0.1 (10.0.0.1) 56(84) bytes of data.
64 bytes from 10.0.0.1: icmp_seq=1 ttl=64 time=0.026 ms
64 bytes from 10.0.0.1: icmp_seq=2 ttl=64 time=0.053 ms

--- 10.0.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1015ms
rtt min/avg/max/mdev = 0.026/0.039/0.053/0.014 ms
+ sleep 3
+ cleanup
+ set +e
+ polycubectl simplebridge del br1
[2020-12-24 11:02:58.385] [Simplebridge] [br1] [info] Destroying Simplebridge instance
+ delete_veth 2
++ seq 1 2
+ for i in `seq 1 $1`
+ sudo ip link del veth1
+ sudo ip netns del ns1
+ for i in `seq 1 $1`
+ sudo ip link del veth2
+ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-simpleforwarder/test/test1.sh" time="8.000000" status="Passed"><system-out>[2020-12-24 11:02:59.537] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:02:59.537] [polycubed] [info] configuration parameters: 
[2020-12-24 11:02:59.537] [polycubed] [info]  loglevel: info
[2020-12-24 11:02:59.537] [polycubed] [info]  daemon: false
[2020-12-24 11:02:59.537] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:02:59.537] [polycubed] [info]  port: 9000
[2020-12-24 11:02:59.537] [polycubed] [info]  addr: localhost
[2020-12-24 11:02:59.537] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:02:59.537] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:02:59.537] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:02:59.537] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:02:59.537] [polycubed] [info] polycubed starting...
[2020-12-24 11:02:59.537] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:03:01.737] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:03:01.737] [polycubed] [info] rest server starting ...
[2020-12-24 11:03:01.780] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:03:01.792] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:03:01.806] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:03:01.816] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:03:01.849] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:03:01.859] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:03:01.901] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:03:01.934] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:03:01.969] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:03:02.012] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:03:02.056] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:03:02.079] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:03:02.090] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:03:02.106] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:03:02.116] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:03:02.125] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:03:02.167] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:03:02.215] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:03:02.215] [polycubed] [info] loading metrics from yang files

Test 1 

++ create_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip link set dev veth1 up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns2
++ sudo ip link add veth2_ type veth peer name veth2
++ sudo ip link set veth2_ netns ns2
++ sudo ip netns exec ns2 ip link set dev veth2_ up
++ sudo ip link set dev veth2 up
++ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
++ TYPE=TC
++ '[' -n '' ']'
++ polycubectl simpleforwarder add sf type=TC
[2020-12-24 11:03:03.982] [Simpleforwarder] [sf] [info] Creating Simpleforwarder instance
++ polycubectl simpleforwarder sf set loglevel=DEBUG
++ polycubectl simpleforwarder sf ports add sf-p1
++ polycubectl simpleforwarder sf ports add sf-p2
++ polycubectl simpleforwarder sf ports sf-p1 set peer=veth1
[2020-12-24 11:03:04.400] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf ports sf-p2 set peer=veth2
++ polycubectl simpleforwarder sf actions add sf-p1 action=FORWARD outport=sf-p2
++ polycubectl simpleforwarder sf actions add sf-p2 action=FORWARD outport=sf-p1
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
[2020-12-24 11:03:04.884] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:04.884] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.085 ms
[2020-12-24 11:03:04.914] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:04.914] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:04.914] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:04.914] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:05.297] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:05.297] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:05.384] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:05.520] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.087 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1022ms
rtt min/avg/max/mdev = 0.085/0.086/0.087/0.001 ms
[2020-12-24 11:03:05.936] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:05.936] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
++ sfcleanup
++ set +e
++ polycubectl simpleforwarder del sf
[2020-12-24 11:03:05.943] [Simpleforwarder] [sf] [info] Destroying Simpleforwarder instance
++ delete_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip link del veth1
++ sudo ip netns del ns1
++ for i in `seq 1 $1`
++ sudo ip link del veth2
++ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-simpleforwarder/test/test1_xdp.sh" time="7.000000" status="Passed"><system-out>[2020-12-24 11:03:07.082] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:03:07.083] [polycubed] [info] configuration parameters: 
[2020-12-24 11:03:07.083] [polycubed] [info]  loglevel: info
[2020-12-24 11:03:07.083] [polycubed] [info]  daemon: false
[2020-12-24 11:03:07.083] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:03:07.083] [polycubed] [info]  port: 9000
[2020-12-24 11:03:07.083] [polycubed] [info]  addr: localhost
[2020-12-24 11:03:07.083] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:03:07.083] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:03:07.083] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:03:07.083] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:03:07.083] [polycubed] [info] polycubed starting...
[2020-12-24 11:03:07.083] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:03:09.302] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:03:09.303] [polycubed] [info] rest server starting ...
[2020-12-24 11:03:09.348] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:03:09.359] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:03:09.374] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:03:09.384] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:03:09.417] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:03:09.427] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:03:09.469] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:03:09.502] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:03:09.537] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:03:09.580] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:03:09.624] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:03:09.647] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:03:09.659] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:03:09.675] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:03:09.684] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:03:09.694] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:03:09.736] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:03:09.784] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:03:09.784] [polycubed] [info] loading metrics from yang files
+ ./../src/services/pcn-simpleforwarder/test/test1.sh XDP_SKB

Test 1 

++ create_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip link set dev veth1 up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns2
++ sudo ip link add veth2_ type veth peer name veth2
++ sudo ip link set veth2_ netns ns2
++ sudo ip netns exec ns2 ip link set dev veth2_ up
++ sudo ip link set dev veth2 up
++ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
++ TYPE=TC
++ '[' -n XDP_SKB ']'
++ TYPE=XDP_SKB
++ polycubectl simpleforwarder add sf type=XDP_SKB
[2020-12-24 11:03:11.572] [Simpleforwarder] [sf] [info] Creating Simpleforwarder instance
++ polycubectl simpleforwarder sf set loglevel=DEBUG
++ polycubectl simpleforwarder sf ports add sf-p1
++ polycubectl simpleforwarder sf ports add sf-p2
++ polycubectl simpleforwarder sf ports sf-p1 set peer=veth1
++ polycubectl simpleforwarder sf ports sf-p2 set peer=veth2
[2020-12-24 11:03:12.272] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf actions add sf-p1 action=FORWARD outport=sf-p2
++ polycubectl simpleforwarder sf actions add sf-p2 action=FORWARD outport=sf-p1
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.073 ms
[2020-12-24 11:03:12.555] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:12.555] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:12.555] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:12.555] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:12.560] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:12.560] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:12.768] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:13.296] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:13.296] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.089 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1029ms
rtt min/avg/max/mdev = 0.073/0.081/0.089/0.008 ms
[2020-12-24 11:03:13.584] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:13.584] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
++ sfcleanup
++ set +e
++ polycubectl simpleforwarder del sf
[2020-12-24 11:03:13.590] [Simpleforwarder] [sf] [info] Destroying Simpleforwarder instance
++ delete_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip link del veth1
++ sudo ip netns del ns1
++ for i in `seq 1 $1`
++ sudo ip link del veth2
++ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-simpleforwarder/test/test2.sh" time="10.000000" status="Passed"><system-out>[2020-12-24 11:03:14.712] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:03:14.713] [polycubed] [info] configuration parameters: 
[2020-12-24 11:03:14.713] [polycubed] [info]  loglevel: info
[2020-12-24 11:03:14.713] [polycubed] [info]  daemon: false
[2020-12-24 11:03:14.713] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:03:14.713] [polycubed] [info]  port: 9000
[2020-12-24 11:03:14.713] [polycubed] [info]  addr: localhost
[2020-12-24 11:03:14.713] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:03:14.713] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:03:14.713] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:03:14.713] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:03:14.713] [polycubed] [info] polycubed starting...
[2020-12-24 11:03:14.713] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:03:16.912] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:03:16.912] [polycubed] [info] rest server starting ...
[2020-12-24 11:03:16.956] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:03:16.967] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:03:16.981] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:03:16.991] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:03:17.024] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:03:17.035] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:03:17.078] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:03:17.112] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:03:17.148] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:03:17.193] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:03:17.239] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:03:17.262] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:03:17.274] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:03:17.290] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:03:17.299] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:03:17.309] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:03:17.352] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:03:17.402] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:03:17.402] [polycubed] [info] loading metrics from yang files

Test 2 

++ create_veth 4
+++ seq 1 4
++ for i in `seq 1 $1`
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip link set dev veth1 up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns2
++ sudo ip link add veth2_ type veth peer name veth2
++ sudo ip link set veth2_ netns ns2
++ sudo ip netns exec ns2 ip link set dev veth2_ up
++ sudo ip link set dev veth2 up
++ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns3
++ sudo ip link add veth3_ type veth peer name veth3
++ sudo ip link set veth3_ netns ns3
++ sudo ip netns exec ns3 ip link set dev veth3_ up
++ sudo ip link set dev veth3 up
++ sudo ip netns exec ns3 ifconfig veth3_ 10.0.0.3/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns4
++ sudo ip link add veth4_ type veth peer name veth4
++ sudo ip link set veth4_ netns ns4
++ sudo ip netns exec ns4 ip link set dev veth4_ up
++ sudo ip link set dev veth4 up
++ sudo ip netns exec ns4 ifconfig veth4_ 10.0.0.4/24
++ polycubectl simpleforwarder add sf
[2020-12-24 11:03:19.352] [Simpleforwarder] [sf] [info] Creating Simpleforwarder instance
++ polycubectl simpleforwarder sf set loglevel=DEBUG
++ polycubectl simpleforwarder sf ports add sf-p1
++ polycubectl simpleforwarder sf ports add sf-p2
++ polycubectl simpleforwarder sf ports add sf-p3
++ polycubectl simpleforwarder sf ports add sf-p4
++ polycubectl simpleforwarder sf ports sf-p1 set peer=veth1
++ polycubectl simpleforwarder sf ports sf-p2 set peer=veth2
[2020-12-24 11:03:19.888] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
[2020-12-24 11:03:20.016] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
[2020-12-24 11:03:20.016] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf ports sf-p3 set peer=veth3
[2020-12-24 11:03:20.272] [Simpleforwarder] [sf] [debug] No action associated to port 1: dropping packet.
[2020-12-24 11:03:20.272] [Simpleforwarder] [sf] [debug] No action associated to port 1: dropping packet.
[2020-12-24 11:03:20.656] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf ports sf-p4 set peer=veth4
[2020-12-24 11:03:20.817] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
[2020-12-24 11:03:20.916] [Simpleforwarder] [sf] [debug] No action associated to port 1: dropping packet.
[2020-12-24 11:03:21.040] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
[2020-12-24 11:03:21.040] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf actions add sf-p1 action=FORWARD outport=sf-p2
++ polycubectl simpleforwarder sf actions add sf-p2 action=FORWARD outport=sf-p1
++ polycubectl simpleforwarder sf actions add sf-p3 action=FORWARD outport=sf-p4
++ polycubectl simpleforwarder sf actions add sf-p4 action=FORWARD outport=sf-p3
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.077 ms
[2020-12-24 11:03:21.119] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:21.119] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:21.119] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:21.119] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:22.032] [Simpleforwarder] [sf] [debug] Forwarding packet to port 2.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.087 ms
[2020-12-24 11:03:22.128] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.

[2020-12-24 11:03:22.128] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1008ms
rtt min/avg/max/mdev = 0.077/0.082/0.087/0.005 ms
++ sudo ip netns exec ns4 ping 10.0.0.3 -c 2 -w 2
[2020-12-24 11:03:22.137] [Simpleforwarder] [sf] [debug] Forwarding packet to port 2.
PING 10.0.0.3 (10.0.0.3) 56(84) bytes of data.
64 bytes from 10.0.0.3: icmp_seq=1 ttl=64 time=0.079 ms
[2020-12-24 11:03:22.137] [Simpleforwarder] [sf] [debug] Forwarding packet to port 3.
[2020-12-24 11:03:22.137] [Simpleforwarder] [sf] [debug] Forwarding packet to port 2.
[2020-12-24 11:03:22.137] [Simpleforwarder] [sf] [debug] Forwarding packet to port 3.
64 bytes from 10.0.0.3: icmp_seq=2 ttl=64 time=0.084 ms

[2020-12-24 11:03:23.152] [Simpleforwarder] [sf] [debug] Forwarding packet to port 2.
[2020-12-24 11:03:23.152] [Simpleforwarder] [sf] [debug] Forwarding packet to port 3.
--- 10.0.0.3 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1015ms
rtt min/avg/max/mdev = 0.079/0.081/0.084/0.009 ms
++ sfcleanup
++ set +e
++ polycubectl simpleforwarder del sf
[2020-12-24 11:03:23.159] [Simpleforwarder] [sf] [info] Destroying Simpleforwarder instance
++ delete_veth 4
+++ seq 1 4
++ for i in `seq 1 $1`
++ sudo ip link del veth1
++ sudo ip netns del ns1
++ for i in `seq 1 $1`
++ sudo ip link del veth2
++ sudo ip netns del ns2
++ for i in `seq 1 $1`
++ sudo ip link del veth3
++ sudo ip netns del ns3
++ for i in `seq 1 $1`
++ sudo ip link del veth4
++ sudo ip netns del ns4
</system-out></testcase><testcase name="./../src/services/pcn-simpleforwarder/test/test3.sh" time="7.000000" status="Passed"><system-out>[2020-12-24 11:03:24.415] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:03:24.416] [polycubed] [info] configuration parameters: 
[2020-12-24 11:03:24.416] [polycubed] [info]  loglevel: info
[2020-12-24 11:03:24.416] [polycubed] [info]  daemon: false
[2020-12-24 11:03:24.416] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:03:24.416] [polycubed] [info]  port: 9000
[2020-12-24 11:03:24.416] [polycubed] [info]  addr: localhost
[2020-12-24 11:03:24.416] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:03:24.416] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:03:24.416] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:03:24.416] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:03:24.416] [polycubed] [info] polycubed starting...
[2020-12-24 11:03:24.416] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:03:26.626] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:03:26.627] [polycubed] [info] rest server starting ...
[2020-12-24 11:03:26.672] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:03:26.683] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:03:26.698] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:03:26.709] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:03:26.742] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:03:26.753] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:03:26.795] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:03:26.828] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:03:26.863] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:03:26.906] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:03:26.950] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:03:26.973] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:03:26.985] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:03:27.001] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:03:27.010] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:03:27.020] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:03:27.062] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:03:27.110] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:03:27.110] [polycubed] [info] loading metrics from yang files
++ echo -e '\nTest 3 \n'

Test 3 

++ set -e
++ set -x
++ create_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip netns add ns1
++ sudo ip link add veth1_ type veth peer name veth1
++ sudo ip link set veth1_ netns ns1
++ sudo ip netns exec ns1 ip link set dev veth1_ up
++ sudo ip link set dev veth1 up
++ sudo ip netns exec ns1 ifconfig veth1_ 10.0.0.1/24
++ for i in `seq 1 $1`
++ sudo ip netns add ns2
++ sudo ip link add veth2_ type veth peer name veth2
++ sudo ip link set veth2_ netns ns2
++ sudo ip netns exec ns2 ip link set dev veth2_ up
++ sudo ip link set dev veth2 up
++ sudo ip netns exec ns2 ifconfig veth2_ 10.0.0.2/24
++ polycubectl simpleforwarder add sf
[2020-12-24 11:03:28.874] [Simpleforwarder] [sf] [info] Creating Simpleforwarder instance
++ polycubectl simpleforwarder sf set loglevel=DEBUG
++ polycubectl simpleforwarder sf ports add sf-p1
++ polycubectl simpleforwarder sf ports add sf-p2
++ polycubectl simpleforwarder sf ports sf-p1 set peer=veth1
[2020-12-24 11:03:29.296] [Simpleforwarder] [sf] [debug] No action associated to port 0: dropping packet.
++ polycubectl simpleforwarder sf ports sf-p2 set peer=veth2
++ polycubectl simpleforwarder sf actions add sf-p1 action=DROP
++ polycubectl simpleforwarder sf actions add sf-p2 action=DROP
++ polycubectl simpleforwarder sf actions sf-p1 set action=FORWARD
++ polycubectl simpleforwarder sf actions sf-p1 set outport=sf-p2
[2020-12-24 11:03:29.772] [Simpleforwarder] [sf] [info] This port has no outport set yet!
++ polycubectl simpleforwarder sf actions sf-p2 set action=FORWARD outport=sf-p1
++ sudo ip netns exec ns1 ping 10.0.0.2 -c 2 -w 2
PING 10.0.0.2 (10.0.0.2) 56(84) bytes of data.
64 bytes from 10.0.0.2: icmp_seq=1 ttl=64 time=0.083 ms
[2020-12-24 11:03:29.823] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:29.823] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:29.823] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:29.823] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:30.320] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:30.320] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:30.448] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:30.448] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
[2020-12-24 11:03:30.704] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
64 bytes from 10.0.0.2: icmp_seq=2 ttl=64 time=0.088 ms

--- 10.0.0.2 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1009ms
rtt min/avg/max/mdev = 0.083/0.085/0.088/0.009 ms
[2020-12-24 11:03:30.832] [Simpleforwarder] [sf] [debug] Forwarding packet to port 1.
[2020-12-24 11:03:30.833] [Simpleforwarder] [sf] [debug] Forwarding packet to port 0.
++ sfcleanup
++ set +e
++ polycubectl simpleforwarder del sf
[2020-12-24 11:03:30.839] [Simpleforwarder] [sf] [info] Destroying Simpleforwarder instance
++ delete_veth 2
+++ seq 1 2
++ for i in `seq 1 $1`
++ sudo ip link del veth1
++ sudo ip netns del ns1
++ for i in `seq 1 $1`
++ sudo ip link del veth2
++ sudo ip netns del ns2
</system-out></testcase><testcase name="./../src/services/pcn-synflood/test/test1.sh" time="6.000000" status="Passed"><system-out>[2020-12-24 11:03:31.999] [polycubed] [info] loading configuration from /etc/polycube/polycubed.conf
[2020-12-24 11:03:32.000] [polycubed] [info] configuration parameters: 
[2020-12-24 11:03:32.000] [polycubed] [info]  loglevel: info
[2020-12-24 11:03:32.000] [polycubed] [info]  daemon: false
[2020-12-24 11:03:32.000] [polycubed] [info]  pidfile: /var/run/polycube.pid
[2020-12-24 11:03:32.000] [polycubed] [info]  port: 9000
[2020-12-24 11:03:32.000] [polycubed] [info]  addr: localhost
[2020-12-24 11:03:32.000] [polycubed] [info]  logfile: /var/log/polycube/polycubed.log
[2020-12-24 11:03:32.000] [polycubed] [info]  cubes-dump-file: /etc/polycube/cubes.yaml
[2020-12-24 11:03:32.000] [polycubed] [info]  cubes-dump-clean-init: false
[2020-12-24 11:03:32.000] [polycubed] [info]  cubes-dump-enable: false
[2020-12-24 11:03:32.000] [polycubed] [info] polycubed starting...
[2020-12-24 11:03:32.000] [polycubed] [info] version -128-NOTFOUND+ [git: (branch/commit): githubactions/cb6fe2f7]
[2020-12-24 11:03:34.198] [polycubed] [info] rest server listening on '127.0.0.1:9000'
[2020-12-24 11:03:34.198] [polycubed] [info] rest server starting ...
[2020-12-24 11:03:34.245] [polycubed] [info] service bridge loaded using libpcn-bridge.so
[2020-12-24 11:03:34.256] [polycubed] [info] service ddosmitigator loaded using libpcn-ddosmitigator.so
[2020-12-24 11:03:34.271] [polycubed] [info] service firewall loaded using libpcn-firewall.so
[2020-12-24 11:03:34.281] [polycubed] [info] service helloworld loaded using libpcn-helloworld.so
[2020-12-24 11:03:34.314] [polycubed] [info] service k8switch loaded using libpcn-k8switch.so
[2020-12-24 11:03:34.325] [polycubed] [info] service k8sfilter loaded using libpcn-k8sfilter.so
[2020-12-24 11:03:34.367] [polycubed] [info] service lbdsr loaded using libpcn-lbdsr.so
[2020-12-24 11:03:34.400] [polycubed] [info] service lbrp loaded using libpcn-lbrp.so
[2020-12-24 11:03:34.435] [polycubed] [info] service nat loaded using libpcn-nat.so
[2020-12-24 11:03:34.478] [polycubed] [info] service pbforwarder loaded using libpcn-pbforwarder.so
[2020-12-24 11:03:34.522] [polycubed] [info] service router loaded using libpcn-router.so
[2020-12-24 11:03:34.545] [polycubed] [info] service simplebridge loaded using libpcn-simplebridge.so
[2020-12-24 11:03:34.556] [polycubed] [info] service simpleforwarder loaded using libpcn-simpleforwarder.so
[2020-12-24 11:03:34.572] [polycubed] [info] service iptables loaded using libpcn-iptables.so
[2020-12-24 11:03:34.582] [polycubed] [info] service transparenthelloworld loaded using libpcn-transparenthelloworld.so
[2020-12-24 11:03:34.591] [polycubed] [info] service synflood loaded using libpcn-synflood.so
[2020-12-24 11:03:34.633] [polycubed] [info] service packetcapture loaded using libpcn-packetcapture.so
[2020-12-24 11:03:34.680] [polycubed] [info] service dynmon loaded using libpcn-dynmon.so
[2020-12-24 11:03:34.680] [polycubed] [info] loading metrics from yang files

Test 1 

++ polycubectl synflood add sf
++ polycubectl sf show
name: sf
uuid: f57ed03a-ade0-47f5-a23f-4ab7b02cabd8
service-name: synflood
type: TC
loglevel: INFO
parent: 
stats:
 tcpattemptfails: 4255
 tcpoutrsts: 4337
 deliverratio: 0.999939
 responseratio: 1.012662
 lastupdate: 1608807816305.000000

++ polycubectl sf stats show
tcpattemptfails: 4257
tcpoutrsts: 4339
deliverratio: 0.999939
responseratio: 1.012659
lastupdate: 1608807816311.000000

++ polycubectl sf stats tcpattemptfails show
4259

++ polycubectl sf stats tcpoutrsts show
4343

++ polycubectl sf stats deliverratio show
0.999939

++ polycubectl sf stats responseratio show
1.012646

++ polycubectl sf stats lastupdate show
1608807816335.000000

++ synfloodcleanup
++ set +e
++ polycubectl synflood del sf
</system-out></testcase></testsuite></testsuites>